<!doctype html>
<script src="/resources/testharness.js"></script>
<script src="/resources/testharnessreport.js"></script>
<script src="./2d-context-lost-and-reused-in-same-task-impl.js"></script>
<canvas id="canvas"></canvas>
<script>
/**
 * Tests losing the GPU context and keep using an OffscreenCanvas with a
 * placeholder in the same task, before the canvas realizes that the
 * context is lost.
 */
promise_test(async () => {
  const placeholder = document.getElementById('canvas');
  const canvas = placeholder.transferControlToOffscreen();
  await TestLosingAndReusingCanvasInSameTask(canvas);
}, 'OffscreenCanvas with a placeholder can be used in the same task the GPU ' +
   'process died.');
</script>
