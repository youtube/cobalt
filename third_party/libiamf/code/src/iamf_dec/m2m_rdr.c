/*
BSD 3-Clause Clear License The Clear BSD License

Copyright (c) 2023, Alliance for Open Media.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are met:

1. Redistributions of source code must retain the above copyright notice, this
   list of conditions and the following disclaimer.

2. Redistributions in binary form must reproduce the above copyright notice,
   this list of conditions and the following disclaimer in the documentation
   and/or other materials provided with the distribution.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE
FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/

/*
AOM-IAMF Standard Deliverable Status:
This software module is out of scope and not part of the IAMF Final Deliverable.
*/

/**
 * @file m2m_rdr.c
 * @brief Multichannels to Multichannels rendering.
 * @version 0.1
 * @date Created 03/03/2023
 **/
#include "ae_rdr.h"

// The gain matrices below are generated to comply with EAR Direct Speakers
// renderer ([ITU2127-0]), except for 3.1.2ch and 7.1.2ch. When playback layout
// is 3.1.2ch and 7.1.2ch, the gain matrices follow 7.3.2.1 of IAMF. When input
// layout is 3.1.2ch and 7.1.2ch, the gain matrices are generated with the
// processing below. 3.1.2ch -> 5.1.2ch -> Playback layout 7.1.2ch -> 7.1.4ch ->
// Playback layout

float mono_bs020[][2] = {{0.70710678, 0.70710678}};
float mono_bs050[][6] = {{0, 0, 1.0, 0, 0, 0}};
float mono_bs250[][8] = {{0, 0, 1.0, 0, 0, 0, 0, 0}};
float mono_bs450[][10] = {{0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0}};
float mono_bs451[][11] = {{0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0}};
float mono_bs370[][12] = {{1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};
float mono_bs490[][14] = {{0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};
float mono_bs9A3[][24] = {
    {0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};
float mono_bs070[][8] = {{0, 0, 1.0, 0, 0, 0, 0, 0}};
float mono_bs470[][12] = {{0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};
float mono_iamf312[][6] = {{0, 0, 1.0, 0, 0, 0}};
float mono_iamf712[][10] = {{0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0}};
float mono_mono[][1] = {{1.0}};

///////////////////////////////

// 'M+030', 'M-030'
float stereo_bs020[][2] = {{1.0, 0}, {0, 1.0}};
// 'M+030', 'M-030', 'M+000', 'LFE1', 'M+110', 'M-110'
float stereo_bs050[][6] = {{1.0, 0, 0, 0, 0, 0}, {0, 1.0, 0, 0, 0, 0}};
// 'M+030', 'M-030', 'M+000', 'LFE1', 'M+110', 'M-110', 'U+030', 'U-030'
float stereo_bs250[][8] = {{1.0, 0, 0, 0, 0, 0, 0, 0},
                           {0, 1.0, 0, 0, 0, 0, 0, 0}};
// 'M+030', 'M-030', 'M+000', 'LFE1', 'M+110', 'M-110', 'U+030', 'U-030',
// 'U+110', 'U-110'
float stereo_bs450[][10] = {{1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                            {0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0}};
// 'M+030', 'M-030', 'M+000', 'LFE1', 'M+110', 'M-110', 'U+030', 'U-030',
// 'U+110', 'U-110', 'B+000'
float stereo_bs451[][11] = {{1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                            {0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};
// 'M+000', 'M+030', 'M-030', 'U+045', 'U-045', 'M+090', 'M-090', 'M+135',
// 'M-135', 'UH+180', 'LFE1', 'LFE2'
float stereo_bs370[][12] = {{0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                            {0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};
// 'M+030', 'M-030', 'M+000', 'LFE1', 'M+090', 'M-090', 'M+135', 'M-135',
// 'U+045', 'U-045', 'U+135', 'U-135', 'M+SC', 'M-SC'
float stereo_bs490[][14] = {{1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                            {0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};
// 'M+060', 'M-060', 'M+000', 'LFE1', 'M+135', 'M-135', 'M+030', 'M-030',
// 'M+180', 'LFE2', 'M+090', 'M-090', 'U+045', 'U-045', 'U+000', 'T+000',
// 'U+135', 'U-135', 'U+090', 'U-090', 'U+180', 'B+000', 'B+045', 'B-045'
float stereo_bs9A3[][24] = {
    {0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};
// 'M+030', 'M-030', 'M+000', 'LFE1', 'M+090', 'M-090', 'M+135', 'M-135'
float stereo_bs070[][8] = {{1.0, 0, 0, 0, 0, 0, 0, 0}, {0, 1.0, 0, 0, 0, 0, 0}};
// 'M+030', 'M-030', 'M+000', 'LFE1', 'M+090', 'M-090', 'M+135', 'M-135',
// 'U+045', 'U-045', 'U+135', 'U-135'
float stereo_bs470[][12] = {{1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                            {0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};
// 'M+030', 'M-030', 'M+000', 'LFE1', 'U+030', 'U-030'
float stereo_iamf312[][6] = {{1.0, 0, 0, 0, 0, 0}, {0, 1.0, 0, 0, 0, 0}};
// 'M+030', 'M-030', 'M+000', 'LFE1', 'M+090', 'M-090', 'M+135', 'M-135',
// 'U+045', 'U-045'
float stereo_iamf712[][10] = {{1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                              {0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0}};
float stereo_mono[][1] = {{0.5}, {0.5}};
///////////////////////////

float iamf51_bs020[][2] = {{1.0, 0},
                           {0, 1.0},
                           {0.7071067811865476, 0.7071067811865476},
                           {0, 0},
                           {0.7071067811865476, 0},
                           {0, 0.7071067811865476}};
float iamf51_bs050[][6] = {{1.0, 0, 0, 0, 0, 0}, {0, 1.0, 0, 0, 0, 0},
                           {0, 0, 1.0, 0, 0, 0}, {0, 0, 0, 1.0, 0, 0},
                           {0, 0, 0, 0, 1.0, 0}, {0, 0, 0, 0, 0, 1.0}};
float iamf51_bs250[][8] = {
    {1.0, 0, 0, 0, 0, 0, 0, 0}, {0, 1.0, 0, 0, 0, 0, 0, 0},
    {0, 0, 1.0, 0, 0, 0, 0, 0}, {0, 0, 0, 1.0, 0, 0, 0, 0},
    {0, 0, 0, 0, 1.0, 0, 0, 0}, {0, 0, 0, 0, 0, 1.0, 0, 0}};
float iamf51_bs450[][10] = {
    {1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0}};
float iamf51_bs451[][11] = {
    {1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0}};
float iamf51_bs370[][12] = {{0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                            {0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                            {1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                            {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0},
                            {0, 0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0},
                            {0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0}};
float iamf51_bs490[][14] = {{1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                            {0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                            {0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                            {0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                            {0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0},
                            {0, 0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0}};
float iamf51_bs9A3[][24] = {
    {0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};
float iamf51_bs070[][8] = {
    {1.0, 0, 0, 0, 0, 0, 0, 0}, {0, 1.0, 0, 0, 0, 0, 0, 0},
    {0, 0, 1.0, 0, 0, 0, 0, 0}, {0, 0, 0, 1.0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 1.0, 0}, {0, 0, 0, 0, 0, 0, 0, 1.0}};
float iamf51_bs470[][12] = {{1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                            {0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                            {0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                            {0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0},
                            {0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0},
                            {0, 0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0}};
float iamf51_iamf312[][6] = {{1.0, 0, 0, 0, 0, 0},          // L
                             {0, 1.0, 0, 0, 0, 0},          // R
                             {0, 0, 1.0, 0, 0, 0},          // C
                             {0, 0, 0, 1.0, 0, 0},          // Lfe
                             {0.70710678, 0, 0, 0, 0, 0},   // Ls
                             {0, 0.70710678, 0, 0, 0, 0}};  // Rs
float iamf51_iamf712[][10] = {
    {1, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 1, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 1, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 1, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 1, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 1, 0, 0}};
float iamf51_mono[][1] = {{0.5},
                          {0.5},
                          {0.7071067811865476},
                          {0},
                          {0.3535533905932738},
                          {0.3535533905932738}};
//////////////////////

float iamf512_bs020[][2] = {{1.0, 0},
                            {0, 1.0},
                            {0.7071067811865476, 0.7071067811865476},
                            {0, 0},
                            {0.7071067811865476, 0},
                            {0, 0.7071067811865476},
                            {1.0, 0},
                            {0, 1.0}};
float iamf512_bs050[][6] = {{1.0, 0, 0, 0, 0, 0}, {0, 1.0, 0, 0, 0, 0},
                            {0, 0, 1.0, 0, 0, 0}, {0, 0, 0, 1.0, 0, 0},
                            {0, 0, 0, 0, 1.0, 0}, {0, 0, 0, 0, 0, 1.0},
                            {1.0, 0, 0, 0, 0, 0}, {0, 1.0, 0, 0, 0, 0}};
float iamf512_bs250[][8] = {
    {1.0, 0, 0, 0, 0, 0, 0, 0}, {0, 1.0, 0, 0, 0, 0, 0, 0},
    {0, 0, 1.0, 0, 0, 0, 0, 0}, {0, 0, 0, 1.0, 0, 0, 0, 0},
    {0, 0, 0, 0, 1.0, 0, 0, 0}, {0, 0, 0, 0, 0, 1.0, 0, 0},
    {0, 0, 0, 0, 0, 0, 1.0, 0}, {0, 0, 0, 0, 0, 0, 0, 1.0}};
float iamf512_bs450[][10] = {
    {1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 1.0, 0, 0}};
float iamf512_bs451[][11] = {
    {1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0}};
float iamf512_bs370[][12] = {{0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                             {0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                             {1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                             {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0},
                             {0, 0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0},
                             {0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0},
                             {0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0},
                             {0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0}};
float iamf512_bs490[][14] = {{1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                             {0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                             {0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                             {0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                             {0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0},
                             {0, 0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0},
                             {0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0},
                             {0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0}};
float iamf512_bs9A3[][24] = {
    {0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};
float iamf512_bs070[][8] = {
    {1.0, 0, 0, 0, 0, 0, 0, 0}, {0, 1.0, 0, 0, 0, 0, 0, 0},
    {0, 0, 1.0, 0, 0, 0, 0, 0}, {0, 0, 0, 1.0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 1.0, 0}, {0, 0, 0, 0, 0, 0, 0, 1.0},
    {1.0, 0, 0, 0, 0, 0, 0, 0}, {0, 1.0, 0, 0, 0, 0, 0, 0}};
float iamf512_bs470[][12] = {{1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                             {0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                             {0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                             {0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0},
                             {0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0},
                             {0, 0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0},
                             {0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0},
                             {0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0, 0}};
float iamf512_iamf312[][6] = {{1.0, 0, 0, 0, 0, 0},
                              {0, 1.0, 0, 0, 0, 0},
                              {0, 0, 1.0, 0, 0, 0},
                              {0, 0, 0, 1.0, 0, 0},
                              {0.7071067811865476, 0, 0, 0, 0, 0},
                              {0, 0.7071067811865476, 0, 0, 0, 0},
                              {0, 0, 0, 0, 1.0, 0},
                              {0, 0, 0, 0, 0, 1.0}};
float iamf512_iamf712[][10] = {
    {1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 1.0, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0}};
float iamf512_mono[][1] = {{0.5},
                           {0.5},
                           {0.7071067811865476},
                           {0},
                           {0.3535533905932738},
                           {0.3535533905932738},
                           {0.5},
                           {0.5}};
////////////////////////////////////////////////////

float iamf514_bs020[][2] = {{1.0, 0},
                            {0, 1.0},
                            {0.7071067811865476, 0.7071067811865476},
                            {0, 0},
                            {0.7071067811865476, 0},
                            {0, 0.7071067811865476},
                            {1.0, 0},
                            {0, 1.0},
                            {0.7071067811865476, 0},
                            {0, 0.7071067811865476}};
float iamf514_bs050[][6] = {{1.0, 0, 0, 0, 0, 0}, {0, 1.0, 0, 0, 0, 0},
                            {0, 0, 1.0, 0, 0, 0}, {0, 0, 0, 1.0, 0, 0},
                            {0, 0, 0, 0, 1.0, 0}, {0, 0, 0, 0, 0, 1.0},
                            {1.0, 0, 0, 0, 0, 0}, {0, 1.0, 0, 0, 0, 0},
                            {0, 0, 0, 0, 1.0, 0}, {0, 0, 0, 0, 0, 1.0}};
float iamf514_bs250[][8] = {
    {1.0, 0, 0, 0, 0, 0, 0, 0}, {0, 1.0, 0, 0, 0, 0, 0, 0},
    {0, 0, 1.0, 0, 0, 0, 0, 0}, {0, 0, 0, 1.0, 0, 0, 0, 0},
    {0, 0, 0, 0, 1.0, 0, 0, 0}, {0, 0, 0, 0, 0, 1.0, 0, 0},
    {0, 0, 0, 0, 0, 0, 1.0, 0}, {0, 0, 0, 0, 0, 0, 0, 1.0},
    {0, 0, 0, 0, 1.0, 0, 0, 0}, {0, 0, 0, 0, 0, 1.0, 0, 0}};
float iamf514_bs450[][10] = {
    {1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 1.0, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0}};
float iamf514_bs451[][11] = {
    {1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0}};
float iamf514_bs370[][12] = {
    {0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0},
    {0, 0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0},
    {0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0.7071067811865476, 0, 0, 0, 0, 0, 0.7071067811865476, 0, 0},
    {0, 0, 0, 0, 0.7071067811865476, 0, 0, 0, 0, 0.7071067811865476, 0, 0}};
float iamf514_bs490[][14] = {{1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                             {0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                             {0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                             {0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                             {0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0},
                             {0, 0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0},
                             {0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0},
                             {0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0},
                             {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0},
                             {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0, 0}};
float iamf514_bs9A3[][24] = {
    {0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0}};
float iamf514_bs070[][8] = {
    {1.0, 0, 0, 0, 0, 0, 0, 0}, {0, 1.0, 0, 0, 0, 0, 0, 0},
    {0, 0, 1.0, 0, 0, 0, 0, 0}, {0, 0, 0, 1.0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 1.0, 0}, {0, 0, 0, 0, 0, 0, 0, 1.0},
    {1.0, 0, 0, 0, 0, 0, 0, 0}, {0, 1.0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 1.0, 0}, {0, 0, 0, 0, 0, 0, 0, 1.0}};
float iamf514_bs470[][12] = {{1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                             {0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                             {0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                             {0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0},
                             {0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0},
                             {0, 0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0},
                             {0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0},
                             {0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0, 0},
                             {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0},
                             {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0}};
float iamf514_iamf312[][6] = {{1.0, 0, 0, 0, 0, 0},          // L
                              {0, 1.0, 0, 0, 0, 0},          // R
                              {0, 0, 1.0, 0, 0, 0},          // C
                              {0, 0, 0, 1.0, 0, 0},          // Lfe
                              {0.70710678, 0, 0, 0, 0, 0},   // Ls
                              {0, 0.70710678, 0, 0, 0, 0},   // Rs
                              {0, 0, 0, 0, 1.0, 0},          // Hfl
                              {0, 0, 0, 0, 0, 1.0},          // Hfr
                              {0, 0, 0, 0, 0.70710678, 0},   // Hbl
                              {0, 0, 0, 0, 0, 0.70710678}};  // Hbr
// 5.1.4->7.1.4->7.1.2
float iamf514_iamf712[][10] = {{1, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                               {0, 1, 0, 0, 0, 0, 0, 0, 0, 0},
                               {0, 0, 1, 0, 0, 0, 0, 0, 0, 0},
                               {0, 0, 0, 1, 0, 0, 0, 0, 0, 0},
                               {0, 0, 0, 0, 0, 0, 1, 0, 0, 0},
                               {0, 0, 0, 0, 0, 0, 0, 1, 0, 0},
                               {0, 0, 0, 0, 0, 0, 0, 0, 1, 0},
                               {0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
                               {0, 0, 0, 0, 0, 0, 0, 0, 0.7071067811865476, 0},
                               {0, 0, 0, 0, 0, 0, 0, 0, 0, 0.7071067811865476}};
float iamf514_mono[][1] = {{0.5},
                           {0.5},
                           {0.7071067811865476},
                           {0},
                           {0.3535533905932738},
                           {0.3535533905932738},
                           {0.5},
                           {0.5},
                           {0.3535533905932738},
                           {0.3535533905932738}};
/////////////////////////////////////

float iamf71_bs020[][2] = {{1, 0},
                           {0, 1},
                           {0.7071067811865476, 0.7071067811865476},
                           {0, 0},
                           {0.7071067811865476, 0},
                           {0, 0.7071067811865476},
                           {0.7071067811865476, 0},
                           {0, 0.7071067811865476}};
float iamf71_bs050[][6] = {{1, 0, 0, 0, 0, 0},
                           {0, 1, 0, 0, 0, 0},
                           {0, 0, 1, 0, 0, 0},
                           {0, 0, 0, 1, 0, 0},
                           {0.7071067811865476, 0, 0, 0, 0.7071067811865476, 0},
                           {0, 0.7071067811865476, 0, 0, 0, 0.7071067811865476},
                           {0, 0, 0, 0, 1, 0},
                           {0, 0, 0, 0, 0, 1}};
float iamf71_bs250[][8] = {
    {1, 0, 0, 0, 0, 0, 0, 0},
    {0, 1, 0, 0, 0, 0, 0, 0},
    {0, 0, 1, 0, 0, 0, 0, 0},
    {0, 0, 0, 1, 0, 0, 0, 0},
    {0.7071067811865476, 0, 0, 0, 0.7071067811865476, 0, 0, 0},
    {0, 0.7071067811865476, 0, 0, 0, 0.7071067811865476, 0, 0},
    {0, 0, 0, 0, 1, 0, 0, 0},
    {0, 0, 0, 0, 0, 1, 0, 0}};
float iamf71_bs450[][10] = {
    {1, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 1, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 1, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 1, 0, 0, 0, 0, 0, 0},
    {0.7071067811865476, 0, 0, 0, 0.7071067811865476, 0, 0, 0, 0, 0},
    {0, 0.7071067811865476, 0, 0, 0, 0.7071067811865476, 0, 0, 0, 0},
    {0, 0, 0, 0, 1, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 1, 0, 0, 0, 0}};
float iamf71_bs451[][11] = {
    {1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0},
    {0.7071067811865476, 0, 0, 0, 0.7071067811865476, 0, 0, 0, 0, 0, 0},
    {0, 0.7071067811865476, 0, 0, 0, 0.7071067811865476, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0}};
float iamf71_bs370[][12] = {
    {0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0},
    {0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0}};
float iamf71_bs490[][14] = {{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                            {0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                            {0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                            {0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                            {0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                            {0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0},
                            {0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0},
                            {0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0}};
float iamf71_bs9A3[][24] = {
    {0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};
float iamf71_bs070[][8] = {
    {1.0, 0, 0, 0, 0, 0, 0, 0}, {0, 1.0, 0, 0, 0, 0, 0, 0},
    {0, 0, 1.0, 0, 0, 0, 0, 0}, {0, 0, 0, 1.0, 0, 0, 0, 0},
    {0, 0, 0, 0, 1.0, 0, 0, 0}, {0, 0, 0, 0, 0, 1.0, 0, 0},
    {0, 0, 0, 0, 0, 0, 1.0, 0}, {0, 0, 0, 0, 0, 0, 0, 1.0}};
float iamf71_bs470[][12] = {
    {1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0}};
float iamf71_iamf312[][6] = {{1.0, 0, 0, 0, 0, 0},                // L
                             {0.0, 1.0, 0, 0, 0, 0},              // R
                             {0.0, 0, 1.0, 0, 0, 0},              // C
                             {0.0, 0, 0, 1.0, 0, 0},              // Lfe
                             {0.70710678, 0, 0, 0, 0, 0},         // Ls
                             {0, 0.70710678, 0, 0, 0, 0},         // Rs
                             {0.70710678, 0, 0, 0, 0, 0},         // Lb
                             {0, 0.70710678, 0, 0, 0}};           // Rb
float iamf71_iamf712[][10] = {{1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0},   // L
                              {0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0},   // R
                              {0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0},   // C
                              {0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0},   // Lfe
                              {0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0},   // Ls
                              {0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0},   // Rs
                              {0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0},   // Lb
                              {0, 0, 0, 0, 0, 0, 0, 1.0, 0, 0}};  // Rb
float iamf71_mono[][1] = {{0.5},
                          {0.5},
                          {0.7071067811865476},
                          {0},
                          {0.3535533905932738},
                          {0.3535533905932738},
                          {0.3535533905932738},
                          {0.3535533905932738}};
///////////////////////////////////////

float iamf712_bs020[][2] = {{1, 0},
                            {0, 1},
                            {0.7071067811865476, 0.7071067811865476},
                            {0, 0},
                            {0.7071067811865476, 0},
                            {0, 0.7071067811865476},
                            {0.7071067811865476, 0},
                            {0, 0.7071067811865476},
                            {1, 0},
                            {0, 1}};
float iamf712_bs050[][6] = {
    {1, 0, 0, 0, 0, 0},
    {0, 1, 0, 0, 0, 0},
    {0, 0, 1, 0, 0, 0},
    {0, 0, 0, 1, 0, 0},
    {0.7071067811865476, 0, 0, 0, 0.7071067811865476, 0},
    {0, 0.7071067811865476, 0, 0, 0, 0.7071067811865476},
    {0, 0, 0, 0, 1, 0},
    {0, 0, 0, 0, 0, 1},
    {1, 0, 0, 0, 0, 0},
    {0, 1, 0, 0, 0, 0}};
float iamf712_bs250[][8] = {
    {1, 0, 0, 0, 0, 0, 0, 0},
    {0, 1, 0, 0, 0, 0, 0, 0},
    {0, 0, 1, 0, 0, 0, 0, 0},
    {0, 0, 0, 1, 0, 0, 0, 0},
    {0.7071067811865476, 0, 0, 0, 0.7071067811865476, 0, 0, 0},
    {0, 0.7071067811865476, 0, 0, 0, 0.7071067811865476, 0, 0},
    {0, 0, 0, 0, 1, 0, 0, 0},
    {0, 0, 0, 0, 0, 1, 0, 0},
    {0, 0, 0, 0, 0, 0, 1, 0},
    {0, 0, 0, 0, 0, 0, 0, 1}};
float iamf712_bs450[][10] = {
    {1, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 1, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 1, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 1, 0, 0, 0, 0, 0, 0},
    {0.7071067811865476, 0, 0, 0, 0.7071067811865476, 0, 0, 0, 0, 0},
    {0, 0.7071067811865476, 0, 0, 0, 0.7071067811865476, 0, 0, 0, 0},
    {0, 0, 0, 0, 1, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 1, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 1, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 1, 0, 0}};
float iamf712_bs451[][11] = {
    {1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0},
    {0.7071067811865476, 0, 0, 0, 0.7071067811865476, 0, 0, 0, 0, 0, 0},
    {0, 0.7071067811865476, 0, 0, 0, 0.7071067811865476, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0}};
float iamf712_bs370[][12] = {
    {0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},   // L
    {0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0},   // R
    {1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},   // C
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0},   // LFE
    {0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0},   // Ls
    {0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0},   // Rs
    {0, 0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0},   // Lb
    {0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0},   // Rb
    {0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0},   // HL --> CH(UH+180)???
    {0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0}};  // HR --> CH(UH+180)???
float iamf712_bs490[][14] = {
    {1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},   // L
    {0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},   // R
    {0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},   // C
    {0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},   // LFE
    {0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0},   // Ls
    {0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0},   // Rs
    {0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0},   // Lb
    {0, 0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0},   // Rb
    {0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0},   // HL
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0}};  // HR
float iamf712_bs9A3[][24] = {
    {0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};
float iamf712_bs070[][8] = {
    {1, 0, 0, 0, 0, 0, 0, 0}, {0, 1, 0, 0, 0, 0, 0, 0},
    {0, 0, 1, 0, 0, 0, 0, 0}, {0, 0, 0, 1, 0, 0, 0, 0},
    {0, 0, 0, 0, 1, 0, 0, 0}, {0, 0, 0, 0, 0, 1, 0, 0},
    {0, 0, 0, 0, 0, 0, 1, 0}, {0, 0, 0, 0, 0, 0, 0, 1},
    {1, 0, 0, 0, 0, 0, 0, 0}, {0, 1, 0, 0, 0, 0, 0, 0}};               // HR
float iamf712_bs470[][12] = {{1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},   // L
                             {0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},   // R
                             {0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0},   // C
                             {0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0},   // LFE
                             {0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0},   // Ls
                             {0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0},   // Rs
                             {0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0},   // Lb
                             {0, 0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0},   // Rb
                             {0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0},   // HL
                             {0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0, 0}};  // HR
float iamf712_iamf312[][6] = {{1.0, 0, 0, 0, 0, 0},                    // L
                              {0, 1.0, 0, 0, 0, 0},                    // R
                              {0, 0, 1.0, 0, 0, 0},                    // C
                              {0, 0, 0, 1.0, 0, 0},                    // Lfe
                              {0.70710678, 0, 0, 0, 0, 0},             // Ls
                              {0, 0.70710678, 0, 0, 0, 0},             // Rs
                              {0.70710678, 0, 0, 0, 0, 0},             // Lb
                              {0, 0.70710678, 0, 0, 0, 0},             // Rb
                              {0, 0, 0, 0, 1.0, 0},                    // Hfl
                              {0, 0, 0, 0, 0, 1.0}};                   // Hfr
float iamf712_iamf712[][10] = {{1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0},       // L
                               {0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0},       // R
                               {0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0},       // C
                               {0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0},       // LFE
                               {0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0},       // Ls
                               {0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0},       // Rs
                               {0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0},       // Lb
                               {0, 0, 0, 0, 0, 0, 0, 1.0, 0, 0},       // Rb
                               {0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0},       // HL
                               {0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0}};      // HR
float iamf712_mono[][1] = {{0.5},
                           {0.5},
                           {0.7071067811865476},
                           {0},
                           {0.3535533905932738},
                           {0.3535533905932738},
                           {0.3535533905932738},
                           {0.3535533905932738},
                           {0.5},
                           {0.5}};
///////////////////////////////////////

float iamf714_bs020[][2] = {{1, 0},
                            {0, 1},
                            {0.7071067811865476, 0.7071067811865476},
                            {0, 0},
                            {0.7071067811865476, 0},
                            {0, 0.7071067811865476},
                            {0.7071067811865476, 0},
                            {0, 0.7071067811865476},
                            {1, 0},
                            {0, 1},
                            {0.7071067811865476, 0},
                            {0, 0.7071067811865476}};
float iamf714_bs050[][6] = {
    {1, 0, 0, 0, 0, 0},
    {0, 1, 0, 0, 0, 0},
    {0, 0, 1, 0, 0, 0},
    {0, 0, 0, 1, 0, 0},
    {0.7071067811865476, 0, 0, 0, 0.7071067811865476, 0},
    {0, 0.7071067811865476, 0, 0, 0, 0.7071067811865476},
    {0, 0, 0, 0, 1, 0},
    {0, 0, 0, 0, 0, 1},
    {1, 0, 0, 0, 0, 0},
    {0, 1, 0, 0, 0, 0},
    {0, 0, 0, 0, 1, 0},
    {0, 0, 0, 0, 0, 1}};
float iamf714_bs250[][8] = {
    {1, 0, 0, 0, 0, 0, 0, 0},
    {0, 1, 0, 0, 0, 0, 0, 0},
    {0, 0, 1, 0, 0, 0, 0, 0},
    {0, 0, 0, 1, 0, 0, 0, 0},
    {0.7071067811865476, 0, 0, 0, 0.7071067811865476, 0, 0, 0},
    {0, 0.7071067811865476, 0, 0, 0, 0.7071067811865476, 0, 0},
    {0, 0, 0, 0, 1, 0, 0, 0},
    {0, 0, 0, 0, 0, 1, 0, 0},
    {0, 0, 0, 0, 0, 0, 1, 0},
    {0, 0, 0, 0, 0, 0, 0, 1},
    {0, 0, 0, 0, 1, 0, 0, 0},
    {0, 0, 0, 0, 0, 1, 0, 0}};
float iamf714_bs450[][10] = {
    {1, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 1, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 1, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 1, 0, 0, 0, 0, 0, 0},
    {0.7071067811865476, 0, 0, 0, 0.7071067811865476, 0, 0, 0, 0, 0},
    {0, 0.7071067811865476, 0, 0, 0, 0.7071067811865476, 0, 0, 0, 0},
    {0, 0, 0, 0, 1, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 1, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 1, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 1, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 0, 1, 0},
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 1}};
float iamf714_bs451[][11] = {
    {1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0},
    {0.7071067811865476, 0, 0, 0, 0.7071067811865476, 0, 0, 0, 0, 0, 0},
    {0, 0.7071067811865476, 0, 0, 0, 0.7071067811865476, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0}};
float iamf714_bs370[][12] = {
    {0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0},
    {0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0},
    {0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0.7071067811865476, 0, 0, 0, 0, 0, 0.7071067811865476, 0, 0},
    {0, 0, 0, 0, 0.7071067811865476, 0, 0, 0, 0, 0.7071067811865476, 0, 0}};
float iamf714_bs490[][14] = {{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                             {0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                             {0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                             {0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                             {0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                             {0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0},
                             {0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0},
                             {0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0},
                             {0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0},
                             {0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0},
                             {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0},
                             {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0}};
float iamf714_bs9A3[][24] = {
    {0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0}};
float iamf714_bs070[][8] = {{1, 0, 0, 0, 0, 0, 0, 0}, {0, 1, 0, 0, 0, 0, 0, 0},
                            {0, 0, 1, 0, 0, 0, 0, 0}, {0, 0, 0, 1, 0, 0, 0, 0},
                            {0, 0, 0, 0, 1, 0, 0, 0}, {0, 0, 0, 0, 0, 1, 0, 0},
                            {0, 0, 0, 0, 0, 0, 1, 0}, {0, 0, 0, 0, 0, 0, 0, 1},
                            {1, 0, 0, 0, 0, 0, 0, 0}, {0, 1, 0, 0, 0, 0, 0, 0},
                            {0, 0, 0, 0, 0, 0, 1, 0}, {0, 0, 0, 0, 0, 0, 0, 1}};
float iamf714_bs470[][12] = {{1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                             {0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                             {0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                             {0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0},
                             {0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0},
                             {0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0},
                             {0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0},
                             {0, 0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0},
                             {0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0},
                             {0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0, 0},
                             {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0},
                             {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0}};
float iamf714_iamf312[][6] = {{1.0, 0, 0, 0, 0, 0},          // L
                              {0, 1.0, 0, 0, 0, 0},          // R
                              {0, 0, 1.0, 0, 0, 0},          // C
                              {0, 0, 0, 1.0, 0, 0},          // Lfe
                              {0.70710678, 0, 0, 0, 0, 0},   // Ls
                              {0, 0.70710678, 0, 0, 0, 0},   // Rs
                              {0.70710678, 0, 0, 0, 0, 0},   // Lb
                              {0, 0.70710678, 0, 0, 0, 0},   // Rb
                              {0, 0, 0, 0, 1.0, 0},          // Hfl
                              {0, 0, 0, 0, 0, 1.0},          // Hfr
                              {0, 0, 0, 0, 0.70710678, 0},   // Hbl
                              {0, 0, 0, 0, 0, 0.70710678}};  // Hbr
float iamf714_iamf712[][10] = {{1, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                               {0, 1, 0, 0, 0, 0, 0, 0, 0, 0},
                               {0, 0, 1, 0, 0, 0, 0, 0, 0, 0},
                               {0, 0, 0, 1, 0, 0, 0, 0, 0, 0},
                               {0, 0, 0, 0, 1, 0, 0, 0, 0, 0},
                               {0, 0, 0, 0, 0, 1, 0, 0, 0, 0},
                               {0, 0, 0, 0, 0, 0, 1, 0, 0, 0},
                               {0, 0, 0, 0, 0, 0, 0, 1, 0, 0},
                               {0, 0, 0, 0, 0, 0, 0, 0, 1, 0},
                               {0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
                               {0, 0, 0, 0, 0, 0, 0, 0, 0.7071067811865476, 0},
                               {0, 0, 0, 0, 0, 0, 0, 0, 0, 0.7071067811865476}};
float iamf714_mono[][1] = {{0.5},
                           {0.5},
                           {0.7071067811865476},
                           {0},
                           {0.3535533905932738},
                           {0.3535533905932738},
                           {0.3535533905932738},
                           {0.3535533905932738},
                           {0.5},
                           {0.5},
                           {0.3535533905932738},
                           {0.3535533905932738}};
///////////////////////////////////////

float iamf312_bs020[][2] = {{1.0, 0}, {0, 1.0}, {0.70710678, 0.70710678},
                            {0, 0},   {1.0, 0}, {0, 1.0}};
float iamf312_bs050[][6] = {{1.0, 0, 0, 0, 0, 0}, {0, 1.0, 0, 0, 0, 0},
                            {0, 0, 1.0, 0, 0, 0}, {0, 0, 0, 1.0, 0, 0},
                            {1.0, 0, 0, 0, 0, 0}, {0, 1.0, 0, 0, 0, 0}};
float iamf312_bs250[][8] = {
    {1.0, 0, 0, 0, 0, 0, 0, 0}, {0, 1.0, 0, 0, 0, 0, 0, 0},
    {0, 0, 1.0, 0, 0, 0, 0, 0}, {0, 0, 0, 1.0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 1.0, 0}, {0, 0, 0, 0, 0, 0, 0, 1.0}};
float iamf312_bs450[][10] = {
    {1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 1.0, 0, 0}};
float iamf312_bs451[][11] = {
    {1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0}};
float iamf312_bs370[][12] = {{0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                             {0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                             {1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                             {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0},
                             {0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0},
                             {0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0}};
float iamf312_bs490[][14] = {{1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                             {0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                             {0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                             {0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                             {0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0},
                             {0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0}};
float iamf312_bs9A3[][24] = {
    {0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};
float iamf312_bs070[][8] = {
    {1.0, 0, 0, 0, 0, 0, 0, 0}, {0, 1.0, 0, 0, 0, 0, 0, 0},
    {0, 0, 1.0, 0, 0, 0, 0, 0}, {0, 0, 0, 1.0, 0, 0, 0, 0},
    {1.0, 0, 0, 0, 0, 0, 0, 0}, {0, 1.0, 0, 0, 0, 0, 0, 0}};
float iamf312_bs470[][12] = {{1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                             {0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                             {0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                             {0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0},
                             {0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0, 0, 0},
                             {0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0, 0}};
float iamf312_iamf312[][6] = {{1.0, 0, 0, 0, 0, 0},   // L
                              {0, 1.0, 0, 0, 0, 0},   // R
                              {0, 0, 1.0, 0, 0, 0},   // C
                              {0, 0, 0, 1.0, 0, 0},   // Lfe
                              {0, 0, 0, 0, 1.0, 0},   // Hfl
                              {0, 0, 0, 0, 0, 1.0}};  // Hfr
// 3.1.2->7.1.4->7.1.2
float iamf312_iamf712[][10] = {{1.0, 0, 0, 0, 0, 0, 0, 0, 0, 0},   // L
                               {0, 1.0, 0, 0, 0, 0, 0, 0, 0, 0},   // R
                               {0, 0, 1.0, 0, 0, 0, 0, 0, 0, 0},   // C
                               {0, 0, 0, 1.0, 0, 0, 0, 0, 0, 0},   // Lfe
                               {0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0},   // Hfl
                               {0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0}};  // Hfr
float iamf312_mono[][1] = {{0.5}, {0.5}, {0.70710678}, {0.0}, {0.5}, {0.5}};
////////////////////////////////

struct m2m_rdr_t m2m_rdr_tab[] = {
    {IAMF_MONO, BS2051_A, (float *)mono_bs020, 1, 2},
    {IAMF_MONO, BS2051_B, (float *)mono_bs050, 1, 6},
    {IAMF_MONO, BS2051_C, (float *)mono_bs250, 1, 8},
    {IAMF_MONO, BS2051_D, (float *)mono_bs450, 1, 10},
    {IAMF_MONO, BS2051_E, (float *)mono_bs451, 1, 11},
    {IAMF_MONO, BS2051_F, (float *)mono_bs370, 1, 12},
    {IAMF_MONO, BS2051_G, (float *)mono_bs490, 1, 14},
    {IAMF_MONO, BS2051_H, (float *)mono_bs9A3, 1, 24},
    {IAMF_MONO, BS2051_I, (float *)mono_bs070, 1, 8},
    {IAMF_MONO, BS2051_J, (float *)mono_bs470, 1, 12},
    {IAMF_MONO, IAMF_312, (float *)mono_iamf312, 1, 6},
    {IAMF_MONO, IAMF_712, (float *)mono_iamf712, 1, 10},
    {IAMF_MONO, IAMF_BINAURAL, (float *)mono_bs020, 1, 2},
    {IAMF_MONO, IAMF_MONO, (float *)mono_mono, 1, 1},

    {IAMF_STEREO, BS2051_A, (float *)stereo_bs020, 2, 2},
    {IAMF_STEREO, BS2051_B, (float *)stereo_bs050, 2, 6},
    {IAMF_STEREO, BS2051_C, (float *)stereo_bs250, 2, 8},
    {IAMF_STEREO, BS2051_D, (float *)stereo_bs450, 2, 10},
    {IAMF_STEREO, BS2051_E, (float *)stereo_bs451, 2, 11},
    {IAMF_STEREO, BS2051_F, (float *)stereo_bs370, 2, 12},
    {IAMF_STEREO, BS2051_G, (float *)stereo_bs490, 2, 14},
    {IAMF_STEREO, BS2051_H, (float *)stereo_bs9A3, 2, 24},
    {IAMF_STEREO, BS2051_I, (float *)stereo_bs070, 2, 8},
    {IAMF_STEREO, BS2051_J, (float *)stereo_bs470, 2, 12},
    {IAMF_STEREO, IAMF_312, (float *)stereo_iamf312, 2, 6},
    {IAMF_STEREO, IAMF_712, (float *)stereo_iamf712, 2, 10},
    {IAMF_STEREO, IAMF_BINAURAL, (float *)stereo_bs020, 2, 2},
    {IAMF_STEREO, IAMF_MONO, (float *)stereo_mono, 2, 1},

    {IAMF_312, BS2051_A, (float *)iamf312_bs020, 6, 2},
    {IAMF_312, BS2051_B, (float *)iamf312_bs050, 6, 6},
    {IAMF_312, BS2051_C, (float *)iamf312_bs250, 6, 8},
    {IAMF_312, BS2051_D, (float *)iamf312_bs450, 6, 10},
    {IAMF_312, BS2051_E, (float *)iamf312_bs451, 6, 11},
    {IAMF_312, BS2051_F, (float *)iamf312_bs370, 6, 12},
    {IAMF_312, BS2051_G, (float *)iamf312_bs490, 6, 14},
    {IAMF_312, BS2051_H, (float *)iamf312_bs9A3, 6, 24},
    {IAMF_312, BS2051_I, (float *)iamf312_bs070, 6, 8},
    {IAMF_312, BS2051_J, (float *)iamf312_bs470, 6, 12},
    {IAMF_312, IAMF_312, (float *)iamf312_iamf312, 6, 6},
    {IAMF_312, IAMF_712, (float *)iamf312_iamf712, 6, 10},
    {IAMF_312, IAMF_BINAURAL, (float *)iamf312_bs020, 6, 2},
    {IAMF_312, IAMF_MONO, (float *)iamf312_mono, 6, 1},

    {IAMF_51, BS2051_A, (float *)iamf51_bs020, 6, 2},
    {IAMF_51, BS2051_B, (float *)iamf51_bs050, 6, 6},
    {IAMF_51, BS2051_C, (float *)iamf51_bs250, 6, 8},
    {IAMF_51, BS2051_D, (float *)iamf51_bs450, 6, 10},
    {IAMF_51, BS2051_E, (float *)iamf51_bs451, 6, 11},
    {IAMF_51, BS2051_F, (float *)iamf51_bs370, 6, 12},
    {IAMF_51, BS2051_G, (float *)iamf51_bs490, 6, 14},
    {IAMF_51, BS2051_H, (float *)iamf51_bs9A3, 6, 24},
    {IAMF_51, BS2051_I, (float *)iamf51_bs070, 6, 8},
    {IAMF_51, BS2051_J, (float *)iamf51_bs470, 6, 12},
    {IAMF_51, IAMF_312, (float *)iamf51_iamf312, 6, 6},
    {IAMF_51, IAMF_712, (float *)iamf51_iamf712, 6, 10},
    {IAMF_51, IAMF_BINAURAL, (float *)iamf51_bs020, 6, 2},
    {IAMF_51, IAMF_MONO, (float *)iamf51_mono, 6, 1},

    {IAMF_512, BS2051_A, (float *)iamf512_bs020, 8, 2},
    {IAMF_512, BS2051_B, (float *)iamf512_bs050, 8, 6},
    {IAMF_512, BS2051_C, (float *)iamf512_bs250, 8, 8},
    {IAMF_512, BS2051_D, (float *)iamf512_bs450, 8, 10},
    {IAMF_512, BS2051_E, (float *)iamf512_bs451, 8, 11},
    {IAMF_512, BS2051_F, (float *)iamf512_bs370, 8, 12},
    {IAMF_512, BS2051_G, (float *)iamf512_bs490, 8, 14},
    {IAMF_512, BS2051_H, (float *)iamf512_bs9A3, 8, 24},
    {IAMF_512, BS2051_I, (float *)iamf512_bs070, 8, 8},
    {IAMF_512, BS2051_J, (float *)iamf512_bs470, 8, 12},
    {IAMF_512, IAMF_312, (float *)iamf512_iamf312, 8, 6},
    {IAMF_512, IAMF_712, (float *)iamf512_iamf712, 8, 10},
    {IAMF_512, IAMF_BINAURAL, (float *)iamf512_bs020, 8, 2},
    {IAMF_512, IAMF_MONO, (float *)iamf512_mono, 8, 1},

    {IAMF_514, BS2051_A, (float *)iamf514_bs020, 10, 2},
    {IAMF_514, BS2051_B, (float *)iamf514_bs050, 10, 6},
    {IAMF_514, BS2051_C, (float *)iamf514_bs250, 10, 8},
    {IAMF_514, BS2051_D, (float *)iamf514_bs450, 10, 10},
    {IAMF_514, BS2051_E, (float *)iamf514_bs451, 10, 11},
    {IAMF_514, BS2051_F, (float *)iamf514_bs370, 10, 12},
    {IAMF_514, BS2051_G, (float *)iamf514_bs490, 10, 14},
    {IAMF_514, BS2051_H, (float *)iamf514_bs9A3, 10, 24},
    {IAMF_514, BS2051_I, (float *)iamf514_bs070, 10, 8},
    {IAMF_514, BS2051_J, (float *)iamf514_bs470, 10, 12},
    {IAMF_514, IAMF_312, (float *)iamf514_iamf312, 10, 6},
    {IAMF_514, IAMF_712, (float *)iamf514_iamf712, 10, 10},
    {IAMF_514, IAMF_BINAURAL, (float *)iamf514_bs020, 10, 2},
    {IAMF_514, IAMF_MONO, (float *)iamf514_mono, 10, 1},

    {IAMF_71, BS2051_A, (float *)iamf71_bs020, 8, 2},
    {IAMF_71, BS2051_B, (float *)iamf71_bs050, 8, 6},
    {IAMF_71, BS2051_C, (float *)iamf71_bs250, 8, 8},
    {IAMF_71, BS2051_D, (float *)iamf71_bs450, 8, 10},
    {IAMF_71, BS2051_E, (float *)iamf71_bs451, 8, 11},
    {IAMF_71, BS2051_F, (float *)iamf71_bs370, 8, 12},
    {IAMF_71, BS2051_G, (float *)iamf71_bs490, 8, 14},
    {IAMF_71, BS2051_H, (float *)iamf71_bs9A3, 8, 24},
    {IAMF_71, BS2051_I, (float *)iamf71_bs070, 8, 8},
    {IAMF_71, BS2051_J, (float *)iamf71_bs470, 8, 12},
    {IAMF_71, IAMF_312, (float *)iamf71_iamf312, 8, 6},
    {IAMF_71, IAMF_712, (float *)iamf71_iamf712, 8, 10},
    {IAMF_71, IAMF_BINAURAL, (float *)iamf71_bs020, 8, 2},
    {IAMF_71, IAMF_MONO, (float *)iamf71_mono, 8, 1},

    {IAMF_712, BS2051_A, (float *)iamf712_bs020, 10, 2},
    {IAMF_712, BS2051_B, (float *)iamf712_bs050, 10, 6},
    {IAMF_712, BS2051_C, (float *)iamf712_bs250, 10, 8},
    {IAMF_712, BS2051_D, (float *)iamf712_bs450, 10, 10},
    {IAMF_712, BS2051_E, (float *)iamf712_bs451, 10, 11},
    {IAMF_712, BS2051_F, (float *)iamf712_bs370, 10, 12},
    {IAMF_712, BS2051_G, (float *)iamf712_bs490, 10, 14},
    {IAMF_712, BS2051_H, (float *)iamf712_bs9A3, 10, 24},
    {IAMF_712, BS2051_I, (float *)iamf712_bs070, 10, 8},
    {IAMF_712, BS2051_J, (float *)iamf712_bs470, 10, 12},
    {IAMF_712, IAMF_312, (float *)iamf712_iamf312, 10, 6},
    {IAMF_712, IAMF_712, (float *)iamf712_iamf712, 10, 10},
    {IAMF_712, IAMF_BINAURAL, (float *)iamf712_bs020, 10, 2},
    {IAMF_712, IAMF_MONO, (float *)iamf712_mono, 10, 1},

    {IAMF_714, BS2051_A, (float *)iamf714_bs020, 12, 2},
    {IAMF_714, BS2051_B, (float *)iamf714_bs050, 12, 6},
    {IAMF_714, BS2051_C, (float *)iamf714_bs250, 12, 8},
    {IAMF_714, BS2051_D, (float *)iamf714_bs450, 12, 10},
    {IAMF_714, BS2051_E, (float *)iamf714_bs451, 12, 11},
    {IAMF_714, BS2051_F, (float *)iamf714_bs370, 12, 12},
    {IAMF_714, BS2051_G, (float *)iamf714_bs490, 12, 14},
    {IAMF_714, BS2051_H, (float *)iamf714_bs9A3, 12, 24},
    {IAMF_714, BS2051_I, (float *)iamf714_bs070, 12, 8},
    {IAMF_714, BS2051_J, (float *)iamf714_bs470, 12, 12},
    {IAMF_714, IAMF_312, (float *)iamf714_iamf312, 12, 6},
    {IAMF_714, IAMF_712, (float *)iamf714_iamf712, 12, 10},
    {IAMF_714, IAMF_BINAURAL, (float *)iamf714_bs020, 12, 2},
    {IAMF_714, IAMF_MONO, (float *)iamf714_mono, 12, 1},

    {IAMF_BINAURAL, BS2051_A, (float *)stereo_bs020, 2, 2},
    {IAMF_BINAURAL, BS2051_B, (float *)stereo_bs050, 2, 6},
    {IAMF_BINAURAL, BS2051_C, (float *)stereo_bs250, 2, 8},
    {IAMF_BINAURAL, BS2051_D, (float *)stereo_bs450, 2, 10},
    {IAMF_BINAURAL, BS2051_E, (float *)stereo_bs451, 2, 11},
    {IAMF_BINAURAL, BS2051_F, (float *)stereo_bs370, 2, 12},
    {IAMF_BINAURAL, BS2051_G, (float *)stereo_bs490, 2, 14},
    {IAMF_BINAURAL, BS2051_H, (float *)stereo_bs9A3, 2, 24},
    {IAMF_BINAURAL, BS2051_I, (float *)stereo_bs070, 2, 8},
    {IAMF_BINAURAL, BS2051_J, (float *)stereo_bs470, 2, 12},
    {IAMF_BINAURAL, IAMF_312, (float *)stereo_iamf312, 2, 6},
    {IAMF_BINAURAL, IAMF_712, (float *)stereo_iamf712, 2, 10},
    {IAMF_BINAURAL, IAMF_BINAURAL, (float *)stereo_bs020, 2, 2},
    {IAMF_BINAURAL, IAMF_MONO, (float *)stereo_mono, 2, 1}};

/*
Layout in: Predefined Direct speaker input channel layout
Layout out: Predefined Direct speaker output channel layout
float *outMatrix: Conversion Matrix (MatrixSize = number of out channels x
number of in channels)
*/
int IAMF_element_renderer_get_M2M_matrix(IAMF_SP_LAYOUT *in_layout,
                                         IAMF_SP_LAYOUT *out_layout,
                                         struct m2m_rdr_t *outMatrix) {
  int i;

  if (in_layout->sp_type == 0 &&
      out_layout->sp_type ==
          0) {  // PRE-DEFINED LAYOUT(input) to PRE-DEFINED LAYOUT(output)
    for (i = 0; i < sizeof(m2m_rdr_tab) / sizeof(struct m2m_rdr_t); i++) {
      if (m2m_rdr_tab[i].in == in_layout->sp_layout.predefined_sp->system &&
          m2m_rdr_tab[i].out == out_layout->sp_layout.predefined_sp->system) {
        *outMatrix = m2m_rdr_tab[i];
        return (0);
      }
    }
  }

  return (-1);
}

/*
Layout in: Custom speaker input layout in render_config()
Layout out: Custom speaker output layout in authored_layout or Predefined
speaker output layout float *outMatrix: Conversion Matrix (MatrixSize = number
of out channels x number of in channels)
*/
int IAMF_element_renderer_get_M2M_custom_matrix(
    IAMF_SP_LAYOUT *in_layout, IAMF_CUSTOM_SP_LAYOUT *out_layout,
    struct m2m_rdr_t *outMatrix) {
  // not implemented yet
  return (-1);
}

// Multichannel to Multichannel Renderer
int IAMF_element_renderer_render_M2M(struct m2m_rdr_t *m2mMatrix, float *in[],
                                     float *out[], int nsamples) {
  int i, m, n;
  int m_size = m2mMatrix->m;
  int n_size = m2mMatrix->n;

  for (i = 0; i < nsamples; i++) {
    for (m = 0; m < m_size; m++)  // input
    {
      for (n = 0; n < n_size; n++)  // output
      {
        if (m == 0) {
          out[n][i] = 0;
        }
        out[n][i] += m2mMatrix->mat[m * n_size + n] * in[m][i];
      }
    }
  }

  return (0);
}
