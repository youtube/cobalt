<!DOCTYPE html>
<meta charset="utf-8"/>
<meta name="referrer" content="origin">
<head>
<!-- The token below was generated via the following command:
tools/origin_trials/generate_token.py https://web-platform.test:8444
DisableThirdPartyStoragePartitioning2 --expire-timestamp=2000000000 -->
<meta http-equiv="origin-trial" content="A2kO9VXomVHI2qXmDKzOIFbeBynCH0cFHdQsAJV2QjujjYKz5jHlNrcdGvgOrjZbRWHH/VUjmwuLOwBfraaFHg8AAAB2eyJvcmlnaW4iOiAiaHR0cHM6Ly93ZWItcGxhdGZvcm0udGVzdDo4NDQ0IiwgImZlYXR1cmUiOiAiRGlzYWJsZVRoaXJkUGFydHlTdG9yYWdlUGFydGl0aW9uaW5nMiIsICJleHBpcnkiOiAyMDAwMDAwMDAwfQ==">
</head>
<script>
async function onLoad() {
  // Nested Step 9:
  // wpt_internal/web-locks/storage-deprecation-trial-enabled.https.html
  self.addEventListener('message', evt => {
    if (self.opener)
      self.opener.postMessage(evt.data, '*');
    else
      self.top.postMessage(evt.data, '*');
  }, { once: true });

  // Nested Step 3:
  // wpt_internal/web-locks/storage-deprecation-trial-enabled.https.html
  const params = new URLSearchParams(self.location.search);
  const frame = document.createElement('iframe');
  frame.src = params.get('target');
  document.body.appendChild(frame);

  // Nested Step 4:
  // wpt_internal/web-locks/storage-deprecation-trial-enabled.https.html
  frame.addEventListener('load', function(){
    frame.contentWindow.postMessage({op: 'request',
        name: 'testLock', ifAvailable: true}, '*');
  });
}
self.addEventListener('load', onLoad);
</script>
