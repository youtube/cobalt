<!DOCTYPE html>
<script src="../../resources/run-after-layout-and-paint.js"></script>
<svg width="100" height="100">
  <pattern id="p" patternUnits="objectBoundingBox" width="100" height="100">
    <rect width="100" height="100" fill="green"/>
  </pattern>
  <line y1="50" x2="100" y2="50" stroke-width="100" stroke="url(#p) red"/>
</svg>
<script>
function changeToUSOU() {
  document.querySelector('pattern').setAttribute('patternUnits', 'userSpaceOnUse');
}

if (window.testRunner)
  testRunner.waitUntilDone();

window.onload = function() {
  runAfterLayoutAndPaint(function() {
    changeToUSOU();
    if (window.testRunner)
      runAfterLayoutAndPaint(function() { testRunner.notifyDone(); });
  });
};
</script>
