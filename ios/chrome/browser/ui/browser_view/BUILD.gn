# Copyright 2019 The Chromium Authors
# Use of this source code is governed by a BSD-style license that can be
# found in the LICENSE file.

source_set("browser_view") {
  sources = [
    "browser_coordinator+private.h",
    "browser_coordinator.h",
    "browser_coordinator.mm",
    "browser_view_controller+private.h",
    "browser_view_controller.h",
    "browser_view_controller.mm",
    "key_commands_provider.h",
    "key_commands_provider.mm",
    "safe_area_provider.h",
    "safe_area_provider.mm",
    "tab_consumer.h",
    "tab_events_mediator.h",
    "tab_events_mediator.mm",
    "tab_lifecycle_mediator.h",
    "tab_lifecycle_mediator.mm",
  ]
  deps = [
    "//base",
    "//base:i18n",
    "//components/bookmarks/browser",
    "//components/commerce/core:shopping_service",
    "//components/feature_engagement/public",
    "//components/image_fetcher/ios",
    "//components/language/ios/browser",
    "//components/omnibox/browser",
    "//components/password_manager/core/common:features",
    "//components/prefs",
    "//components/profile_metrics",
    "//components/reading_list/core",
    "//components/safe_browsing/core/common",
    "//components/segmentation_platform/embedder/default_model",
    "//components/sessions",
    "//components/signin/core/browser",
    "//components/signin/ios/browser",
    "//components/signin/ios/browser:active_state_manager",
    "//components/strings",
    "//components/translate/core/browser",
    "//components/ukm/ios:ukm_url_recorder",
    "//components/url_formatter",
    "//ios/chrome/app:tests_hook",
    "//ios/chrome/app/application_delegate:app_state_header",
    "//ios/chrome/app/strings",
    "//ios/chrome/browser/app_launcher/model",
    "//ios/chrome/browser/autofill:autofill_internal",
    "//ios/chrome/browser/autofill/bottom_sheet",
    "//ios/chrome/browser/bookmarks/model",
    "//ios/chrome/browser/browser_state_metrics/model",
    "//ios/chrome/browser/commerce/model:shopping_service",
    "//ios/chrome/browser/commerce/model/price_notifications",
    "//ios/chrome/browser/commerce/model/push_notification",
    "//ios/chrome/browser/content_settings/model",
    "//ios/chrome/browser/crash_report/model",
    "//ios/chrome/browser/credential_provider_promo/model:features",
    "//ios/chrome/browser/default_browser/model:utils",
    "//ios/chrome/browser/download",
    "//ios/chrome/browser/favicon",
    "//ios/chrome/browser/feature_engagement/model",
    "//ios/chrome/browser/find_in_page/model",
    "//ios/chrome/browser/find_in_page/model:util",
    "//ios/chrome/browser/follow:browser_agent",
    "//ios/chrome/browser/follow:service",
    "//ios/chrome/browser/follow:tab_helper",
    "//ios/chrome/browser/geolocation/model",
    "//ios/chrome/browser/infobars",
    "//ios/chrome/browser/intents:intents_donation_helper",
    "//ios/chrome/browser/itunes_urls/model",
    "//ios/chrome/browser/language/model",
    "//ios/chrome/browser/lens",
    "//ios/chrome/browser/link_to_text/model",
    "//ios/chrome/browser/main",
    "//ios/chrome/browser/metrics:metrics_browser_agent",
    "//ios/chrome/browser/metrics:metrics_internal",
    "//ios/chrome/browser/net",
    "//ios/chrome/browser/ntp",
    "//ios/chrome/browser/ntp:features",
    "//ios/chrome/browser/ntp:util",
    "//ios/chrome/browser/ntp/home:features",
    "//ios/chrome/browser/overlays",
    "//ios/chrome/browser/overlays/public/web_content_area",
    "//ios/chrome/browser/overscroll_actions/model",
    "//ios/chrome/browser/parcel_tracking:infobar_delegate",
    "//ios/chrome/browser/parcel_tracking:parcel_tracking_step",
    "//ios/chrome/browser/parcel_tracking:prefs",
    "//ios/chrome/browser/parcel_tracking:tracking_source",
    "//ios/chrome/browser/parcel_tracking:util",
    "//ios/chrome/browser/passwords/model",
    "//ios/chrome/browser/policy:policy_util",
    "//ios/chrome/browser/prefs/model",
    "//ios/chrome/browser/prerender/model",
    "//ios/chrome/browser/promos_manager:features",
    "//ios/chrome/browser/reading_list/model",
    "//ios/chrome/browser/segmentation_platform",
    "//ios/chrome/browser/send_tab_to_self/model",
    "//ios/chrome/browser/sessions",
    "//ios/chrome/browser/sessions:serialisation",
    "//ios/chrome/browser/settings/model/sync/utils",
    "//ios/chrome/browser/shared/coordinator/alert",
    "//ios/chrome/browser/shared/coordinator/chrome_coordinator",
    "//ios/chrome/browser/shared/coordinator/default_browser_promo",
    "//ios/chrome/browser/shared/coordinator/layout_guide",
    "//ios/chrome/browser/shared/coordinator/scene:scene_state_browser_agent",
    "//ios/chrome/browser/shared/coordinator/scene:scene_state_header",
    "//ios/chrome/browser/shared/model/application_context",
    "//ios/chrome/browser/shared/model/browser_state",
    "//ios/chrome/browser/shared/model/prefs:pref_names",
    "//ios/chrome/browser/shared/model/url:constants",
    "//ios/chrome/browser/shared/model/web_state_list",
    "//ios/chrome/browser/shared/public/commands",
    "//ios/chrome/browser/shared/public/features",
    "//ios/chrome/browser/shared/ui/elements:activity_overlay",
    "//ios/chrome/browser/shared/ui/util",
    "//ios/chrome/browser/shared/ui/util:url_with_title",
    "//ios/chrome/browser/signin",
    "//ios/chrome/browser/snapshots/model",
    "//ios/chrome/browser/ssl/model",
    "//ios/chrome/browser/store_kit/model",
    "//ios/chrome/browser/sync/model:sync_error_browser_agent",
    "//ios/chrome/browser/tab_insertion/model",
    "//ios/chrome/browser/translate/model",
    "//ios/chrome/browser/ui/app_store_rating:features",
    "//ios/chrome/browser/ui/authentication",
    "//ios/chrome/browser/ui/authentication:signin_presenter",
    "//ios/chrome/browser/ui/authentication/enterprise/enterprise_prompt",
    "//ios/chrome/browser/ui/autofill:autofill",
    "//ios/chrome/browser/ui/autofill/bottom_sheet",
    "//ios/chrome/browser/ui/autofill/form_input_accessory",
    "//ios/chrome/browser/ui/autofill/manual_fill",
    "//ios/chrome/browser/ui/bookmarks",
    "//ios/chrome/browser/ui/browser_container",
    "//ios/chrome/browser/ui/browser_container:ui",
    "//ios/chrome/browser/ui/bubble",
    "//ios/chrome/browser/ui/content_suggestions",
    "//ios/chrome/browser/ui/content_suggestions:content_suggestions_constant",
    "//ios/chrome/browser/ui/context_menu",
    "//ios/chrome/browser/ui/credential_provider_promo",
    "//ios/chrome/browser/ui/default_promo",
    "//ios/chrome/browser/ui/default_promo:default_promo_ui",
    "//ios/chrome/browser/ui/default_promo/promo_handler",
    "//ios/chrome/browser/ui/dialogs:dialogs_internal",
    "//ios/chrome/browser/ui/download",
    "//ios/chrome/browser/ui/download:features",
    "//ios/chrome/browser/ui/find_bar",
    "//ios/chrome/browser/ui/first_run",
    "//ios/chrome/browser/ui/first_run:utils",
    "//ios/chrome/browser/ui/follow",
    "//ios/chrome/browser/ui/follow:first_follow",
    "//ios/chrome/browser/ui/follow:follow_iph",
    "//ios/chrome/browser/ui/fullscreen",
    "//ios/chrome/browser/ui/fullscreen:ui",
    "//ios/chrome/browser/ui/history",
    "//ios/chrome/browser/ui/incognito_reauth:incognito_reauth_commands",
    "//ios/chrome/browser/ui/incognito_reauth:incognito_reauth_scene_agent",
    "//ios/chrome/browser/ui/incognito_reauth:incognito_reauth_ui",
    "//ios/chrome/browser/ui/infobars:public",
    "//ios/chrome/browser/ui/keyboard",
    "//ios/chrome/browser/ui/lens:coordinator",
    "//ios/chrome/browser/ui/location_bar",
    "//ios/chrome/browser/ui/main:default_browser_scene_agent",
    "//ios/chrome/browser/ui/main_content:main_content_ui",
    "//ios/chrome/browser/ui/main_content:main_content_ui_broadcasting_util",
    "//ios/chrome/browser/ui/mini_map",
    "//ios/chrome/browser/ui/ntp",
    "//ios/chrome/browser/ui/ntp:component_factory",
    "//ios/chrome/browser/ui/ntp:coordinator",
    "//ios/chrome/browser/ui/ntp:logo",
    "//ios/chrome/browser/ui/omnibox",
    "//ios/chrome/browser/ui/omnibox:omnibox_internal",
    "//ios/chrome/browser/ui/omnibox/popup",
    "//ios/chrome/browser/ui/overlays",
    "//ios/chrome/browser/ui/overscroll_actions",
    "//ios/chrome/browser/ui/page_info:coordinator",
    "//ios/chrome/browser/ui/page_info/requirements",
    "//ios/chrome/browser/ui/parcel_tracking",
    "//ios/chrome/browser/ui/passwords",
    "//ios/chrome/browser/ui/passwords/bottom_sheet",
    "//ios/chrome/browser/ui/popup_menu",
    "//ios/chrome/browser/ui/popup_menu/overflow_menu:feature_flags",
    "//ios/chrome/browser/ui/presenters",
    "//ios/chrome/browser/ui/price_notifications",
    "//ios/chrome/browser/ui/price_notifications:price_notifications_iph",
    "//ios/chrome/browser/ui/print",
    "//ios/chrome/browser/ui/promos_manager",
    "//ios/chrome/browser/ui/qr_scanner:coordinator",
    "//ios/chrome/browser/ui/reading_list",
    "//ios/chrome/browser/ui/recent_tabs",
    "//ios/chrome/browser/ui/sad_tab",
    "//ios/chrome/browser/ui/sad_tab:coordinator",
    "//ios/chrome/browser/ui/safe_browsing",
    "//ios/chrome/browser/ui/save_to_photos",
    "//ios/chrome/browser/ui/send_tab_to_self",
    "//ios/chrome/browser/ui/settings/autofill",
    "//ios/chrome/browser/ui/settings/password/password_settings",
    "//ios/chrome/browser/ui/sharing",
    "//ios/chrome/browser/ui/side_swipe",
    "//ios/chrome/browser/ui/snackbar",
    "//ios/chrome/browser/ui/spotlight_debugger",
    "//ios/chrome/browser/ui/start_surface:feature_flags",
    "//ios/chrome/browser/ui/tab_switcher/tab_strip",
    "//ios/chrome/browser/ui/tabs",
    "//ios/chrome/browser/ui/tabs:constants",
    "//ios/chrome/browser/ui/tabs:coordinator",
    "//ios/chrome/browser/ui/tabs/requirements",
    "//ios/chrome/browser/ui/text_fragments",
    "//ios/chrome/browser/ui/text_zoom",
    "//ios/chrome/browser/ui/text_zoom:text_zoom_ui",
    "//ios/chrome/browser/ui/toolbar",
    "//ios/chrome/browser/ui/toolbar:toolbar_ui",
    "//ios/chrome/browser/ui/toolbar/accessory",
    "//ios/chrome/browser/ui/toolbar/buttons",
    "//ios/chrome/browser/ui/toolbar/fullscreen",
    "//ios/chrome/browser/ui/toolbar/fullscreen:fullscreen_broadcasting_util",
    "//ios/chrome/browser/ui/toolbar/public",
    "//ios/chrome/browser/ui/unit_conversion",
    "//ios/chrome/browser/ui/voice",
    "//ios/chrome/browser/ui/webui",
    "//ios/chrome/browser/ui/whats_new",
    "//ios/chrome/browser/upgrade/model",
    "//ios/chrome/browser/url_loading/model",
    "//ios/chrome/browser/url_loading/model:new_tab_animation_tab_helper",
    "//ios/chrome/browser/view_source/model",
    "//ios/chrome/browser/voice/model",
    "//ios/chrome/browser/web",
    "//ios/chrome/browser/web:delegate",
    "//ios/chrome/browser/web:feature_flags",
    "//ios/chrome/browser/web:page_placeholder",
    "//ios/chrome/browser/web:tab_helper_delegates",
    "//ios/chrome/browser/web/annotations",
    "//ios/chrome/browser/web/font_size",
    "//ios/chrome/browser/web/print",
    "//ios/chrome/browser/web_state_list",
    "//ios/chrome/browser/web_state_list/web_usage_enabler",
    "//ios/chrome/browser/webui/model",
    "//ios/chrome/common",
    "//ios/chrome/common/ui/colors",
    "//ios/chrome/common/ui/promo_style",
    "//ios/chrome/common/ui/reauthentication",
    "//ios/chrome/common/ui/util",
    "//ios/components/security_interstitials",
    "//ios/components/webui:url_constants",
    "//ios/public/provider/chrome/browser/fullscreen:fullscreen_api",
    "//ios/public/provider/chrome/browser/lens:lens_api",
    "//ios/public/provider/chrome/browser/signin:choice_api",
    "//ios/public/provider/chrome/browser/text_zoom:text_zoom_api",
    "//ios/public/provider/chrome/browser/user_feedback:user_feedback_api",
    "//ios/public/provider/chrome/browser/voice_search:voice_search_api",
    "//ios/third_party/material_components_ios",
    "//ios/third_party/webkit",
    "//ios/web",
    "//ios/web/public",
    "//services/metrics/public/cpp:ukm_builders",
    "//third_party/abseil-cpp:absl",
    "//ui/base",
    "//ui/gfx",
    "//url",

    # Fake dependencies to break cycles
    "//ios/chrome/browser/ui/settings",
    "//ios/chrome/browser/ui/sharing:sharing_internal",
  ]
  frameworks = [
    "MessageUI.framework",
    "Photos.framework",
    "StoreKit.framework",
    "UIKit.framework",
  ]
}

source_set("unit_tests") {
  testonly = true
  sources = [
    "browser_coordinator_unittest.mm",
    "browser_view_controller_unittest.mm",
    "key_commands_provider_unittest.mm",
  ]
  deps = [
    ":browser_view",
    "//components/bookmarks/browser",
    "//components/bookmarks/test",
    "//components/content_settings/core/browser",
    "//components/omnibox/browser:test_support",
    "//components/open_from_clipboard:test_support",
    "//components/policy/core/common:common_constants",
    "//components/prefs:test_support",
    "//components/reading_list/core",
    "//components/search_engines",
    "//components/sessions",
    "//components/supervised_user/core/common:features",
    "//components/sync_preferences:test_support",
    "//ios/chrome/app/strings",
    "//ios/chrome/browser/bookmarks/model",
    "//ios/chrome/browser/content_settings/model",
    "//ios/chrome/browser/download",
    "//ios/chrome/browser/favicon",
    "//ios/chrome/browser/feature_engagement/model",
    "//ios/chrome/browser/find_in_page/model",
    "//ios/chrome/browser/find_in_page/model:util",
    "//ios/chrome/browser/history",
    "//ios/chrome/browser/lens",
    "//ios/chrome/browser/metrics:metrics_browser_agent",
    "//ios/chrome/browser/ntp",
    "//ios/chrome/browser/policy:policy_util",
    "//ios/chrome/browser/prerender/model",
    "//ios/chrome/browser/prerender/model:test_support",
    "//ios/chrome/browser/reading_list/model",
    "//ios/chrome/browser/search_engines/model",
    "//ios/chrome/browser/sessions",
    "//ios/chrome/browser/sessions:fake",
    "//ios/chrome/browser/sessions:restoration_agent",
    "//ios/chrome/browser/sessions:test_support",
    "//ios/chrome/browser/shared/coordinator/layout_guide",
    "//ios/chrome/browser/shared/coordinator/scene:scene_state_browser_agent",
    "//ios/chrome/browser/shared/coordinator/scene:scene_state_header",
    "//ios/chrome/browser/shared/model/browser/test:test_support",
    "//ios/chrome/browser/shared/model/browser_state:test_support",
    "//ios/chrome/browser/shared/model/url:constants",
    "//ios/chrome/browser/shared/model/web_state_list",
    "//ios/chrome/browser/shared/model/web_state_list/test:test_support",
    "//ios/chrome/browser/shared/public/commands",
    "//ios/chrome/browser/shared/public/features",
    "//ios/chrome/browser/shared/ui/util:url_with_title",
    "//ios/chrome/browser/signin:signin",
    "//ios/chrome/browser/signin:test_support",
    "//ios/chrome/browser/snapshots/model",
    "//ios/chrome/browser/sync/model:sync_error_browser_agent",
    "//ios/chrome/browser/tab_insertion/model",
    "//ios/chrome/browser/tabs/model",
    "//ios/chrome/browser/ui/bookmarks",
    "//ios/chrome/browser/ui/browser_container:ui",
    "//ios/chrome/browser/ui/bubble",
    "//ios/chrome/browser/ui/download",
    "//ios/chrome/browser/ui/fullscreen",
    "//ios/chrome/browser/ui/fullscreen:internal",
    "//ios/chrome/browser/ui/fullscreen/test",
    "//ios/chrome/browser/ui/incognito_reauth:incognito_reauth_commands",
    "//ios/chrome/browser/ui/incognito_reauth:incognito_reauth_scene_agent",
    "//ios/chrome/browser/ui/keyboard",
    "//ios/chrome/browser/ui/location_bar",
    "//ios/chrome/browser/ui/ntp:component_factory",
    "//ios/chrome/browser/ui/ntp:coordinator",
    "//ios/chrome/browser/ui/popup_menu",
    "//ios/chrome/browser/ui/save_to_photos",
    "//ios/chrome/browser/ui/sharing",
    "//ios/chrome/browser/ui/side_swipe",
    "//ios/chrome/browser/ui/tab_switcher/tab_strip",
    "//ios/chrome/browser/ui/tabs:coordinator",
    "//ios/chrome/browser/ui/tabs:tabs",
    "//ios/chrome/browser/ui/toolbar",
    "//ios/chrome/browser/ui/toolbar/test",
    "//ios/chrome/browser/url_loading/model",
    "//ios/chrome/browser/url_loading/model:new_tab_animation_tab_helper",
    "//ios/chrome/browser/view_source/model",
    "//ios/chrome/browser/web",
    "//ios/chrome/browser/web:delegate",
    "//ios/chrome/browser/web:page_placeholder",
    "//ios/chrome/browser/web_state_list/web_usage_enabler",
    "//ios/chrome/common/ui/reauthentication:reauthentication",
    "//ios/chrome/test:block_cleanup_test",
    "//ios/chrome/test:test_support",
    "//ios/net",
    "//ios/public/provider/chrome/browser/user_feedback:user_feedback_api",
    "//ios/web/common:features",
    "//ios/web/common:uikit",
    "//ios/web/find_in_page",
    "//ios/web/public",
    "//ios/web/public/test",
    "//ios/web/public/test/fakes",
    "//ios/web/web_state:web_state_impl_header",
    "//ios/web/web_state/ui",
    "//net",
    "//net:test_support",
    "//testing/gmock",
    "//testing/gtest",
    "//third_party/ocmock",
    "//ui/base",
    "//ui/base:test_support",
  ]
}

source_set("eg2_tests") {
  configs += [ "//build/config/ios:xctest_config" ]
  testonly = true
  sources = [ "browser_view_controller_egtest.mm" ]
  deps = [
    "//base",
    "//base/test:test_support",
    "//components/strings",
    "//ios/chrome/app/strings",
    "//ios/chrome/browser/ntp:features",
    "//ios/chrome/browser/ntp/home:features",
    "//ios/chrome/browser/shared/model/prefs:pref_names",
    "//ios/chrome/browser/shared/public/features",
    "//ios/chrome/browser/ui/content_suggestions:constants",
    "//ios/chrome/browser/ui/popup_menu:constants",
    "//ios/chrome/browser/ui/start_surface:feature_flags",
    "//ios/chrome/test:eg_test_support+eg2",
    "//ios/chrome/test/earl_grey:eg_test_support+eg2",
    "//ios/testing/earl_grey:eg_test_support+eg2",
    "//ios/web/public/test/http_server",
    "//ui/base",
    "//url",
  ]
  frameworks = [ "UIKit.framework" ]
}
