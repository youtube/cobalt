<html>
  <head>
    <title>Battery Status API test : event listener</title>
    <script type="text/javascript">

      function testBattery() {
        navigator.getBattery().then(
          function(battery) {
            battery.addEventListener('levelchange', onLevelChange);
            document.location = '#resolved';
        }, fail());
      }

      function onLevelChange() {
        if (this.level == 0.6)
          pass();
        else
          fail();
      }

      function pass() {
        document.getElementById('status').innerHTML = 'PASS';
        document.location = '#pass';
      }

      function fail() {
        document.location = '#fail';
      }
    </script>
  </head>
  <body onLoad="testBattery()">
    <div id="status">FAIL</div>
  </body>
</html>
