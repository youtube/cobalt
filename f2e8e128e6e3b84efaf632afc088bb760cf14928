{
  "comments": [
    {
      "key": {
        "uuid": "83effd8b_13f70b1a",
        "filename": "src/starboard/shared/posix/storage_write_record.cc",
        "patchSetId": 3
      },
      "lineNbr": 87,
      "author": {
        "id": 5081
      },
      "writtenOn": "2019-02-14T20:37:38Z",
      "side": 1,
      "message": "I think the problem here is that we want to ensure that the rename() has actually taken place before we exit this function, and so we want to \"flush\" original_file_path.  It could be that simply calling SbFileOpen() on original_file_path will be enough to ensure that the rename has occurred, but of course, please verify that this is the case.",
      "range": {
        "startLine": 87,
        "startChar": 2,
        "endLine": 87,
        "endChar": 13
      },
      "revId": "f2e8e128e6e3b84efaf632afc088bb760cf14928",
      "serverId": "52989804-5fae-3d7a-867c-a33f4af59155",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "57e94305_a3736512",
        "filename": "src/starboard/shared/posix/storage_write_record.cc",
        "patchSetId": 3
      },
      "lineNbr": 87,
      "author": {
        "id": 5490
      },
      "writtenOn": "2019-02-15T01:18:48Z",
      "side": 1,
      "message": "Firstly, I use the SbFileOpen and SbFileFlush on original_file_path, it works.\nAnd later, we find that the FD of temp_file could point to the original_file_path after rename, so I make this kind of change, and do test again, it works!",
      "parentUuid": "83effd8b_13f70b1a",
      "range": {
        "startLine": 87,
        "startChar": 2,
        "endLine": 87,
        "endChar": 13
      },
      "revId": "f2e8e128e6e3b84efaf632afc088bb760cf14928",
      "serverId": "52989804-5fae-3d7a-867c-a33f4af59155",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "cff507ae_4883f173",
        "filename": "src/starboard/shared/posix/storage_write_record.cc",
        "patchSetId": 3
      },
      "lineNbr": 87,
      "author": {
        "id": 5081
      },
      "writtenOn": "2019-02-18T19:21:34Z",
      "side": 1,
      "message": "Thanks, glad to hear that this is working!\n\nI left another comment as well: We need to still keep the other first SbFileFlush() call to make sure that all data is completely written to the temp file before a rename command is issued, but other than that this looks good to me.",
      "parentUuid": "57e94305_a3736512",
      "range": {
        "startLine": 87,
        "startChar": 2,
        "endLine": 87,
        "endChar": 13
      },
      "revId": "f2e8e128e6e3b84efaf632afc088bb760cf14928",
      "serverId": "52989804-5fae-3d7a-867c-a33f4af59155",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "795790d2_d059ccff",
        "filename": "src/starboard/shared/posix/storage_write_record.cc",
        "patchSetId": 3
      },
      "lineNbr": 87,
      "author": {
        "id": 5081
      },
      "writtenOn": "2019-02-22T01:41:04Z",
      "side": 1,
      "message": "Okay, I\u0027m about to apply this patch internally, but I\u0027m going to leave in the original SbFileFlush() call as it is still important to ensure that on some platforms the temp file is valid specifically *before* the rename() is performed.\n\nIf you have any major issues with this please let me know, otherwise I will accept the CL with that adjustment.",
      "parentUuid": "cff507ae_4883f173",
      "range": {
        "startLine": 87,
        "startChar": 2,
        "endLine": 87,
        "endChar": 13
      },
      "revId": "f2e8e128e6e3b84efaf632afc088bb760cf14928",
      "serverId": "52989804-5fae-3d7a-867c-a33f4af59155",
      "unresolved": true
    }
  ]
}