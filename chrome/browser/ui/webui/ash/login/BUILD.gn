# Copyright 2024 The Chromium Authors
# Use of this source code is governed by a BSD-style license that can be
# found in the LICENSE file.

import("//build/config/chromeos/ui_mode.gni")

assert(is_chromeos_ash)

# NOTE: This file is read by tools/oobe/generate_screen_template.py, which
# is used to generate some of the "sources" entries.

static_library("login") {
  sources = [
    "account_selection_screen_handler.cc",
    "account_selection_screen_handler.h",
    "add_child_screen_handler.cc",
    "add_child_screen_handler.h",
    "ai_intro_screen_handler.cc",
    "ai_intro_screen_handler.h",
    "app_downloading_screen_handler.cc",
    "app_downloading_screen_handler.h",
    "app_launch_splash_screen_handler.cc",
    "app_launch_splash_screen_handler.h",
    "arc_vm_data_migration_screen_handler.cc",
    "arc_vm_data_migration_screen_handler.h",
    "assistant_optin_flow_screen_handler.cc",
    "assistant_optin_flow_screen_handler.h",
    "auto_enrollment_check_screen_handler.cc",
    "auto_enrollment_check_screen_handler.h",
    "base_screen_handler.cc",
    "base_screen_handler.h",
    "base_webui_handler.cc",
    "base_webui_handler.h",
    "categories_selection_screen_handler.cc",
    "categories_selection_screen_handler.h",
    "check_passwords_against_cryptohome_helper.cc",
    "check_passwords_against_cryptohome_helper.h",
    "choobe_screen_handler.cc",
    "choobe_screen_handler.h",
    "consolidated_consent_screen_handler.cc",
    "consolidated_consent_screen_handler.h",
    "consumer_update_screen_handler.cc",
    "consumer_update_screen_handler.h",
    "cookie_waiter.cc",
    "cookie_waiter.h",
    "core_oobe_handler.cc",
    "core_oobe_handler.h",
    "cryptohome_recovery_screen_handler.cc",
    "cryptohome_recovery_screen_handler.h",
    "cryptohome_recovery_setup_screen_handler.cc",
    "cryptohome_recovery_setup_screen_handler.h",
    "demo_preferences_screen_handler.cc",
    "demo_preferences_screen_handler.h",
    "demo_setup_screen_handler.cc",
    "demo_setup_screen_handler.h",
    "device_disabled_screen_handler.cc",
    "device_disabled_screen_handler.h",
    "display_size_screen_handler.cc",
    "display_size_screen_handler.h",
    "drive_pinning_screen_handler.cc",
    "drive_pinning_screen_handler.h",
    "enable_adb_sideloading_screen_handler.cc",
    "enable_adb_sideloading_screen_handler.h",
    "enable_debugging_screen_handler.cc",
    "enable_debugging_screen_handler.h",
    "encryption_migration_screen_handler.cc",
    "encryption_migration_screen_handler.h",
    "enrollment_screen_handler.cc",
    "enrollment_screen_handler.h",
    "enter_old_password_screen_handler.cc",
    "enter_old_password_screen_handler.h",
    "error_screen_handler.cc",
    "error_screen_handler.h",
    "family_link_notice_screen_handler.cc",
    "family_link_notice_screen_handler.h",
    "fingerprint_setup_screen_handler.cc",
    "fingerprint_setup_screen_handler.h",
    "gaia_info_screen_handler.cc",
    "gaia_info_screen_handler.h",
    "gaia_screen_handler.cc",
    "gaia_screen_handler.h",
    "gemini_intro_screen_handler.cc",
    "gemini_intro_screen_handler.h",
    "gesture_navigation_screen_handler.cc",
    "gesture_navigation_screen_handler.h",
    "guest_tos_screen_handler.cc",
    "guest_tos_screen_handler.h",
    "hardware_data_collection_screen_handler.cc",
    "hardware_data_collection_screen_handler.h",
    "hid_detection_screen_handler.cc",
    "hid_detection_screen_handler.h",
    "install_attributes_error_screen_handler.cc",
    "install_attributes_error_screen_handler.h",
    "l10n_util.cc",
    "l10n_util.h",
    "local_password_setup_handler.cc",
    "local_password_setup_handler.h",
    "local_state_error_screen_handler.cc",
    "local_state_error_screen_handler.h",
    "locale_switch_screen_handler.cc",
    "locale_switch_screen_handler.h",
    "management_transition_screen_handler.cc",
    "management_transition_screen_handler.h",
    "marketing_opt_in_screen_handler.cc",
    "marketing_opt_in_screen_handler.h",
    "multidevice_setup_screen_handler.cc",
    "multidevice_setup_screen_handler.h",
    "network_dropdown_handler.cc",
    "network_dropdown_handler.h",
    "network_screen_handler.cc",
    "network_screen_handler.h",
    "network_state_informer.cc",
    "network_state_informer.h",
    "offline_login_screen_handler.cc",
    "offline_login_screen_handler.h",
    "online_authentication_screen_handler.cc",
    "online_authentication_screen_handler.h",
    "online_login_utils.cc",
    "online_login_utils.h",
    "oobe_display_chooser.cc",
    "oobe_display_chooser.h",
    "oobe_screens_handler_factory.cc",
    "oobe_screens_handler_factory.h",
    "oobe_ui.cc",
    "oobe_ui.h",
    "os_install_screen_handler.cc",
    "os_install_screen_handler.h",
    "os_trial_screen_handler.cc",
    "os_trial_screen_handler.h",
    "packaged_license_screen_handler.cc",
    "packaged_license_screen_handler.h",
    "parental_handoff_screen_handler.cc",
    "parental_handoff_screen_handler.h",
    "password_selection_screen_handler.cc",
    "password_selection_screen_handler.h",
    "perks_discovery_screen_handler.cc",
    "perks_discovery_screen_handler.h",
    "personalized_recommend_apps_screen_handler.cc",
    "personalized_recommend_apps_screen_handler.h",
    "pin_setup_screen_handler.cc",
    "pin_setup_screen_handler.h",
    "placeholder_screen_handler.cc",
    "placeholder_screen_handler.h",
    "quick_start_screen_handler.cc",
    "quick_start_screen_handler.h",
    "recommend_apps_screen_handler.cc",
    "recommend_apps_screen_handler.h",
    "recovery_eligibility_screen_handler.h",
    "remote_activity_notification_screen_handler.cc",
    "remote_activity_notification_screen_handler.h",
    "reset_screen_handler.cc",
    "reset_screen_handler.h",
    "saml_challenge_key_handler.cc",
    "saml_challenge_key_handler.h",
    "saml_confirm_password_handler.cc",
    "saml_confirm_password_handler.h",
    "signin_fatal_error_screen_handler.cc",
    "signin_fatal_error_screen_handler.h",
    "smart_privacy_protection_screen_handler.cc",
    "smart_privacy_protection_screen_handler.h",
    "split_modifier_keyboard_info_screen_handler.cc",
    "split_modifier_keyboard_info_screen_handler.h",
    "ssh_configured_handler.cc",
    "ssh_configured_handler.h",
    "sync_consent_screen_handler.cc",
    "sync_consent_screen_handler.h",
    "terms_of_service_screen_handler.cc",
    "terms_of_service_screen_handler.h",
    "theme_selection_screen_handler.cc",
    "theme_selection_screen_handler.h",
    "touchpad_scroll_screen_handler.cc",
    "touchpad_scroll_screen_handler.h",
    "tpm_error_screen_handler.cc",
    "tpm_error_screen_handler.h",
    "update_required_screen_handler.cc",
    "update_required_screen_handler.h",
    "update_screen_handler.cc",
    "update_screen_handler.h",
    "user_allowlist_check_screen_handler.cc",
    "user_allowlist_check_screen_handler.h",
    "user_creation_screen_handler.cc",
    "user_creation_screen_handler.h",
    "welcome_screen_handler.cc",
    "welcome_screen_handler.h",
    "wrong_hwid_screen_handler.cc",
    "wrong_hwid_screen_handler.h",
  ]

  public_deps = [
    "//ash/components/arc/session:arc_base_enums",
    "//ash/public/cpp",
    "//ash/webui/common:chrome_os_webui_config",
    "//base",
    "//chrome/browser:browser_public_dependencies",
    "//chrome/browser/ash/accessibility",
    "//chrome/browser/ash/attestation",
    "//chrome/browser/ash/base",
    "//chrome/browser/ash/login/demo_mode",
    "//chrome/browser/ash/policy/enrollment",
    "//chrome/browser/ash/tpm",
    "//chrome/browser/ui/webui/ash/login/mojom",
    "//chrome/common",
    "//chromeos/ash/components/dbus/os_install",
    "//chromeos/ash/components/http_auth_dialog",
    "//chromeos/ash/components/login/auth",
    "//chromeos/ash/components/login/auth/public:authpublic",
    "//chromeos/ash/components/login/auth/public:challenge_response_key",
    "//chromeos/ash/components/network",
    "//chromeos/ash/services/assistant/public/cpp",
    "//chromeos/ash/services/auth_factor_config/public/mojom",
    "//chromeos/ash/services/cellular_setup/public/mojom",
    "//chromeos/ash/services/multidevice_setup/public/mojom",
    "//chromeos/components/security_token_pin",
    "//chromeos/crosapi/mojom",
    "//chromeos/services/network_config/public/mojom",
    "//components/account_id",
    "//components/login",
    "//components/sync/protocol",
    "//components/user_manager",
    "//components/user_manager:common",
    "//content/public/browser",
    "//content/public/common",
    "//google_apis",
    "//mojo/public/cpp/bindings",
    "//net",
    "//services/device/public/mojom",
    "//services/network/public/mojom:cookies_mojom",
    "//ui/base/ime/ash",
    "//ui/events",
    "//ui/events/devices",
    "//ui/gfx",
    "//ui/webui",
    "//ui/webui/resources/cr_components/color_change_listener:mojom",
    "//url",
  ]

  deps = [
    "//ash",
    "//ash/components/arc",
    "//ash/constants",
    "//ash/public/cpp/resources:ash_public_unscaled_resources",
    "//ash/webui/common:trusted_types_util",
    "//base:i18n",
    "//base/version_info",
    "//build:branding_buildflags",
    "//chrome/app:branded_strings",
    "//chrome/app:generated_resources",
    "//chrome/app/theme:chrome_unscaled_resources",
    "//chrome/browser:browser_process",
    "//chrome/browser:resources",
    "//chrome/browser/ash/app_mode",
    "//chrome/browser/ash/arc/optin",
    "//chrome/browser/ash/crosapi:browser_util",
    "//chrome/browser/ash/customization",
    "//chrome/browser/ash/drive",
    "//chrome/browser/ash/login",
    "//chrome/browser/ash/login/app_mode",
    "//chrome/browser/ash/login/enrollment",
    "//chrome/browser/ash/login/quick_unlock",
    "//chrome/browser/ash/login/saml",
    "//chrome/browser/ash/login/screens",
    "//chrome/browser/ash/login/screens/osauth",
    "//chrome/browser/ash/login/session",
    "//chrome/browser/ash/login/signin",
    "//chrome/browser/ash/login/users",
    "//chrome/browser/ash/multidevice_setup",
    "//chrome/browser/ash/policy/core",
    "//chrome/browser/ash/policy/handlers",
    "//chrome/browser/ash/profiles",
    "//chrome/browser/ash/profiles:signin_profile_handler",
    "//chrome/browser/ash/system",
    "//chrome/browser/extensions",
    "//chrome/browser/policy:onc",
    "//chrome/browser/profiles:profile",
    "//chrome/browser/resources:component_extension_resources",
    "//chrome/browser/resources/chromeos/assistant_optin:resources",
    "//chrome/browser/resources/chromeos/login:resources",
    "//chrome/browser/resources/gaia_auth_host:resources",
    "//chrome/browser/ui/ash/login",
    "//chrome/browser/ui/webui/ash/cellular_setup",
    "//chrome/browser/ui/webui/ash/internet",
    "//chrome/browser/ui/webui/ash/login/debug",
    "//chrome/browser/ui/webui/ash/login/osauth",
    "//chrome/browser/ui/webui/ash/login/testapi",
    "//chrome/browser/ui/webui/signin",
    "//chrome/browser/ui/webui/signin:signin_utils",
    "//chrome/common:channel_info",
    "//chrome/common:chrome_features",
    "//chrome/common:constants",
    "//chrome/common:non_code_constants",
    "//chromeos/ash/components/assistant:buildflags",
    "//chromeos/ash/components/browser_context_helper",
    "//chromeos/ash/components/dbus",
    "//chromeos/ash/components/dbus/debug_daemon",
    "//chromeos/ash/components/dbus/session_manager",
    "//chromeos/ash/components/install_attributes",
    "//chromeos/ash/components/login/login_state",
    "//chromeos/ash/components/network",
    "//chromeos/ash/components/settings",
    "//chromeos/ash/services/assistant/public/proto",
    "//chromeos/ash/services/auth_factor_config",
    "//chromeos/ash/services/multidevice_setup",
    "//chromeos/components/onc",
    "//chromeos/constants",
    "//chromeos/dbus/constants",
    "//chromeos/dbus/power",
    "//chromeos/strings",
    "//chromeos/version",
    "//components/content_settings/core/common",
    "//components/enterprise/device_trust",
    "//components/onc",
    "//components/policy/core/browser",
    "//components/policy/core/common:common_constants",
    "//components/policy/proto",
    "//components/prefs",
    "//components/proxy_config",
    "//components/session_manager/core",
    "//components/strings:components_strings",
    "//components/sync/base:features",
    "//components/version_info",
    "//content/public/common",
    "//remoting/host/chromeos:features",
    "//services/network/public/mojom",
    "//services/network/public/mojom:url_loader_base",
    "//third_party/abseil-cpp:absl",
    "//third_party/re2",
    "//ui/accessibility:ax_base",
    "//ui/aura",
    "//ui/base",
    "//ui/base:features",
    "//ui/chromeos",
    "//ui/chromeos/resources",
    "//ui/chromeos/strings:strings_provider",
    "//ui/display",
    "//ui/display/manager",
    "//ui/resources:webui_resources_grd",
    "//ui/strings:ui_strings",
  ]

  allow_circular_includes_from = [
    "//chrome/browser/ash/arc/optin",
    "//chrome/browser/ash/customization",
    "//chrome/browser/ash/login",
    "//chrome/browser/ash/login/app_mode",
    "//chrome/browser/ash/login/enrollment",
    "//chrome/browser/ash/login/screens",
    "//chrome/browser/ash/login/screens/osauth",
    "//chrome/browser/ash/login/session",
    "//chrome/browser/ash/policy/handlers",
    "//chrome/browser/ash/system",
    "//chrome/browser/ui/ash/login",
    "//chrome/browser/ui/webui/ash/login/debug",
    "//chrome/browser/ui/webui/ash/login/osauth",
    "//chrome/browser/ui/webui/ash/login/testapi",
  ]
}

static_library("test_support") {
  testonly = true

  sources = [
    "fake_update_required_screen_handler.cc",
    "fake_update_required_screen_handler.h",
  ]

  public_deps = [
    ":login",
    "//chrome/browser/ash/app_mode",
    "//ui/gfx",
    "//url",
  ]
}

source_set("browser_tests") {
  testonly = true

  defines = [ "HAS_OUT_OF_PROC_TEST_RUNNER" ]

  sources = [ "oobe_display_chooser_browsertest.cc" ]

  deps = [
    ":login",
    "//ash",
    "//ash/constants",
    "//base",
    "//chrome/browser",
    "//chrome/browser/ash/login/test:test_support",
    "//content/test:test_support",
    "//ui/display",
    "//ui/display:display_manager_test_api",
    "//ui/display/manager",
  ]
}

source_set("unit_tests") {
  testonly = true

  sources = [
    "l10n_util_test_util.cc",
    "l10n_util_test_util.h",
    "l10n_util_unittest.cc",
    "oobe_display_chooser_unittest.cc",
    "signin_userlist_unittest.cc",
  ]

  deps = [
    ":login",
    "//ash",
    "//base",
    "//base/test:test_support",
    "//chrome/browser/ash/customization",
    "//chrome/browser/ash/input_method",
    "//chrome/browser/ash/login/screens",
    "//chrome/browser/ash/login/users:test_support",
    "//chrome/browser/ash/settings:test_support",
    "//chrome/test:test_support",
    "//chrome/test:test_support_unit",
    "//chromeos/ash/components/proximity_auth",
    "//chromeos/ash/components/system",
    "//chromeos/crosapi/mojom",
    "//components/account_id",
    "//components/user_manager",
    "//content/test:test_support",
    "//mojo/public/cpp/bindings",
    "//testing/gtest",
    "//ui/base:test_support",
    "//ui/base/ime/ash",
    "//ui/display",
    "//ui/display:display_manager_test_api",
    "//ui/display:test_support",
    "//ui/display/manager",
    "//ui/events/devices",
    "//ui/events/devices:test_support",
    "//url",
  ]
}
