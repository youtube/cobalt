/*
 * Copyright (c) 2024, Alliance for Open Media. All rights reserved
 *
 * This source code is subject to the terms of the BSD 3-Clause Clear License
 * and the Alliance for Open Media Patent License 1.0. If the BSD 3-Clause Clear
 * License was not distributed with this source code in the LICENSE file, you
 * can obtain it at www.aomedia.org/license/software-license/bsd-3-c-c. If the
 * Alliance for Open Media Patent License 1.0 was not distributed with this
 * source code in the PATENTS file, you can obtain it at
 * www.aomedia.org/license/patent.
 */

/*
AOM-IAMF Standard Deliverable Status:
This software module is out of scope and not part of the IAMF Final Deliverable.
*/

/**
 * @file h2m_rdr.c
 * @brief HOA to Multichannels rendering.
 * @version 0.1
 * @date Created 03/03/2023
 **/

#define _USE_MATH_DEFINES
#include <math.h>
#include <string.h>

#include "ae_rdr.h"

////////////////////////
float zoa_mono[] = {1.0};
float zoa_bs020[] = {0.70710082, 0.70711274};
float zoa_bs050[] = {0.32633555, 0.32633836, 0.21513153, 0.60857786,
                     0.60857192};
float zoa_bs250[] = {0.21545139, 0.21546223, 0.1449662, 0.64532708,
                     0.64531899, 0.16319277, 0.16317478};
float zoa_bs450[] = {0.2589133,  0.25892531, 0.17179246, 0.55582871, 0.5558131,
                     0.19678245, 0.19676024, 0.26560468, 0.26561516};
float zoa_bs451[] = {0.13751009, 0.13752067, 0.05714168, 0.58394492,
                     0.58393012, 0.19593844, 0.19591633, 0.26446548,
                     0.26447592, 0.24552643};
float zoa_bs370[] = {0.22198958, 0.24224982, 0.24226476, 0.25750442,
                     0.25749822, 0.36089975, 0.36088758, 0.36896943,
                     0.36895516, 0.40984723};
float zoa_bs490[] = {0.21973458, 0.2197658,  0.16838701, 0.31931017, 0.31931294,
                     0.37590788, 0.37588103, 0.29771433, 0.29769313, 0.2981131,
                     0.29811957, 0.12954642, 0.12949327};
float zoa_bs9A3[] = {0.09620442, 0.09621115, 0.05768647, 0.34302436, 0.34302036,
                     0.09762671, 0.09763078, 0.34302018, 0.31330675, 0.31331476,
                     0.12986508, 0.12983092, 0.14535586, 0.31907627, 0.1416214,
                     0.14159595, 0.14347565, 0.1434782,  0.14160483, 0.23516451,
                     0.21965652, 0.21963451};
float zoa_bs070[] = {0.33864987, 0.33865386, 0.26375664, 0.37546788,
                     0.37545877, 0.45778527, 0.45776575};
float zoa_bs470[] = {0.25073729, 0.25075275, 0.22976721, 0.31884739,
                     0.31885011, 0.37397364, 0.37394729, 0.29063804,
                     0.29062113, 0.29112214, 0.29112846};
float zoa_iamf312[] = {0.67176654, 0.67177166, 0.1449662, 0.16319277,
                       0.16317478};
float zoa_iamf712[] = {0.25073729, 0.25075275, 0.22976721,
                       0.31884739, 0.31885011, 0.37397364,
                       0.37394729, 0.49649248, 0.49648004};

////////////////////////
float foa_mono[] = {6.23757933e-01, 3.94900000e-06, -1.95729978e-07,
                    7.40278437e-02};
float foa_bs020[][4] = {
    {6.23752675e-01, 5.72103593e-01, -8.58322813e-07, 7.40141262e-02},
    {6.23763190e-01, -5.72095695e-01, 4.66862857e-07, 7.40415612e-02}};
float foa_bs050[][4] = {
    {2.50621545e-01, 3.10682739e-01, 1.70905779e-05, 3.07552345e-01},
    {2.50623704e-01, -3.10685559e-01, 9.90912200e-06, 3.07564230e-01},
    {1.65218271e-01, 9.15556582e-06, -4.07281262e-05, 2.65463910e-01},
    {4.67380043e-01, 4.51128331e-01, -4.40137250e-06, -4.30612876e-01},
    {4.67375481e-01, -4.51105215e-01, 1.07376039e-05, -4.30629805e-01}};
float foa_bs250[][4] = {
    {1.60841247e-01, 2.28393130e-01, -1.95227191e-01, 2.12772300e-01},
    {1.60849339e-01, -2.28399241e-01, -1.95237534e-01, 2.12798095e-01},
    {1.08221836e-01, 1.23793408e-05, -1.40756775e-01, 2.03191820e-01},
    {4.81756995e-01, 4.66864572e-01, 9.06085189e-03, -4.34708249e-01},
    {4.81750954e-01, -4.66841556e-01, 9.07452759e-03, -4.34726837e-01},
    {1.21828541e-01, 1.04337290e-01, 2.37360549e-01, 1.53929699e-01},
    {1.21815110e-01, -1.04327601e-01, 2.37361986e-01, 1.53897349e-01}};
float foa_bs450[][4] = {
    {1.71634590e-01, 2.46697762e-01, -2.03594387e-01, 2.25695454e-01},
    {1.71642551e-01, -2.46702494e-01, -2.03605381e-01, 2.25722757e-01},
    {1.13881860e-01, 1.30267828e-05, -1.48118382e-01, 2.13818793e-01},
    {3.68460920e-01, 3.69873008e-01, -2.91802681e-01, -4.12793734e-01},
    {3.68450573e-01, -3.69846113e-01, -2.91790370e-01, -4.12805228e-01},
    {1.30447818e-01, 1.15594825e-01, 2.52176034e-01, 1.63616077e-01},
    {1.30433098e-01, -1.15583322e-01, 2.52176590e-01, 1.63581427e-01},
    {1.76070328e-01, 1.59994173e-01, 3.48214366e-01, -1.04081210e-01},
    {1.76077278e-01, -1.59999989e-01, 3.48218167e-01, -1.04092952e-01}};
float foa_bs451[][4] = {
    {9.18824460e-02, 1.87559061e-01, -2.01393100e-02, 1.54186748e-01},
    {9.18895163e-02, -1.87560807e-01, -2.01535712e-02, 1.54209327e-01},
    {3.81813250e-02, 1.84868598e-05, 1.07084520e-02, 1.09048612e-01},
    {3.90184366e-01, 4.02043845e-01, -3.32105078e-01, -3.87580982e-01},
    {3.90174479e-01, -4.02030153e-01, -3.32101313e-01, -3.87595245e-01},
    {1.30923506e-01, 1.16016350e-01, 2.53095613e-01, 1.64212715e-01},
    {1.30908732e-01, -1.16004805e-01, 2.53096171e-01, 1.64177939e-01},
    {1.76712381e-01, 1.60577603e-01, 3.49484156e-01, -1.04460750e-01},
    {1.76719357e-01, -1.60583441e-01, 3.49487970e-01, -1.04472535e-01},
    {1.64057551e-01, -7.22175250e-06, -3.26163812e-01, 2.29200020e-01}};
float foa_bs370[][4] = {
    {1.38206404e-01, 6.02514266e-06, -1.61553853e-01, 2.42264116e-01},
    {1.50820038e-01, 1.70413376e-01, -2.18356458e-01, 2.00435931e-01},
    {1.50829336e-01, -1.70423609e-01, -2.18387141e-01, 2.00436456e-01},
    {1.60317253e-01, 1.78965986e-01, 3.05315565e-01, 1.77826945e-01},
    {1.60313394e-01, -1.78937421e-01, 3.05327912e-01, 1.77814872e-01},
    {2.24689177e-01, 4.23617639e-01, -1.59945095e-01, 1.35759805e-03},
    {2.24681599e-01, -4.23610308e-01, -1.59941940e-01, 1.35153285e-03},
    {2.29713205e-01, 1.92419796e-01, -2.52721572e-01, -3.76625410e-01},
    {2.29704317e-01, -1.92402037e-01, -2.52708548e-01, -3.76622035e-01},
    {2.55162929e-01, -1.10118797e-05, 5.02514284e-01, -2.38329457e-01}};
float foa_bs490[][4] = {
    {1.33943127e-01, 1.64268063e-01, -1.97953052e-01, 1.63059290e-01},
    {1.33962159e-01, -1.64296200e-01, -1.97955736e-01, 1.63088985e-01},
    {1.02643305e-01, -9.16057523e-06, -1.21547375e-01, 1.61757921e-01},
    {1.94641205e-01, 3.70767542e-01, -2.10262923e-01, 3.36276209e-02},
    {1.94642893e-01, -3.70776129e-01, -2.10246722e-01, 3.36009643e-02},
    {2.29141347e-01, 1.88657816e-01, -2.58353086e-01, -3.81133768e-01},
    {2.29124977e-01, -1.88631958e-01, -2.58347605e-01, -3.81117999e-01},
    {1.81477072e-01, 1.77425829e-01, 3.49753376e-01, 1.77863734e-01},
    {1.81464148e-01, -1.77390622e-01, 3.49750871e-01, 1.77856484e-01},
    {1.81720149e-01, 1.69730250e-01, 3.50540863e-01, -1.78142797e-01},
    {1.81724096e-01, -1.69748319e-01, 3.50539021e-01, -1.78140331e-01},
    {7.89673255e-02, 2.67506926e-02, -1.43793773e-01, 9.36059741e-02},
    {7.89349279e-02, -2.67030099e-02, -1.43805542e-01, 9.35248174e-02}};
float foa_bs9A3[][4] = {
    {5.63451317e-02, 1.42440516e-01, 4.40516772e-04, 7.46074411e-02},
    {5.63490746e-02, -1.42444765e-01, 4.24451509e-04, 7.46228100e-02},
    {3.37858882e-02, 1.77930252e-05, -3.09890673e-05, 9.84182909e-02},
    {2.00902962e-01, 2.53871239e-01, -2.57111844e-01, -2.53873843e-01},
    {2.00900619e-01, -2.53879197e-01, -2.57092344e-01, -2.53879779e-01},
    {5.71781378e-02, 7.50655473e-02, 3.79085654e-06, 1.44848300e-01},
    {5.71805256e-02, -7.50694338e-02, 2.03476094e-05, 1.44848406e-01},
    {2.00900512e-01, -1.33248436e-05, -2.57083737e-01, -3.59039117e-01},
    {1.83497910e-01, 3.13145196e-01, -2.62363309e-01, -1.99858778e-02},
    {1.83502601e-01, -3.13170023e-01, -2.62350011e-01, -1.99838758e-02},
    {7.60595490e-02, 1.19539396e-01, 1.29523034e-01, 1.19552805e-01},
    {7.60395467e-02, -1.19530648e-01, 1.29487714e-01, 1.19516214e-01},
    {8.51322141e-02, 1.65124185e-05, 1.36630679e-01, 1.92892600e-01},
    {1.86877012e-01, 2.14090778e-05, 4.73682975e-01, -8.70734224e-06},
    {8.29450088e-02, 1.31434397e-01, 1.35361270e-01, -1.31450927e-01},
    {8.29301023e-02, -1.31422769e-01, 1.35323682e-01, -1.31443099e-01},
    {8.40310053e-02, 1.89380427e-01, 1.35987164e-01, -9.79190943e-05},
    {8.40325007e-02, -1.89381150e-01, 1.35986600e-01, -1.04033651e-04},
    {8.29353021e-02, 1.07353149e-05, 1.35337260e-01, -1.85878577e-01},
    {1.37731458e-01, -7.40789286e-06, -2.71046068e-01, 1.84505059e-01},
    {1.28648721e-01, 1.13602275e-01, -2.63895426e-01, 1.13628989e-01},
    {1.28635830e-01, -1.13578477e-01, -2.63913376e-01, 1.13580628e-01}};
float foa_bs070[][4] = {
    {2.50471347e-01, 2.51706779e-01, 3.45308827e-05, 3.00186164e-01},
    {2.50474302e-01, -2.51703690e-01, -9.18024511e-06, 3.00195844e-01},
    {1.95079009e-01, 1.30516353e-05, -4.30110917e-05, 2.70282016e-01},
    {2.77702594e-01, 4.40004517e-01, -1.83458952e-05, 4.98124680e-02},
    {2.77695853e-01, -4.39999590e-01, -2.99177728e-07, 4.97926860e-02},
    {3.38585971e-01, 2.59490910e-01, -8.06273719e-06, -4.75435688e-01},
    {3.38571534e-01, -2.59480618e-01, -1.69746261e-05, -4.75432873e-01}};
float foa_bs470[][4] = {
    {1.53249945e-01, 1.73158957e-01, -2.21874465e-01, 2.03665215e-01},
    {1.53259393e-01, -1.73169355e-01, -2.21905642e-01, 2.03665748e-01},
    {1.40433089e-01, 6.12221555e-06, -1.64156696e-01, 2.46167306e-01},
    {1.94878652e-01, 3.62255148e-01, -2.17027277e-01, 3.29936121e-02},
    {1.94880315e-01, -3.62266326e-01, -2.17011448e-01, 3.29676087e-02},
    {2.28571663e-01, 1.84273980e-01, -2.63877085e-01, -3.72343589e-01},
    {2.28555561e-01, -1.84251275e-01, -2.63871543e-01, -3.72328014e-01},
    {1.77637174e-01, 1.73664822e-01, 3.42431107e-01, 1.74005365e-01},
    {1.77626842e-01, -1.73630948e-01, 3.42431292e-01, 1.74004819e-01},
    {1.77933057e-01, 1.66193030e-01, 3.43235507e-01, -1.74430257e-01},
    {1.77936922e-01, -1.66210723e-01, 3.43233703e-01, -1.74427844e-01}};

float foa_iamf312[][4] = {
    {5.014949e-01, 5.585162e-01, -1.888202e-01, -9.461285e-02},         // L
    {5.014987e-01, -5.585061e-01, -1.888209e-01, -9.460020e-02},        // R
    {1.08221836e-01, 1.23793408e-05, -1.40756775e-01, 2.03191820e-01},  // C
    {1.21828541e-01, 1.04337290e-01, 2.37360549e-01, 1.53929699e-01},   // Hfl
    {1.21815110e-01, -1.04327601e-01, 2.37361986e-01, 1.53897349e-01}   // Hfr
};

float foa_iamf712[][4] = {
    {1.53249945e-01, 1.73158957e-01, -2.21874465e-01, 2.03665215e-01},    // L
    {1.53259393e-01, -1.73169355e-01, -2.21905642e-01, 2.03665748e-01},   // R
    {1.40433089e-01, 6.12221555e-06, -1.64156696e-01, 2.46167306e-01},    // C
    {1.94878652e-01, 3.62255148e-01, -2.17027277e-01, 3.29936121e-02},    // Ls
    {1.94880315e-01, -3.62266326e-01, -2.17011448e-01, 3.29676087e-02},   // Rs
    {2.28571663e-01, 1.84273980e-01, -2.63877085e-01, -3.72343589e-01},   // Lb
    {2.28555561e-01, -1.84251275e-01, -2.63871543e-01, -3.72328014e-01},  // Rb
    {3.034548e-01, 2.911810e-01, 5.851353e-01, 5.066455e-02},             // Hfl
    {3.034472e-01, -2.911597e-01, 5.851342e-01, 5.066571e-02}             // Hfr
};

///////////////////////////////////////////
float soa_mono[] = {6.11863808e-01, 3.87350000e-06, -1.91997702e-07,
                    7.26162442e-02, 4.09550000e-06, 8.21892714e-06,
                    9.24007326e-02, 7.94167407e-07, 1.58538424e-01};
float soa_bs020[][9] = {{6.11858651e-01, 5.61194439e-01, -8.41955890e-07,
                         7.26027883e-02, 2.46501808e-01, 2.35064399e-06,
                         9.24039966e-02, -1.44147615e-07, 1.58528890e-01},
                        {6.11868965e-01, -5.61186692e-01, 4.57960486e-07,
                         7.26297001e-02, -2.46493617e-01, 1.40872103e-05,
                         9.23974685e-02, 1.73248243e-06, 1.58547959e-01}};
float soa_bs050[][9] = {{2.38781287e-01, 2.96004975e-01, 1.62831579e-05,
                         2.93022473e-01, 3.78036740e-01, 4.66758981e-06,
                         1.24383931e-01, 2.62364822e-05, -3.83109183e-02},
                        {2.38783344e-01, -2.96007662e-01, 9.44097964e-06,
                         2.93033796e-01, -3.78036479e-01, 1.39362683e-05,
                         1.24405269e-01, 2.06627981e-05, -3.82963163e-02},
                        {1.57412769e-01, 8.72302414e-06, -3.88039838e-05,
                         2.52922445e-01, 3.62084239e-05, -1.34767477e-05,
                         1.62861520e-01, -4.44126486e-06, 2.59551352e-01},
                        {4.45299338e-01, 4.29815415e-01, -4.19343592e-06,
                         -4.10269184e-01, -1.01075317e-01, 2.54769115e-06,
                         8.73885939e-02, -1.57986343e-06, -7.73670023e-02},
                        {4.45294991e-01, -4.29793391e-01, 1.02303211e-05,
                         -4.10285313e-01, 1.01084942e-01, 1.61423360e-06,
                         8.73727819e-02, 9.75122230e-06, -7.73865158e-02}};
float soa_bs250[][9] = {{1.51598055e-01, 2.15267879e-01, -1.84007913e-01,
                         2.00544744e-01, 2.83085414e-01, -1.30926554e-01,
                         -2.62945588e-03, -1.54142851e-01, -3.80115564e-02},
                        {1.51605682e-01, -2.15273639e-01, -1.84017662e-01,
                         2.00569056e-01, -2.83094927e-01, 1.30947725e-01,
                         -2.63063046e-03, -1.54153181e-01, -3.79790034e-02},
                        {1.02002565e-01, 1.16679273e-05, -1.32667792e-01,
                         1.91514833e-01, 3.22324409e-05, -9.39024240e-06,
                         3.59275434e-02, -1.19192733e-01, 2.13323852e-01},
                        {4.54071480e-01, 4.40034892e-01, 8.54014466e-03,
                         -4.09726522e-01, -9.36552906e-02, 4.92427716e-03,
                         9.13601796e-02, 4.00474901e-03, -8.49272007e-02},
                        {4.54065786e-01, -4.40013199e-01, 8.55303445e-03,
                         -4.09744042e-01, 9.36608249e-02, -4.92139383e-03,
                         9.13448355e-02, 4.01492543e-03, -8.49451616e-02},
                        {1.14827322e-01, 9.83412551e-02, 2.23719961e-01,
                         1.45083697e-01, 1.25128203e-01, 1.42099909e-01,
                         1.27585524e-01, 2.19516595e-01, 3.73507004e-02},
                        {1.14814664e-01, -9.83321235e-02, 2.23721315e-01,
                         1.45053206e-01, -1.25102102e-01, -1.42105523e-01,
                         1.27622359e-01, 2.19520471e-01, 3.73161724e-02}};
float soa_bs450[][9] = {{1.55892875e-01, 2.24071520e-01, -1.84921433e-01,
                         2.04995469e-01, 2.90946585e-01, -1.28529803e-01,
                         -6.78350592e-03, -1.55087606e-01, -4.49061680e-02},
                        {1.55900106e-01, -2.24075818e-01, -1.84931419e-01,
                         2.05020268e-01, -2.90956456e-01, 1.28551530e-01,
                         -6.78357850e-03, -1.55097838e-01, -4.48707303e-02},
                        {1.03437020e-01, 1.18320125e-05, -1.34533490e-01,
                         1.94208093e-01, 3.26857235e-05, -9.52229673e-06,
                         3.64327900e-02, -1.20868932e-01, 2.16323811e-01},
                        {3.34666993e-01, 3.35949569e-01, -2.65039576e-01,
                         -3.74933759e-01, -9.06404678e-02, -1.76442356e-01,
                         -1.26359175e-01, 8.75017912e-02, -1.63972897e-02},
                        {3.34657595e-01, -3.35925141e-01, -2.65028394e-01,
                         -3.74944199e-01, 9.06382246e-02, 1.76442733e-01,
                         -1.26363062e-01, 8.75158689e-02, -1.63961409e-02},
                        {1.18483608e-01, 1.04992878e-01, 2.29047344e-01,
                         1.48609792e-01, 1.30302903e-01, 1.49443981e-01,
                         1.26405167e-01, 2.24127334e-01, 3.22718365e-02},
                        {1.18470237e-01, -1.04982430e-01, 2.29047849e-01,
                         1.48578320e-01, -1.30275316e-01, -1.49447876e-01,
                         1.26442637e-01, 2.24130021e-01, 3.22377681e-02},
                        {1.59921783e-01, 1.45320075e-01, 3.16277382e-01,
                         -9.45352513e-02, -2.43103773e-02, 2.13806844e-01,
                         1.86508368e-01, -1.52870866e-01, -6.80378961e-02},
                        {1.59928096e-01, -1.45325358e-01, 3.16280834e-01,
                         -9.45459165e-02, 2.43207403e-02, -2.13805205e-01,
                         1.86493459e-01, -1.52876317e-01, -6.80666219e-02}};
float soa_bs451[][9] = {{8.32446468e-02, 1.69926776e-01, -1.82460287e-02,
                         1.39691768e-01, 2.29755383e-01, -2.93704718e-02,
                         -1.59521725e-01, -3.01860697e-02, -4.07334942e-02},
                        {8.32510525e-02, -1.69928358e-01, -1.82589493e-02,
                         1.39712225e-01, -2.29773824e-01, 2.93929486e-02,
                         -1.59517194e-01, -3.02000991e-02, -4.07096972e-02},
                        {3.45919275e-02, 1.67489241e-05, 9.70175857e-03,
                         9.87970342e-02, 4.30971692e-05, -2.54531402e-06,
                         -7.34629256e-02, 2.52814625e-02, 1.29718510e-01},
                        {3.53503429e-01, 3.64248007e-01, -3.00884131e-01,
                         -3.51144788e-01, -5.10333151e-02, -2.22055306e-01,
                         -1.07705218e-01, 5.08346917e-02, -1.37189614e-02},
                        {3.53494472e-01, -3.64235603e-01, -3.00880720e-01,
                         -3.51157710e-01, 5.10247076e-02, 2.22088143e-01,
                         -1.07691970e-01, 5.08380479e-02, -1.37248191e-02},
                        {1.18615486e-01, 1.05109741e-01, 2.29302286e-01,
                         1.48775202e-01, 1.30447937e-01, 1.49610320e-01,
                         1.26545863e-01, 2.24376799e-01, 3.23077568e-02},
                        {1.18602101e-01, -1.05099281e-01, 2.29302791e-01,
                         1.48743695e-01, -1.30420320e-01, -1.49614220e-01,
                         1.26583375e-01, 2.24379490e-01, 3.22736504e-02},
                        {1.60099784e-01, 1.45481824e-01, 3.16629415e-01,
                         -9.46404741e-02, -2.43374360e-02, 2.14044823e-01,
                         1.86715962e-01, -1.53041020e-01, -6.81136259e-02},
                        {1.60106104e-01, -1.45487113e-01, 3.16632871e-01,
                         -9.46511512e-02, 2.43478106e-02, -2.14043181e-01,
                         1.86701037e-01, -1.53046477e-01, -6.81423837e-02},
                        {1.48634625e-01, -6.54284101e-06, -2.95501399e-01,
                         2.07653099e-01, 5.14958861e-06, 7.39056671e-06,
                         1.77725070e-01, -3.18728232e-01, 1.08034019e-01}};
float soa_bs370[][9] = {{1.19597834e-01, 5.21389738e-06, -1.39801704e-01,
                         2.09644869e-01, 7.81221154e-06, -2.19967134e-05,
                         3.26507670e-02, -7.64815983e-02, 2.44533794e-01},
                        {1.30513126e-01, 1.47468351e-01, -1.88956217e-01,
                         1.73448570e-01, 2.47554931e-01, -1.12115307e-01,
                         3.87593682e-02, -1.38038669e-01, 3.49504573e-02},
                        {1.30521172e-01, -1.47477207e-01, -1.88982769e-01,
                         1.73449024e-01, -2.47560390e-01, 1.12120161e-01,
                         3.87993629e-02, -1.38063595e-01, 3.49347937e-02},
                        {1.38731604e-01, 1.54869409e-01, 2.64206860e-01,
                         1.53883733e-01, 1.32828069e-01, 2.36768375e-01,
                         1.34809170e-01, 2.22864964e-01, 1.09857379e-02},
                        {1.38728265e-01, -1.54844691e-01, 2.64217544e-01,
                         1.53873285e-01, -1.32781727e-01, -2.36751849e-01,
                         1.34835471e-01, 2.22880615e-01, 1.09690408e-02},
                        {1.94436278e-01, 3.66580349e-01, -1.38409554e-01,
                         1.17480653e-03, 1.80759757e-03, -6.28822525e-02,
                         -1.01595485e-02, -6.61302610e-02, -3.56247192e-01},
                        {1.94429720e-01, -3.66574005e-01, -1.38406824e-01,
                         1.16955797e-03, -1.80885115e-03, 6.28887758e-02,
                         -1.01805550e-02, -6.61121746e-02, -3.56257224e-01},
                        {1.98783854e-01, 1.66511753e-01, -2.18694298e-01,
                         -3.25915311e-01, -2.67648708e-01, -1.00953081e-01,
                         -2.64081829e-02, 1.64760537e-01, 1.86028975e-01},
                        {1.98776163e-01, -1.66496386e-01, -2.18683027e-01,
                         -3.25912389e-01, 2.67633260e-01, 1.00954678e-01,
                         -2.64183768e-02, 1.64751630e-01, 1.86047327e-01},
                        {2.20806942e-01, -9.52920353e-06, 4.34854087e-01,
                         -2.06239985e-01, -9.61099334e-06, -3.57955766e-07,
                         2.54441146e-01, -3.00795134e-01, -2.91279468e-03}};
float soa_bs490[][9] = {{1.14596505e-01, 1.40541335e-01, -1.69360895e-01,
                         1.39507156e-01, 2.26914719e-01, -1.08934809e-01,
                         4.19699941e-02, -1.12363457e-01, -7.25055022e-03},
                        {1.14612788e-01, -1.40565408e-01, -1.69363192e-01,
                         1.39532562e-01, -2.26952623e-01, 1.08919576e-01,
                         4.19791762e-02, -1.12348025e-01, -7.24881666e-03},
                        {8.78176001e-02, -7.83743018e-06, -1.03991184e-01,
                         1.38393755e-01, -1.36260909e-05, -2.07458844e-05,
                         4.96907853e-02, -1.94112385e-02, 1.66976280e-01},
                        {1.66527408e-01, 3.17214220e-01, -1.79892740e-01,
                         2.87704783e-02, 4.95676471e-02, -1.55496364e-01,
                         -2.01033216e-02, -2.67686983e-02, -3.27369086e-01},
                        {1.66528853e-01, -3.17221566e-01, -1.79878879e-01,
                         2.87476720e-02, -4.95281112e-02, 1.55472679e-01,
                         -2.01305783e-02, -2.67636380e-02, -3.27374799e-01},
                        {1.96044382e-01, 1.61408255e-01, -2.21036804e-01,
                         -3.26083157e-01, -2.54581373e-01, -1.14945984e-01,
                         -3.59322612e-02, 1.83757663e-01, 1.85989771e-01},
                        {1.96030376e-01, -1.61386132e-01, -2.21032115e-01,
                         -3.26069667e-01, 2.54566263e-01, 1.14950859e-01,
                         -3.59291926e-02, 1.83759382e-01, 1.86016437e-01},
                        {1.55264691e-01, 1.51798606e-01, 2.99235320e-01,
                         1.52173260e-01, 1.40211449e-01, 2.16324251e-01,
                         1.61198289e-01, 2.16493097e-01, 6.72163691e-04},
                        {1.55253633e-01, -1.51768484e-01, 2.99233177e-01,
                         1.52167057e-01, -1.40173798e-01, -2.16300471e-01,
                         1.61223918e-01, 2.16520410e-01, 6.53665667e-04},
                        {1.55472658e-01, 1.45214569e-01, 2.99909064e-01,
                         -1.52412015e-01, -1.23751887e-01, 2.10947489e-01,
                         1.61552498e-01, -2.17948734e-01, 3.20098658e-04},
                        {1.55476035e-01, -1.45230028e-01, 2.99907488e-01,
                         -1.52409906e-01, 1.23745252e-01, -2.10950077e-01,
                         1.61538661e-01, -2.17952375e-01, 2.91259737e-04},
                        {6.75613578e-02, 2.28868472e-02, -1.23024332e-01,
                         8.00856134e-02, 5.62366139e-02, -1.43607730e-02,
                         8.27190315e-02, -6.63142220e-02, 8.33496514e-02},
                        {6.75336396e-02, -2.28460518e-02, -1.23034402e-01,
                         8.00161789e-02, -5.61568825e-02, 1.43479187e-02,
                         8.27542807e-02, -6.63280776e-02, 8.32935706e-02}};
float soa_bs9A3[][22] = {{4.52721627e-02, 1.14448046e-01, 3.53946231e-04,
                          5.99455554e-02, 1.39696686e-01, 9.73068888e-04,
                          -9.50450826e-02, 1.74119959e-04, -9.64195234e-02},
                         {4.52753308e-02, -1.14451460e-01, 3.41038120e-04,
                          5.99579040e-02, -1.39715675e-01, -9.48293629e-04,
                          -9.50603875e-02, 1.55550928e-04, -9.64018582e-02},
                         {2.71462712e-02, 1.42963324e-05, -2.48990828e-05,
                          7.90770870e-02, 3.70602871e-05, -8.16074892e-07,
                          -6.20921099e-02, -6.44091255e-05, 1.07554921e-01},
                         {1.61421427e-01, 2.03980356e-01, -2.06584116e-01,
                          -2.03982448e-01, -3.18974090e-01, -1.22757396e-01,
                          1.96056507e-02, 1.22746896e-01, -1.30468617e-06},
                         {1.61419545e-01, -2.03986750e-01, -2.06568448e-01,
                          -2.03987218e-01, 3.18978111e-01, 1.22757945e-01,
                          1.95881353e-02, 1.22731732e-01, 8.84552201e-06},
                         {4.59414661e-02, 6.03136343e-02, 3.04587581e-06,
                          1.16382651e-01, 1.40724143e-01, -3.08458899e-06,
                          -9.65518361e-02, 7.84037002e-06, 9.89926750e-02},
                         {4.59433846e-02, -6.03167571e-02, 1.63488886e-05,
                          1.16382736e-01, -1.40724631e-01, -1.40374356e-05,
                          -9.65427557e-02, 3.56278847e-05, 9.89823549e-02},
                         {1.61419459e-01, -1.07062397e-05, -2.06561533e-01,
                          -2.88480598e-01, 9.66961104e-06, 3.90486793e-06,
                          1.95933453e-02, 1.73570349e-01, 3.18985553e-01},
                         {1.47436823e-01, 2.51605770e-01, -2.10803561e-01,
                          -1.60582447e-02, -3.98175469e-02, -1.84558174e-01,
                          4.87506224e-02, -3.19208287e-03, -2.82121142e-01},
                         {1.47440593e-01, -2.51625718e-01, -2.10792876e-01,
                          -1.60566361e-02, 3.98013481e-02, 1.84550564e-01,
                          4.87268705e-02, -3.18147635e-03, -2.82134307e-01},
                         {6.11122944e-02, 9.60474637e-02, 1.04069113e-01,
                          9.60582373e-02, 1.40585922e-01, 1.43834600e-01,
                          1.64851356e-02, 1.43843791e-01, 1.88606270e-05},
                         {6.10962230e-02, -9.60404348e-02, 1.04040734e-01,
                          9.60288374e-02, -1.40568654e-01, -1.43811561e-01,
                          1.64697833e-02, 1.43826948e-01, -3.24016341e-05},
                         {6.84019955e-02, 1.32673911e-05, 1.09779960e-01,
                          1.54985265e-01, 2.25537789e-05, 2.18005966e-05,
                          2.65392258e-03, 2.17606389e-01, 1.60125942e-01},
                         {1.50151863e-01, 1.72017569e-05, 3.80594597e-01,
                          -6.99617168e-06, 6.37185631e-06, 3.07362564e-05,
                          4.42130993e-01, -8.34850911e-06, 2.11431624e-06},
                         {6.66446207e-02, 1.05604854e-01, 1.08760016e-01,
                          -1.05618136e-01, -1.50684757e-01, 1.51541507e-01,
                          6.44221302e-03, -1.51546648e-01, 2.23570110e-05},
                         {6.66326437e-02, -1.05595511e-01, 1.08729815e-01,
                          -1.05611846e-01, 1.50684412e-01, -1.51507684e-01,
                          6.40693399e-03, -1.51547370e-01, 1.34060100e-05},
                         {6.75171968e-02, 1.52163306e-01, 1.09262910e-01,
                          -7.86759927e-05, 3.36443992e-04, 2.15965568e-01,
                          4.54626945e-03, -1.94411121e-04, -1.55401066e-01},
                         {6.75183983e-02, -1.52163887e-01, 1.09262456e-01,
                          -8.35889137e-05, -3.23237739e-04, -2.15952302e-01,
                          4.54658040e-03, -1.92269097e-04, -1.55408121e-01},
                         {6.66368216e-02, 8.62560626e-06, 1.08740724e-01,
                          -1.49349641e-01, -1.55479356e-05, 1.48152922e-05,
                          6.42477314e-03, -2.14296775e-01, 1.50688974e-01},
                         {1.10664414e-01, -5.95209064e-06, -2.17779981e-01,
                          1.48246047e-01, -7.55921292e-06, 8.28798061e-06,
                          1.30861236e-01, -2.03089711e-01, 1.54857082e-01},
                         {1.03366621e-01, 9.12771082e-02, -2.12034586e-01,
                          9.12985726e-02, 1.35304270e-01, -1.33555054e-01,
                          1.44613579e-01, -1.33579556e-01, 2.37599422e-05},
                         {1.03356263e-01, -9.12579867e-02, -2.12049009e-01,
                          9.12597150e-02, -1.35251074e-01, 1.33562410e-01,
                          1.44689537e-01, -1.33569871e-01, 5.60848982e-07}};
float soa_bs070[][9] = {{2.20936629e-01, 2.22026383e-01, 3.04591200e-05,
                         2.64789246e-01, 3.57259728e-01, 1.98002096e-06,
                         1.58397345e-01, 1.92029163e-05, 5.31768690e-02},
                        {2.20939236e-01, -2.22023658e-01, -8.09774224e-06,
                         2.64797784e-01, -3.57256273e-01, 2.28619221e-05,
                         1.58418498e-01, 8.66238043e-06, 5.31963521e-02},
                        {1.72075965e-01, 1.15126315e-05, -3.79393720e-05,
                         2.38411292e-01, 3.42696679e-05, -2.28462025e-05,
                         1.83381426e-01, -1.93589998e-05, 2.69336030e-01},
                        {2.44956861e-01, 3.88120701e-01, -1.61826105e-05,
                         4.39387534e-02, 7.05828630e-02, -7.90413711e-06,
                         1.45406936e-01, -1.28291232e-05, -3.86613744e-01},
                        {2.44950915e-01, -3.88116354e-01, -2.63899721e-07,
                         4.39213041e-02, -7.05500443e-02, -9.68145753e-06,
                         1.45415895e-01, 1.39441345e-05, -3.86622604e-01},
                        {2.98661080e-01, 2.28892636e-01, -7.11200700e-06,
                         -4.19373950e-01, -3.38029257e-01, -1.22966786e-06,
                         1.27129832e-01, 7.00346311e-06, 2.00395289e-01},
                        {2.98648345e-01, -2.28883557e-01, -1.49730367e-05,
                         -4.19371467e-01, 3.38034641e-01, 2.56207948e-05,
                         1.27095276e-01, -5.24844814e-06, 2.00406818e-01}};
float soa_bs470[][9] = {{1.31381003e-01, 1.48448976e-01, -1.90212725e-01,
                         1.74601956e-01, 2.49201104e-01, -1.12860844e-01,
                         3.90171076e-02, -1.38956589e-01, 3.51828684e-02},
                        {1.31389103e-01, -1.48457890e-01, -1.90239454e-01,
                         1.74602413e-01, -2.49206600e-01, 1.12865730e-01,
                         3.90573682e-02, -1.38981681e-01, 3.51671007e-02},
                        {1.20393127e-01, 5.24856840e-06, -1.40731348e-01,
                         2.11038951e-01, 7.86416065e-06, -2.21429856e-05,
                         3.28678858e-02, -7.69901804e-02, 2.46159877e-01},
                        {1.67069246e-01, 3.10560924e-01, -1.86057237e-01,
                         2.82853860e-02, 4.85579932e-02, -1.51114465e-01,
                         -7.96156218e-03, -2.64000841e-02, -3.21143174e-01},
                        {1.67070671e-01, -3.10570508e-01, -1.86043667e-01,
                         2.82630933e-02, -4.85219695e-02, 1.51097035e-01,
                         -7.98825644e-03, -2.63953706e-02, -3.21148690e-01},
                        {1.95954226e-01, 1.57977872e-01, -2.26221524e-01,
                         -3.19209734e-01, -2.49382537e-01, -1.11942235e-01,
                         -2.37575885e-02, 1.78661396e-01, 1.81921116e-01},
                        {1.95940422e-01, -1.57958407e-01, -2.26216773e-01,
                         -3.19196381e-01, 2.49364660e-01, 1.11952482e-01,
                         -2.37547295e-02, 1.78662882e-01, 1.81947077e-01},
                        {1.52288146e-01, 1.48882653e-01, 2.93565797e-01,
                         1.49174601e-01, 1.37440496e-01, 2.12213855e-01,
                         1.58266499e-01, 2.12341431e-01, 5.32551336e-04},
                        {1.52279289e-01, -1.48853614e-01, 2.93565956e-01,
                         1.49174133e-01, -1.37404714e-01, -2.12192383e-01,
                         1.58288661e-01, 2.12373741e-01, 5.22608321e-04},
                        {1.52541806e-01, 1.42477095e-01, 2.94255408e-01,
                         -1.49538860e-01, -1.21419011e-01, 2.06970868e-01,
                         1.58507034e-01, -2.13840131e-01, 3.14064403e-04},
                        {1.52545120e-01, -1.42492263e-01, 2.94253861e-01,
                         -1.49536791e-01, 1.21412501e-01, -2.06973407e-01,
                         1.58493458e-01, -2.13843703e-01, 2.85769131e-04}};

float soa_iamf312[][9] = {
    {4.726751e-01, 5.264195e-01, -1.779691e-01, -8.917566e-02, 2.168611e-01,
     -1.274446e-01, 6.197195e-02, -1.513111e-01, -9.806416e-02},
    {4.726787e-01, -5.264100e-01, -1.779698e-01, -8.916373e-02, -2.168667e-01,
     1.274678e-01, 6.195992e-02, -1.513142e-01, -9.804430e-02},
    {1.020026e-01, 1.166793e-05, -1.326678e-01, 1.915148e-01, 3.223244e-05,
     -9.390242e-06, 3.592754e-02, -1.191927e-01, 2.133239e-01},
    {1.148273e-01, 9.834126e-02, 2.237200e-01, 1.450837e-01, 1.251282e-01,
     1.420999e-01, 1.275855e-01, 2.195166e-01, 3.735070e-02},
    {1.148147e-01, -9.833212e-02, 2.237213e-01, 1.450532e-01, -1.251021e-01,
     -1.421055e-01, 1.276224e-01, 2.195205e-01, 3.731617e-02}};

float soa_iamf712[][9] = {
    {1.31381003e-01, 1.48448976e-01, -1.90212725e-01, 1.74601956e-01,
     2.49201104e-01, -1.12860844e-01, 3.90171076e-02, -1.38956589e-01,
     3.51828684e-02},  // L
    {1.31389103e-01, -1.48457890e-01, -1.90239454e-01, 1.74602413e-01,
     -2.49206600e-01, 1.12865730e-01, 3.90573682e-02, -1.38981681e-01,
     3.51671007e-02},  // R
    {1.20393127e-01, 5.24856840e-06, -1.40731348e-01, 2.11038951e-01,
     7.86416065e-06, -2.21429856e-05, 3.28678858e-02, -7.69901804e-02,
     2.46159877e-01},  // C
    {1.67069246e-01, 3.10560924e-01, -1.86057237e-01, 2.82853860e-02,
     4.85579932e-02, -1.51114465e-01, -7.96156218e-03, -2.64000841e-02,
     -3.21143174e-01},  // Ls
    {1.67070671e-01, -3.10570508e-01, -1.86043667e-01, 2.82630933e-02,
     -4.85219695e-02, 1.51097035e-01, -7.98825644e-03, -2.63953706e-02,
     -3.21148690e-01},  // Rs
    {1.95954226e-01, 1.57977872e-01, -2.26221524e-01, -3.19209734e-01,
     -2.49382537e-01, -1.11942235e-01, -2.37575885e-02, 1.78661396e-01,
     1.81921116e-01},  // Lb
    {1.95940422e-01, -1.57958407e-01, -2.26216773e-01, -3.19196381e-01,
     2.49364660e-01, 1.11952482e-01, -2.37547295e-02, 1.78662882e-01,
     1.81947077e-01},  // Rb
    {2.601515e-01, 2.496292e-01, 5.016358e-01, 4.343466e-02, 5.158429e-02,
     3.585644e-01, 2.703479e-01, 6.113362e-02, 7.546284e-04},  // Hfl
    {2.601450e-01, -2.496109e-01, 5.016349e-01, 4.343565e-02, -5.155311e-02,
     -3.585447e-01, 2.703605e-01, 6.116341e-02, 7.246776e-04}  // Hfr
};

////////////////////////////////////////////////////
float toa_mono[] = {
    6.10511935e-01,  3.86500000e-06, -1.91573496e-07, 7.24558034e-02,
    4.08650000e-06,  8.20076800e-06, 9.21965792e-02,  7.92412745e-07,
    1.58188144e-01,  5.33100000e-06, 3.17888835e-07,  -1.05779500e-05,
    -8.21749078e-06, 3.96539739e-02, -1.52839265e-05, 4.95221244e-02};
float toa_bs020[][16] = {
    {6.10506790e-01, 5.59954517e-01, -8.40095644e-07, 7.24423772e-02,
     2.45957178e-01, 2.34545040e-06, 9.21998360e-02, -1.43829130e-07,
     1.58178631e-01, 1.05906734e-01, -9.21200162e-06, 1.44451230e-02,
     6.21297703e-06, 3.96432134e-02, -1.75258363e-05, 4.95199472e-02},
    {6.10517081e-01, -5.59946787e-01, 4.56948652e-07, 7.24692296e-02,
     -2.45949005e-01, 1.40560856e-05, 9.21933224e-02, 1.72865462e-06,
     1.58197658e-01, -1.05896072e-01, 9.84777929e-06, -1.44662789e-02,
     -2.26479586e-05, 3.96647344e-02, -1.30420167e-05, 4.95243016e-02}};
float toa_bs050[][16] = {
    {2.33807835e-01, 2.89839640e-01, 1.59440044e-05, 2.86919259e-01,
     3.70162807e-01, 4.57037099e-06, 1.21793202e-01, 2.56900160e-05,
     -3.75129600e-02, 1.72536788e-01, 5.77929061e-06, 2.46229266e-02,
     2.48058818e-05, 9.99408784e-02, -1.01778940e-05, -1.79109959e-01},
    {2.33809849e-01, -2.89842271e-01, 9.24433834e-06, 2.86930346e-01,
     -3.70162552e-01, 1.36459969e-05, 1.21814096e-01, 2.02324234e-05,
     -3.74986621e-02, -1.72537539e-01, 5.10770603e-06, -2.46484608e-02,
     2.24040235e-05, 9.99579906e-02, 3.96795780e-07, -1.79124343e-01},
    {1.54134100e-01, 8.54133677e-06, -3.79957556e-05, 2.47654454e-01,
     3.54542573e-05, -1.31960475e-05, 1.59469362e-01, -4.34876004e-06,
     2.54145291e-01, 4.07532571e-05, -1.49779726e-05, -1.85696065e-06,
     -8.99311763e-05, 8.95494788e-02, -2.56455737e-05, 2.70100462e-01},
    {4.36024428e-01, 4.20863012e-01, -4.10609301e-06, -4.01723899e-01,
     -9.89700716e-02, 2.49462661e-06, 8.55684219e-02, -1.54695727e-06,
     -7.57555649e-02, -1.63523625e-01, -1.51969313e-05, 5.18447306e-02,
     9.60991661e-06, -3.99600042e-02, 7.87290152e-06, -1.78541741e-02},
    {4.36020172e-01, -4.20841446e-01, 1.00172390e-05, -4.01739692e-01,
     9.89794955e-02, 1.58061156e-06, 8.55529393e-02, 9.54811912e-06,
     -7.57746720e-02, 1.63538437e-01, 5.10898762e-06, -5.18386067e-02,
     2.64968798e-06, -3.99650766e-02, -4.18470864e-06, -1.78397549e-02}};
float toa_bs250[][16] = {
    {1.47543221e-01, 2.09510051e-01, -1.79086204e-01, 1.95180720e-01,
     2.75513653e-01, -1.27424627e-01, -2.55912511e-03, -1.50019951e-01,
     -3.69948511e-02, 1.26116466e-01, -1.52740939e-01, -5.38908230e-02,
     -1.86836021e-02, -5.84077120e-03, 1.14490176e-02, -1.53960650e-01},
    {1.47550644e-01, -2.09515657e-01, -1.79095692e-01, 1.95204382e-01,
     -2.75522911e-01, 1.27445231e-01, -2.56026828e-03, -1.50030004e-01,
     -3.69631688e-02, -1.26133552e-01, 1.52742883e-01, 5.38742783e-02,
     -1.86963736e-02, -5.84701382e-03, 1.14562599e-02, -1.53935681e-01},
    {9.92742752e-02, 1.13558421e-05, -1.29119291e-01, 1.86392335e-01,
     3.13703112e-05, -9.13907907e-06, 3.49665798e-02, -1.16004653e-01,
     2.07618022e-01, 3.94596117e-05, -2.87941415e-05, 4.17936507e-06,
     -6.57885105e-02, -1.79100086e-02, -8.36478901e-02, 2.21708712e-01},
    {4.41926308e-01, 4.28265161e-01, 8.31171912e-03, -3.98767457e-01,
     -9.11502674e-02, 4.79256619e-03, 8.89165443e-02, 3.89763292e-03,
     -8.26556301e-02, -1.64741393e-01, 7.34130565e-03, 4.55127066e-02,
     1.57174239e-03, -4.06651499e-02, -7.74208653e-03, -2.84149500e-02},
    {4.41920767e-01, -4.28244047e-01, 8.32426414e-03, -3.98784508e-01,
     9.11556537e-02, -4.78975999e-03, 8.89016107e-02, 3.90753714e-03,
     -8.26731106e-02, 1.64745462e-01, -7.35804577e-03, -4.55056466e-02,
     1.56664042e-03, -4.06703815e-02, -7.75179027e-03, -2.83998198e-02},
    {1.11756005e-01, 9.57108952e-02, 2.17736063e-01, 1.41203105e-01,
     1.21781365e-01, 1.38299125e-01, 1.24172960e-01, 2.13645126e-01,
     3.63516712e-02, 6.78595476e-02, 1.73251505e-01, 6.48593533e-02,
     -1.12965067e-02, 1.23632115e-01, 4.36275209e-02, -5.88275782e-03},
    {1.11743685e-01, -9.57020079e-02, 2.17737381e-01, 1.41173429e-01,
     -1.21755963e-01, -1.38304589e-01, 1.24208809e-01, 2.13648898e-01,
     3.63180668e-02, -6.78220761e-02, -1.73246378e-01, -6.48820658e-02,
     -1.12875031e-02, 1.23676703e-01, 4.36323797e-02, -5.93294284e-03}};
float toa_bs450[][16] = {
    {1.50756115e-01, 2.16688234e-01, -1.78828165e-01, 1.98240750e-01,
     2.81359727e-01, -1.24294672e-01, -6.55998548e-03, -1.49977379e-01,
     -4.34264838e-02, 1.22063156e-01, -1.50883522e-01, -5.91933853e-02,
     -2.34899275e-02, -7.23463536e-03, 6.72194463e-03, -1.60458394e-01},
    {1.50763107e-01, -2.16692390e-01, -1.78837822e-01, 1.98264732e-01,
     -2.81369272e-01, 1.24315683e-01, -6.56005567e-03, -1.49987274e-01,
     -4.33922138e-02, -1.22083706e-01, 1.50884847e-01, 5.91749258e-02,
     -2.35025549e-02, -7.24101236e-03, 6.72957338e-03, -1.60433126e-01},
    {1.00028711e-01, 1.14421409e-05, -1.30100534e-01, 1.87808824e-01,
     3.16087100e-05, -9.20853155e-06, 3.52323085e-02, -1.16886231e-01,
     2.09195816e-01, 3.97594852e-05, -2.90129627e-05, 4.21112618e-06,
     -6.62884707e-02, -1.80461159e-02, -8.42835727e-02, 2.23393588e-01},
    {3.23639522e-01, 3.24879837e-01, -2.56306369e-01, -3.62579475e-01,
     -8.76538120e-02, -1.70628478e-01, -1.22195567e-01, 8.46185566e-02,
     -1.58569895e-02, -1.20092226e-01, 2.49064662e-02, -7.69746815e-02,
     -5.42917543e-02, 5.02503105e-02, 9.56172948e-02, -3.56423229e-02},
    {3.23630434e-01, -3.24856213e-01, -2.56295555e-01, -3.62589571e-01,
     8.76516427e-02, 1.70628843e-01, -1.22199326e-01, 8.46321704e-02,
     -1.58558786e-02, 1.20090014e-01, -2.49258113e-02, 7.69681562e-02,
     -5.42803328e-02, 5.02315396e-02, 9.56269403e-02, -3.56466601e-02},
    {1.14579504e-01, 1.01533302e-01, 2.21500102e-01, 1.43713013e-01,
     1.26009347e-01, 1.44519716e-01, 1.22240044e-01, 2.16742208e-01,
     3.12084608e-02, 6.41137549e-02, 1.78205228e-01, 6.30138341e-02,
     -1.67658863e-02, 1.23938253e-01, 3.80694246e-02, -1.04491802e-02},
    {1.14566575e-01, -1.01523198e-01, 2.21500590e-01, 1.43682578e-01,
     -1.25982669e-01, -1.44523483e-01, 1.22276279e-01, 2.16744807e-01,
     3.11755150e-02, -6.40761826e-02, -1.78197281e-01, -6.30360121e-02,
     -1.67555250e-02, 1.23982022e-01, 3.80756937e-02, -1.04983585e-02},
    {1.54652267e-01, 1.40531695e-01, 3.05855859e-01, -9.14202601e-02,
     -2.35093363e-02, 2.06761785e-01, 1.80362810e-01, -1.47833683e-01,
     -6.57960081e-02, -6.16566732e-02, -3.96750859e-02, 1.04145646e-01,
     -2.22431797e-02, -1.02998270e-01, -8.35279117e-02, 1.50958693e-02},
    {1.54658373e-01, -1.40536804e-01, 3.05859197e-01, -9.14305739e-02,
     2.35193579e-02, -2.06760200e-01, 1.80348392e-01, -1.47838954e-01,
     -6.58237874e-02, 6.16762274e-02, 3.96788703e-02, -1.04135571e-01,
     -2.22583948e-02, -1.02984409e-01, -8.35499005e-02, 1.51327090e-02}};
float toa_bs451[][16] = {
    {8.04315613e-02, 1.64184442e-01, -1.76294409e-02, 1.34971166e-01,
     2.21991261e-01, -2.83779557e-02, -1.54131009e-01, -2.91659921e-02,
     -3.93569876e-02, 9.30067741e-02, -4.04155618e-02, -1.44645215e-01,
     4.00210665e-02, -1.25601429e-01, -3.86631951e-03, -1.40125542e-01},
    {8.04377505e-02, -1.64185970e-01, -1.76419248e-02, 1.34990931e-01,
     -2.22009079e-01, 2.83996730e-02, -1.54126631e-01, -2.91795474e-02,
     -3.93339948e-02, -9.30254203e-02, 4.04454636e-02, 1.44620064e-01,
     4.00219977e-02, -1.25600671e-01, -3.85146382e-03, -1.40121616e-01},
    {3.34229628e-02, 1.61829279e-05, 9.37390714e-03, 9.54583869e-02,
     4.16407869e-05, -2.45930024e-06, -7.09803936e-02, 2.44271263e-02,
     1.25334934e-01, 6.57182335e-05, -7.34799017e-06, -2.07748352e-05,
     -2.61867129e-02, -1.03438162e-01, 3.19394229e-02, 1.38924382e-01},
    {3.41557491e-01, 3.51938978e-01, -2.90716357e-01, -3.39278556e-01,
     -4.93087468e-02, -2.14551393e-01, -1.04065537e-01, 4.91168355e-02,
     -1.32553566e-02, -9.47887971e-02, -3.79537286e-02, -4.69442143e-02,
     -5.03329397e-02, 6.95665632e-02, 9.20953397e-02, -5.02538839e-02},
    {3.41548837e-01, -3.51926992e-01, -2.90713061e-01, -3.39291041e-01,
     4.93004302e-02, 2.14583120e-01, -1.04052737e-01, 4.91200782e-02,
     -1.32610165e-02, 9.47943477e-02, 3.79667218e-02, 4.68937528e-02,
     -5.03321709e-02, 6.95752261e-02, 9.21012239e-02, -5.02658277e-02},
    {1.14607114e-01, 1.01557768e-01, 2.21553476e-01, 1.43747644e-01,
     1.26039711e-01, 1.44554540e-01, 1.22269500e-01, 2.16794436e-01,
     3.12159811e-02, 6.41292043e-02, 1.78248170e-01, 6.30290184e-02,
     -1.67699264e-02, 1.23968118e-01, 3.80785981e-02, -1.04516982e-02},
    {1.14594182e-01, -1.01547662e-01, 2.21553964e-01, 1.43717201e-01,
     -1.26013027e-01, -1.44558308e-01, 1.22305744e-01, 2.16797036e-01,
     3.11830273e-02, -6.40916229e-02, -1.78240221e-01, -6.30512018e-02,
     -1.67595625e-02, 1.24011897e-01, 3.80848687e-02, -1.05008883e-02},
    {1.54689534e-01, 1.40565559e-01, 3.05929561e-01, -9.14422894e-02,
     -2.35150013e-02, 2.06811608e-01, 1.80406271e-01, -1.47869306e-01,
     -6.58118628e-02, -6.16715305e-02, -3.96846463e-02, 1.04170741e-01,
     -2.22485396e-02, -1.03023089e-01, -8.35480392e-02, 1.50995069e-02},
    {1.54695640e-01, -1.40570669e-01, 3.05932900e-01, -9.14526057e-02,
     2.35250253e-02, -2.06810022e-01, 1.80391850e-01, -1.47874579e-01,
     -6.58396488e-02, 6.16910894e-02, 3.96884316e-02, -1.04160665e-01,
     -2.22637584e-02, -1.03009225e-01, -8.35700333e-02, 1.51363555e-02},
    {1.43611816e-01, -6.32173885e-06, -2.85515523e-01, 2.00635880e-01,
     4.97556861e-06, 7.14081736e-06, 1.71719209e-01, -3.07957452e-01,
     1.04383227e-01, 8.04645161e-06, -1.20867740e-05, 2.20219271e-06,
     1.59144307e-02, 1.85790283e-01, -1.19381206e-01, 5.15775831e-02}};
float toa_bs370[][16] = {
    {1.14029613e-01, 4.97114940e-06, -1.33292834e-01, 1.99884249e-01,
     7.44849157e-06, -2.09725931e-05, 3.11306167e-02, -7.29207776e-02,
     2.33148820e-01, 4.96897682e-06, -3.86227009e-05, 2.55401441e-05,
     -8.44932543e-02, -6.06040323e-02, -6.67155950e-02, 2.38388301e-01},
    {1.24436712e-01, 1.40602538e-01, -1.80158817e-01, 1.65373173e-01,
     2.36029299e-01, -1.06895457e-01, 3.69548143e-02, -1.31611882e-01,
     3.33232383e-02, 1.82868381e-01, -1.62513697e-01, -3.31009778e-02,
     -9.98733531e-03, -2.99676476e-02, -2.29988162e-02, -1.07254125e-01},
    {1.24444383e-01, -1.40610981e-01, -1.80184133e-01, 1.65373606e-01,
     -2.36034505e-01, 1.06900085e-01, 3.69929470e-02, -1.31635647e-01,
     3.33083039e-02, -1.82858844e-01, 1.62518733e-01, 3.30841745e-02,
     -1.00266536e-02, -2.99412648e-02, -2.30342154e-02, -1.07283316e-01},
    {1.32272555e-01, 1.47659018e-01, 2.51905950e-01, 1.46719233e-01,
     1.26643876e-01, 2.25744942e-01, 1.28532741e-01, 2.12488845e-01,
     1.04742653e-02, 3.83603792e-02, 1.59366152e-01, 1.40150638e-01,
     -3.88684321e-02, 1.02769366e-01, 1.44091478e-02, -3.03188576e-02},
    {1.32269371e-01, -1.47635451e-01, 2.51916137e-01, 1.46709272e-01,
     -1.26599692e-01, -2.25729186e-01, 1.28557818e-01, 2.12503767e-01,
     1.04583456e-02, -3.83083913e-02, -1.59340067e-01, -1.40161905e-01,
     -3.88708599e-02, 1.02798263e-01, 1.44052554e-02, -3.03287027e-02},
    {1.85383738e-01, 3.49513147e-01, -1.31965500e-01, 1.12011003e-03,
     1.72343966e-03, -5.99545884e-02, -9.68654153e-03, -6.30513765e-02,
     -3.39661080e-01, -2.34148530e-01, -9.92115511e-02, -4.90985547e-02,
     -1.02584029e-01, -1.45209104e-02, 7.36520768e-02, -4.63003386e-03},
    {1.85377485e-01, -3.49507098e-01, -1.31962897e-01, 1.11510583e-03,
     -1.72463488e-03, 5.99608080e-02, -9.70657000e-03, -6.30341322e-02,
     -3.39670645e-01, 2.34170460e-01, 9.91863760e-02, 4.91495813e-02,
     -1.02584392e-01, -1.45744903e-02, 7.36625547e-02, -4.62045647e-03},
    {1.89528900e-01, 1.58759320e-01, -2.08512356e-01, -3.10741386e-01,
     -2.55187553e-01, -9.62529197e-02, -2.51786740e-02, 1.57089636e-01,
     1.77367861e-01, 1.72065899e-01, 1.20256870e-01, -3.91284012e-02,
     -1.75630480e-02, 8.06131907e-02, -4.47292129e-02, -2.92861521e-03},
    {1.89521567e-01, -1.58744668e-01, -2.08501610e-01, -3.10738601e-01,
     2.55172824e-01, 9.62544425e-02, -2.51883933e-02, 1.57081144e-01,
     1.77385359e-01, -1.72080613e-01, -1.20253672e-01, 3.90984366e-02,
     -1.75531061e-02, 8.06306128e-02, -4.47276082e-02, -2.93657860e-03},
    {2.10526640e-01, -9.08554406e-06, 4.14608204e-01, -1.96637889e-01,
     -9.16352591e-06, -3.41290106e-07, 2.42594906e-01, -2.86790751e-01,
     -2.77718114e-03, 2.82969445e-05, -1.32321826e-05, 1.77791692e-05,
     -2.66120808e-02, -1.39421728e-01, -5.67531532e-03, 4.02574449e-02}};
float toa_bs490[][16] = {
    {1.08791442e-01, 1.33421997e-01, -1.60781658e-01, 1.32440206e-01,
     2.15420004e-01, -1.03416548e-01, 3.98439393e-02, -1.06671513e-01,
     -6.88326242e-03, 1.45215921e-01, -1.51809773e-01, -2.95538775e-02,
     -1.39828416e-02, -2.12209800e-02, 7.43032829e-03, -1.46807095e-01},
    {1.08806901e-01, -1.33444851e-01, -1.60783838e-01, 1.32464325e-01,
     -2.15455988e-01, 1.03402087e-01, 3.98526564e-02, -1.06656862e-01,
     -6.88161668e-03, -1.45244141e-01, 1.51766124e-01, 2.95421404e-02,
     -1.40466155e-02, -2.12139637e-02, 7.43058034e-03, -1.46837350e-01},
    {8.33690642e-02, -7.44041307e-06, -9.87233504e-02, 1.31383206e-01,
     -1.29358403e-05, -1.96949696e-05, 4.71736219e-02, -1.84279323e-02,
     1.58517839e-01, -1.19848829e-05, -4.41056479e-05, 5.54153757e-06,
     -1.03597852e-01, -4.43128901e-02, -7.39563482e-03, 1.75483259e-01},
    {1.58091706e-01, 3.01145245e-01, -1.70779996e-01, 2.73130654e-02,
     4.70567215e-02, -1.47619456e-01, -1.90849569e-02, -2.54126886e-02,
     -3.10785700e-01, -2.34224637e-01, -3.37407892e-02, -8.80185728e-02,
     -3.54299901e-02, 2.88138742e-03, 1.32105899e-01, -4.56042261e-02},
    {1.58093077e-01, -3.01152219e-01, -1.70766837e-01, 2.72914143e-02,
     -4.70191884e-02, 1.47596971e-01, -1.91108329e-02, -2.54078847e-02,
     -3.10791124e-01, 2.34216016e-01, 3.37506972e-02, 8.80672378e-02,
     -3.54443118e-02, 2.84555378e-03, 1.32111952e-01, -4.55701879e-02},
    {1.86113451e-01, 1.53231871e-01, -2.09839844e-01, -3.09564912e-01,
     -2.41685161e-01, -1.09123218e-01, -3.41120571e-02, 1.74449136e-01,
     1.76568172e-01, 1.53202125e-01, 1.46186228e-01, -3.58968180e-02,
     3.30876484e-03, 8.34511883e-02, -5.62621888e-02, -2.97493717e-03},
    {1.86100155e-01, -1.53210869e-01, -2.09835392e-01, -3.09552105e-01,
     2.41670817e-01, 1.09127846e-01, -3.41091440e-02, 1.74450767e-01,
     1.76593487e-01, -1.53224355e-01, -1.46197809e-01, 3.58766817e-02,
     3.34631381e-03, 8.34557218e-02, -5.62486140e-02, -3.01128694e-03},
    {1.47399519e-01, 1.44109013e-01, 2.84077094e-01, 1.44464689e-01,
     1.33108822e-01, 2.05366013e-01, 1.53032541e-01, 2.05526306e-01,
     6.38114203e-04, 2.98928362e-02, 1.74272551e-01, 9.15891765e-02,
     -3.27879401e-02, 9.11493814e-02, 3.40484012e-04, -2.85703311e-02},
    {1.47389021e-01, -1.44080417e-01, 2.84075059e-01, 1.44458800e-01,
     -1.33073078e-01, -2.05343438e-01, 1.53056872e-01, 2.05552235e-01,
     6.20553225e-04, -2.98353285e-02, -1.74252846e-01, -9.16015847e-02,
     -3.27783548e-02, 9.11944274e-02, 3.45241780e-04, -2.86139713e-02},
    {1.47596951e-01, 1.37858501e-01, 2.84716708e-01, -1.44691350e-01,
     -1.17483044e-01, 2.00261618e-01, 1.53368808e-01, -2.06908205e-01,
     3.03883567e-04, 6.00175758e-03, -1.60858273e-01, 9.62946811e-02,
     -3.41084048e-02, -9.26824244e-02, 1.36010486e-03, 2.90059554e-02},
    {1.47600157e-01, -1.37873177e-01, 2.84715212e-01, -1.44689347e-01,
     1.17476745e-01, -2.00264075e-01, 1.53355671e-01, -2.06911661e-01,
     2.76505526e-04, -5.97141897e-03, 1.60843621e-01, -9.62698043e-02,
     -3.41166774e-02, -9.27015685e-02, 1.35194209e-03, 2.90205732e-02},
    {6.41389330e-02, 2.17274787e-02, -1.16792345e-01, 7.60287532e-02,
     5.33878615e-02, -1.36333059e-02, 7.85287715e-02, -6.29549728e-02,
     7.91274464e-02, 8.45496272e-02, -3.14411738e-02, -7.01468017e-03,
     -5.58275686e-02, -9.83582064e-03, -5.88008992e-02, 7.25960399e-02},
    {6.41126190e-02, -2.16887498e-02, -1.16801905e-01, 7.59628360e-02,
     -5.33121690e-02, 1.36211028e-02, 7.85622350e-02, -6.29681266e-02,
     7.90742064e-02, -8.44618248e-02, 3.14413574e-02, 7.06426959e-03,
     -5.58051464e-02, -9.84207867e-03, -5.88266901e-02, 7.25710260e-02}};
float toa_bs9A3[][16] = {
    {4.04576287e-02, 1.02276902e-01, 3.16305304e-04, 5.35705581e-02,
     1.24840439e-01, 8.69586461e-04, -8.49373750e-02, 1.55602919e-04,
     -8.61656489e-02, -1.99113803e-02, 4.59578590e-04, -1.07672132e-01,
     -1.00584229e-03, -5.80424713e-02, -1.24512586e-03, -1.67195449e-01},
    {4.04604598e-02, -1.02279953e-01, 3.04769925e-04, 5.35815935e-02,
     -1.24857409e-01, -8.47445963e-04, -8.49510523e-02, 1.39008638e-04,
     -8.61498623e-02, 1.98737596e-02, -4.23839742e-04, 1.07688993e-01,
     -9.86892094e-04, -5.80707244e-02, -1.23581553e-03, -1.67194266e-01},
    {2.42593615e-02, 1.27759681e-05, -2.22511536e-05, 7.06675191e-02,
     3.31190569e-05, -7.29288220e-07, -5.54888342e-02, -5.75594434e-05,
     9.61168360e-02, 5.34761744e-05, -2.08445060e-06, -1.41471343e-05,
     5.40168531e-05, -8.68975091e-02, -7.94580100e-05, 1.12200494e-01},
    {1.44254831e-01, 1.82287768e-01, -1.84614628e-01, -1.82289638e-01,
     -2.85052327e-01, -1.09702582e-01, 1.75206593e-02, 1.09693199e-01,
     -1.16593742e-06, 1.75755167e-01, 1.54649417e-01, -5.44214736e-02,
     -2.90973425e-02, 5.44258679e-02, 2.16559686e-05, 1.75746369e-01},
    {1.44253148e-01, -1.82293483e-01, -1.84600626e-01, -1.82293900e-01,
     2.85055919e-01, 1.09703072e-01, 1.75050066e-02, 1.09679648e-01,
     7.90483210e-06, -1.75761802e-01, -1.54628896e-01, 5.44167186e-02,
     -2.90891782e-02, 5.44369320e-02, 2.29363675e-05, 1.75746293e-01},
    {4.10557540e-02, 5.38994932e-02, 2.72195772e-06, 1.04005769e-01,
     1.25758629e-01, -2.75655388e-06, -8.62838906e-02, 7.00657447e-06,
     8.84651549e-02, 1.68860718e-01, -6.78892917e-06, -5.84644783e-02,
     -3.24528797e-06, -1.09724858e-01, 1.19009702e-05, 2.24786259e-02},
    {4.10574686e-02, -5.39022838e-02, 1.46102423e-05, 1.04005845e-01,
     -1.25759065e-01, -1.25446041e-05, -8.62757759e-02, 3.18389854e-05,
     8.84559323e-02, -1.68848099e-01, -2.27705392e-05, 5.84611983e-02,
     -3.51127111e-05, -1.09696895e-01, 2.44870439e-05, 2.24619237e-02},
    {1.44253072e-01, -9.56766908e-06, -1.84594446e-01, -2.57801710e-01,
     8.64128219e-06, 3.48959907e-06, 1.75096625e-02, 1.55111758e-01,
     2.85062570e-01, -5.84924373e-06, 1.53350141e-05, -1.27155811e-05,
     -2.91096380e-02, 7.69598214e-02, -1.54618594e-01, -2.48570195e-01},
    {1.31757440e-01, 2.24848388e-01, -1.88385350e-01, -1.43505073e-02,
     -3.55830919e-02, -1.64931067e-01, 4.35661665e-02, -2.85261618e-03,
     -2.52118559e-01, -2.30174605e-01, -7.95010361e-03, -4.26527825e-02,
     -1.83854620e-02, 1.54535957e-02, 1.67110504e-01, 5.34036132e-02},
    {1.31760808e-01, -2.24866215e-01, -1.88375801e-01, -1.43490698e-02,
     3.55686158e-02, 1.64924266e-01, 4.35449406e-02, -2.84313762e-03,
     -2.52130324e-01, 2.30189900e-01, 7.94353088e-03, 4.26780776e-02,
     -1.83949062e-02, 1.54348167e-02, 1.67098535e-01, 5.33791880e-02},
    {5.46132185e-02, 8.58331564e-02, 9.30017320e-02, 8.58427843e-02,
     1.25635108e-01, 1.28538300e-01, 1.47319998e-02, 1.28546514e-01,
     1.68548662e-05, 7.78214512e-02, 1.86713054e-01, 6.88190732e-02,
     -7.57587907e-02, 6.88154210e-02, 1.37678330e-05, -7.77835818e-02},
    {5.45988563e-02, -8.58268751e-02, 9.29763705e-02, 8.58165110e-02,
     -1.25619676e-01, -1.28517712e-01, 1.47182803e-02, 1.28531462e-01,
     -2.89558352e-05, -7.77589946e-02, -1.86712591e-01, -6.87831667e-02,
     -7.57667306e-02, 6.88420404e-02, -6.82053548e-08, -7.78339431e-02},
    {6.11276858e-02, 1.18564511e-05, 9.81052509e-02, 1.38503132e-01,
     2.01552645e-05, 1.94821804e-05, 2.37168732e-03, 1.94464721e-01,
     1.43097116e-01, 2.06384756e-05, 3.00249563e-05, 1.64138024e-05,
     -9.05561062e-02, 8.24571561e-02, 2.00250670e-01, 1.20667590e-01},
    {1.34183745e-01, 1.53724110e-05, 3.40119711e-01, -6.25215362e-06,
     5.69423198e-06, 2.74675645e-05, 3.95111929e-01, -7.46067477e-06,
     1.88946620e-06, -1.08879508e-05, 9.44167688e-06, 2.31814191e-05,
     2.95866750e-01, 3.75221202e-06, 5.51441629e-06, -9.91996045e-06},
    {5.95572016e-02, 9.43741521e-02, 9.71937743e-02, -9.43860214e-02,
     -1.34659967e-01, 1.35425605e-01, 5.75710650e-03, -1.35430199e-01,
     1.99794221e-05, 7.68969299e-02, -1.94510974e-01, 6.20782748e-02,
     -8.76721022e-02, -6.20594490e-02, 1.15500220e-05, 7.68630056e-02},
    {5.95464983e-02, -9.43658029e-02, 9.71667844e-02, -9.43804002e-02,
     1.34659659e-01, -1.35395379e-01, 5.72557927e-03, -1.35430845e-01,
     1.19803283e-05, -7.68849646e-02, 1.94511297e-01, -6.20333654e-02,
     -8.76988258e-02, -6.20701988e-02, 4.00940343e-05, 7.68851721e-02},
    {6.03369822e-02, 1.35981277e-01, 9.76431864e-02, -7.03090798e-05,
     3.00664366e-04, 1.92998395e-01, 4.06278981e-03, -1.73736188e-04,
     -1.38874714e-01, -1.14705421e-01, -9.56222736e-05, 8.51432034e-02,
     -8.91337556e-02, -6.91484919e-05, -1.97380720e-01, -1.74083460e-03},
    {6.03380560e-02, -1.35981797e-01, 9.76427813e-02, -7.46995291e-05,
     -2.88862552e-04, -1.92986540e-01, 4.06306769e-03, -1.71821960e-04,
     -1.38881019e-01, 1.14707469e-01, 9.12626892e-05, -8.51092373e-02,
     -8.91063144e-02, -6.04101296e-05, -1.97392527e-01, -1.72110956e-03},
    {5.95502319e-02, 7.70830361e-06, 9.71765339e-02, -1.33466836e-01,
     -1.38944677e-05, 1.32397384e-05, 5.74152129e-03, -1.91507073e-01,
     1.34663736e-01, 1.87089724e-05, -1.85117850e-05, 1.69907754e-05,
     -8.76746159e-02, -8.77632010e-02, 1.94511330e-01, -1.08739420e-01},
    {9.88956459e-02, -5.31910690e-06, -1.94619852e-01, 1.32480606e-01,
     -6.75531742e-06, 7.40658325e-06, 1.16944607e-01, -1.81491840e-01,
     1.38388581e-01, 2.64755154e-06, 1.45602211e-05, 3.61030626e-06,
     -1.58811295e-04, 6.67049063e-02, -1.89508028e-01, 1.17758575e-01},
    {9.23739469e-02, 8.15701114e-02, -1.89485459e-01, 8.15892931e-02,
     1.20915140e-01, -1.19351948e-01, 1.29234438e-01, -1.19373843e-01,
     2.12331566e-05, 7.57395725e-02, -1.75960925e-01, 5.76489647e-02,
     -1.48511480e-02, 5.76490938e-02, -1.86570551e-05, -7.56894366e-02},
    {9.23646906e-02, -8.15530234e-02, -1.89498348e-01, 8.15545678e-02,
     -1.20867601e-01, 1.19358521e-01, 1.29302317e-01, -1.19365189e-01,
     5.01204681e-07, -7.56741025e-02, 1.75948842e-01, -5.77015223e-02,
     -1.49149636e-02, 5.77026590e-02, -1.32548363e-05, -7.56851607e-02}};
float toa_bs070[][16] = {
    {2.13372111e-01, 2.14424553e-01, 2.94162482e-05, 2.55723284e-01,
     3.45027724e-01, 1.91222820e-06, 1.52974072e-01, 1.85454390e-05,
     5.13561776e-02, 2.55146288e-01, 1.29179779e-05, 1.42644435e-02,
     8.54541193e-05, 3.08761389e-02, 1.58130072e-05, -1.39695202e-01},
    {2.13374628e-01, -2.14421922e-01, -7.82048844e-06, 2.55731530e-01,
     -3.45024387e-01, 2.20791663e-05, 1.52994501e-01, 8.36579432e-06,
     5.13749937e-02, -2.55161157e-01, 4.42598123e-06, -1.42601113e-02,
     2.62321225e-05, 3.08964355e-02, 3.78724296e-05, -1.39691308e-01},
    {1.66184358e-01, 1.11184573e-05, -3.66403883e-05, 2.30248469e-01,
     3.30963290e-05, -2.20639849e-05, 1.77102738e-01, -1.86961785e-05,
     2.60114393e-01, 3.88156714e-05, -1.68517101e-05, 7.32964547e-06,
     -5.08503538e-05, 2.55430592e-02, -4.75572678e-06, 2.74143570e-01},
    {2.36569928e-01, 3.74832066e-01, -1.56285437e-05, 4.24343604e-02,
     6.81662182e-02, -7.63351205e-06, 1.40428434e-01, -1.23898745e-05,
     -3.73376705e-01, -2.69943350e-01, -5.81525049e-07, 2.43874398e-02,
     -1.39257439e-05, 1.92273189e-02, -2.52231898e-06, -6.29389348e-02},
    {2.36564185e-01, -3.74827868e-01, -2.54864215e-07, 4.24175086e-02,
     -6.81345231e-02, -9.34997984e-06, 1.40437087e-01, 1.34667096e-05,
     -3.73385262e-01, 2.69967023e-01, -3.32825354e-06, -2.43764672e-02,
     1.12151973e-05, 1.92243912e-02, -8.14447825e-07, -6.29289088e-02},
    {2.88435400e-01, 2.21055717e-01, -6.86850321e-06, -4.05015254e-01,
     -3.26455673e-01, -1.18756599e-06, 1.22777109e-01, 6.76367569e-06,
     1.93534074e-01, 1.77532443e-01, -1.67302684e-06, 1.60930709e-02,
     2.02380038e-05, -3.00239800e-02, 1.46102312e-05, 3.75304962e-02},
    {2.88423101e-01, -2.21046949e-01, -1.44603837e-05, -4.05012856e-01,
     3.26460873e-01, 2.47435796e-05, 1.22743736e-01, -5.06874964e-06,
     1.93545207e-01, -1.77534762e-01, 1.10284864e-05, -1.60647731e-02,
     1.84954718e-05, -3.00256524e-02, 3.54098237e-05, 3.75303538e-02}};
float toa_bs470[][16] = {
    {1.24843144e-01, 1.41061771e-01, -1.80747248e-01, 1.65913311e-01,
     2.36800212e-01, -1.07244596e-01, 3.70755153e-02, -1.32041749e-01,
     3.34320779e-02, 1.83465662e-01, -1.63044496e-01, -3.32090915e-02,
     -1.00199557e-02, -3.00655273e-02, -2.30739344e-02, -1.07604436e-01},
    {1.24850841e-01, -1.41070242e-01, -1.80772646e-01, 1.65913745e-01,
     -2.36805435e-01, 1.07249239e-01, 3.71137725e-02, -1.32065593e-01,
     3.34170948e-02, -1.83456094e-01, 1.63049548e-01, 3.31922333e-02,
     -1.00594025e-02, -3.00390583e-02, -2.31094492e-02, -1.07633723e-01},
    {1.14402054e-01, 4.98738605e-06, -1.33728192e-01, 2.00537106e-01,
     7.47281967e-06, -2.10410933e-05, 3.12322948e-02, -7.31589498e-02,
     2.33910325e-01, 4.98520638e-06, -3.87488495e-05, 2.56235628e-05,
     -8.47692243e-02, -6.08019759e-02, -6.69334999e-02, 2.39166920e-01},
    {1.58755448e-01, 2.95106609e-01, -1.76798547e-01, 2.68778320e-02,
     4.61416218e-02, -1.43594618e-01, -7.56537425e-03, -2.50863476e-02,
     -3.05162259e-01, -2.29775448e-01, -3.29644305e-02, -8.81169950e-02,
     -4.43186023e-02, 3.01020148e-03, 1.29563335e-01, -4.45753224e-02},
    {1.58756803e-01, -2.95115716e-01, -1.76785653e-01, 2.68566486e-02,
     -4.61073907e-02, 1.43578055e-01, -7.59074013e-03, -2.50818687e-02,
     -3.05167500e-01, 2.29764496e-01, 3.29816574e-02, 8.81563559e-02,
     -4.43327008e-02, 2.97545574e-03, 1.29569118e-01, -4.45418085e-02},
    {1.86203037e-01, 1.50116485e-01, -2.14964156e-01, -3.03325032e-01,
     -2.36972616e-01, -1.06371699e-01, -2.25753494e-02, 1.69770743e-01,
     1.72868251e-01, 1.50335469e-01, 1.42695099e-01, -3.62253139e-02,
     -6.06157227e-03, 8.39919748e-02, -5.40499752e-02, -2.87551740e-03},
    {1.86189919e-01, -1.50097988e-01, -2.14959641e-01, -3.03312344e-01,
     2.36955630e-01, 1.06381437e-01, -2.25726327e-02, 1.69772154e-01,
     1.72892919e-01, -1.50359207e-01, -1.42698526e-01, 3.61976127e-02,
     -6.02462292e-03, 8.39965538e-02, -5.40363302e-02, -2.91104068e-03},
    {1.44709894e-01, 1.41473867e-01, 2.78957203e-01, 1.41751287e-01,
     1.30601102e-01, 2.01653545e-01, 1.50390749e-01, 2.01774772e-01,
     5.06050203e-04, 2.91925392e-02, 1.71070673e-01, 9.00016580e-02,
     -3.21155894e-02, 8.96531863e-02, 2.67123550e-04, -2.81262986e-02},
    {1.44701477e-01, -1.41446273e-01, 2.78957354e-01, 1.41750842e-01,
     -1.30567100e-01, -2.01633141e-01, 1.50411808e-01, 2.01805474e-01,
     4.96601979e-04, -2.91385143e-02, -1.71055278e-01, -9.00154625e-02,
     -3.21118007e-02, 8.96938931e-02, 2.77978977e-04, -2.81581190e-02},
    {1.44950932e-01, 1.35387066e-01, 2.79612497e-01, -1.42097420e-01,
     -1.15376887e-01, 1.96671462e-01, 1.50619314e-01, -2.03198893e-01,
     2.98435746e-04, 5.89416209e-03, -1.57974514e-01, 9.45683744e-02,
     -3.34969322e-02, -9.10208758e-02, 1.33572181e-03, 2.84859560e-02},
    {1.44954080e-01, -1.35401479e-01, 2.79611028e-01, -1.42095453e-01,
     1.15370701e-01, -1.96673875e-01, 1.50606414e-01, -2.03202287e-01,
     2.71548519e-04, -5.86436737e-03, 1.57960124e-01, -9.45439437e-02,
     -3.35050564e-02, -9.10396767e-02, 1.32770538e-03, 2.85003118e-02}};

float toa_iamf312[][16] = {
    {4.600323e-01, 5.123393e-01, -1.732089e-01, -8.679045e-02, 2.110607e-01,
     -1.240358e-01, 6.031437e-02, -1.472639e-01, -9.544121e-02, 9.626709e-03,
     -1.475499e-01, -2.170848e-02, -1.757221e-02, -3.459537e-02, 5.974536e-03,
     -1.740531e-01},
    {4.600358e-01, -5.123299e-01, -1.732095e-01, -8.677885e-02, -2.110661e-01,
     1.240584e-01, 6.030266e-02, -1.472670e-01, -9.542189e-02, -9.640919e-03,
     1.475400e-01, 2.169693e-02, -1.758859e-02, -3.460532e-02, 5.974916e-03,
     -1.740174e-01},
    {9.927428e-02, 1.135584e-05, -1.291193e-01, 1.863923e-01, 3.137031e-05,
     -9.139079e-06, 3.496658e-02, -1.160047e-01, 2.076180e-01, 3.945961e-05,
     -2.879414e-05, 4.179365e-06, -6.578851e-02, -1.791001e-02, -8.364789e-02,
     2.217087e-01},
    {1.117560e-01, 9.571090e-02, 2.177361e-01, 1.412031e-01, 1.217814e-01,
     1.382991e-01, 1.241730e-01, 2.136451e-01, 3.635167e-02, 6.785955e-02,
     1.732515e-01, 6.485935e-02, -1.129651e-02, 1.236321e-01, 4.362752e-02,
     -5.882758e-03},
    {1.117437e-01, -9.570201e-02, 2.177374e-01, 1.411734e-01, -1.217560e-01,
     -1.383046e-01, 1.242088e-01, 2.136489e-01, 3.631807e-02, -6.782208e-02,
     -1.732464e-01, -6.488207e-02, -1.128750e-02, 1.236767e-01, 4.363238e-02,
     -5.932943e-03},
};

float toa_iamf712[][16] = {
    {1.24843144e-01, 1.41061771e-01, -1.80747248e-01, 1.65913311e-01,
     2.36800212e-01, -1.07244596e-01, 3.70755153e-02, -1.32041749e-01,
     3.34320779e-02, 1.83465662e-01, -1.63044496e-01, -3.32090915e-02,
     -1.00199557e-02, -3.00655273e-02, -2.30739344e-02, -1.07604436e-01},
    {1.24850841e-01, -1.41070242e-01, -1.80772646e-01, 1.65913745e-01,
     -2.36805435e-01, 1.07249239e-01, 3.71137725e-02, -1.32065593e-01,
     3.34170948e-02, -1.83456094e-01, 1.63049548e-01, 3.31922333e-02,
     -1.00594025e-02, -3.00390583e-02, -2.31094492e-02, -1.07633723e-01},
    {1.14402054e-01, 4.98738605e-06, -1.33728192e-01, 2.00537106e-01,
     7.47281967e-06, -2.10410933e-05, 3.12322948e-02, -7.31589498e-02,
     2.33910325e-01, 4.98520638e-06, -3.87488495e-05, 2.56235628e-05,
     -8.47692243e-02, -6.08019759e-02, -6.69334999e-02, 2.39166920e-01},
    {1.58755448e-01, 2.95106609e-01, -1.76798547e-01, 2.68778320e-02,
     4.61416218e-02, -1.43594618e-01, -7.56537425e-03, -2.50863476e-02,
     -3.05162259e-01, -2.29775448e-01, -3.29644305e-02, -8.81169950e-02,
     -4.43186023e-02, 3.01020148e-03, 1.29563335e-01, -4.45753224e-02},
    {1.58756803e-01, -2.95115716e-01, -1.76785653e-01, 2.68566486e-02,
     -4.61073907e-02, 1.43578055e-01, -7.59074013e-03, -2.50818687e-02,
     -3.05167500e-01, 2.29764496e-01, 3.29816574e-02, 8.81563559e-02,
     -4.43327008e-02, 2.97545574e-03, 1.29569118e-01, -4.45418085e-02},
    {1.86203037e-01, 1.50116485e-01, -2.14964156e-01, -3.03325032e-01,
     -2.36972616e-01, -1.06371699e-01, -2.25753494e-02, 1.69770743e-01,
     1.72868251e-01, 1.50335469e-01, 1.42695099e-01, -3.62253139e-02,
     -6.06157227e-03, 8.39919748e-02, -5.40499752e-02, -2.87551740e-03},
    {1.86189919e-01, -1.50097988e-01, -2.14959641e-01, -3.03312344e-01,
     2.36955630e-01, 1.06381437e-01, -2.25726327e-02, 1.69772154e-01,
     1.72892919e-01, -1.50359207e-01, -1.42698526e-01, 3.61976127e-02,
     -6.02462292e-03, 8.39965538e-02, -5.40363302e-02, -2.91104068e-03},
    {2.472057e-01, 2.372070e-01, 4.766731e-01, 4.127324e-02, 4.901732e-02,
     3.407213e-01, 2.568947e-01, 5.809146e-02, 7.170761e-04, 3.336034e-02,
     5.936582e-02, 1.568716e-01, -5.580150e-02, 2.529171e-02, 1.211621e-03,
     -7.983686e-03},
    {2.471995e-01, -2.371896e-01, 4.766722e-01, 4.127418e-02, -4.898770e-02,
     -3.407026e-01, 2.569066e-01, 5.811976e-02, 6.886158e-04, -3.328525e-02,
     -5.936060e-02, -1.568681e-01, -5.580345e-02, 2.531912e-02, 1.216808e-03,
     -8.005355e-03}};

struct h2m_rdr_t h2m_rdr_tab[] = {
    {IAMF_ZOA, BS2051_A, 2, -1, -1, (float *)zoa_bs020, 1, 2},
    {IAMF_ZOA, BS2051_B, 6, 3, -1, (float *)zoa_bs050, 1, 5},
    {IAMF_ZOA, BS2051_C, 8, 3, -1, (float *)zoa_bs250, 1, 7},
    {IAMF_ZOA, BS2051_D, 10, 3, -1, (float *)zoa_bs450, 1, 9},
    {IAMF_ZOA, BS2051_E, 11, 3, -1, (float *)zoa_bs451, 1, 10},
    {IAMF_ZOA, BS2051_F, 12, 10, 11, (float *)zoa_bs370, 1, 10},
    {IAMF_ZOA, BS2051_G, 14, 3, -1, (float *)zoa_bs490, 1, 13},
    {IAMF_ZOA, BS2051_H, 24, 3, 9, (float *)zoa_bs9A3, 1, 22},
    {IAMF_ZOA, BS2051_I, 8, 3, -1, (float *)zoa_bs070, 1, 7},
    {IAMF_ZOA, BS2051_J, 12, 3, -1, (float *)zoa_bs470, 1, 11},
    {IAMF_ZOA, IAMF_312, 6, 3, -1, (float *)zoa_iamf312, 1, 5},
    {IAMF_ZOA, IAMF_712, 10, 3, -1, (float *)zoa_iamf712, 1, 9},
    {IAMF_ZOA, IAMF_BINAURAL, 2, -1, -1, (float *)zoa_bs020, 1, 2},
    {IAMF_ZOA, IAMF_MONO, 1, -1, -1, (float *)zoa_mono, 1, 1},

    {IAMF_FOA, BS2051_A, 2, -1, -1, (float *)foa_bs020, 4, 2},
    {IAMF_FOA, BS2051_B, 6, 3, -1, (float *)foa_bs050, 4, 5},
    {IAMF_FOA, BS2051_C, 8, 3, -1, (float *)foa_bs250, 4, 7},
    {IAMF_FOA, BS2051_D, 10, 3, -1, (float *)foa_bs450, 4, 9},
    {IAMF_FOA, BS2051_E, 11, 3, -1, (float *)foa_bs451, 4, 10},
    {IAMF_FOA, BS2051_F, 12, 10, 11, (float *)foa_bs370, 4, 10},
    {IAMF_FOA, BS2051_G, 14, 3, -1, (float *)foa_bs490, 4, 13},
    {IAMF_FOA, BS2051_H, 24, 3, 9, (float *)foa_bs9A3, 4, 22},
    {IAMF_FOA, BS2051_I, 8, 3, -1, (float *)foa_bs070, 4, 7},
    {IAMF_FOA, BS2051_J, 12, 3, -1, (float *)foa_bs470, 4, 11},
    {IAMF_FOA, IAMF_312, 6, 3, -1, (float *)foa_iamf312, 4, 5},
    {IAMF_FOA, IAMF_712, 10, 3, -1, (float *)foa_iamf712, 4, 9},
    {IAMF_FOA, IAMF_BINAURAL, 2, -1, -1, (float *)foa_bs020, 4, 2},
    {IAMF_FOA, IAMF_MONO, 1, -1, -1, (float *)foa_mono, 4, 1},

    {IAMF_SOA, BS2051_A, 2, -1, -1, (float *)soa_bs020, 9, 2},
    {IAMF_SOA, BS2051_B, 6, 3, -1, (float *)soa_bs050, 9, 5},
    {IAMF_SOA, BS2051_C, 8, 3, -1, (float *)soa_bs250, 9, 7},
    {IAMF_SOA, BS2051_D, 10, 3, -1, (float *)soa_bs450, 9, 9},
    {IAMF_SOA, BS2051_E, 11, 3, -1, (float *)soa_bs451, 9, 10},
    {IAMF_SOA, BS2051_F, 12, 10, 11, (float *)soa_bs370, 9, 10},
    {IAMF_SOA, BS2051_G, 14, 3, -1, (float *)soa_bs490, 9, 13},
    {IAMF_SOA, BS2051_H, 24, 3, 9, (float *)soa_bs9A3, 9, 22},
    {IAMF_SOA, BS2051_I, 8, 3, -1, (float *)soa_bs070, 9, 7},
    {IAMF_SOA, BS2051_J, 12, 3, -1, (float *)soa_bs470, 9, 11},
    {IAMF_SOA, IAMF_312, 6, 3, -1, (float *)soa_iamf312, 9, 5},
    {IAMF_SOA, IAMF_712, 10, 3, -1, (float *)soa_iamf712, 9, 9},
    {IAMF_SOA, IAMF_BINAURAL, 2, -1, -1, (float *)soa_bs020, 9, 2},
    {IAMF_SOA, IAMF_MONO, 1, -1, -1, (float *)soa_mono, 9, 1},

    {IAMF_TOA, BS2051_A, 2, -1, -1, (float *)toa_bs020, 16, 2},
    {IAMF_TOA, BS2051_B, 6, 3, -1, (float *)toa_bs050, 16, 5},
    {IAMF_TOA, BS2051_C, 8, 3, -1, (float *)toa_bs250, 16, 7},
    {IAMF_TOA, BS2051_D, 10, 3, -1, (float *)toa_bs450, 16, 9},
    {IAMF_TOA, BS2051_E, 11, 3, -1, (float *)toa_bs451, 16, 10},
    {IAMF_TOA, BS2051_F, 12, 10, 11, (float *)toa_bs370, 16, 10},
    {IAMF_TOA, BS2051_G, 14, 3, -1, (float *)toa_bs490, 16, 13},
    {IAMF_TOA, BS2051_H, 24, 3, 9, (float *)toa_bs9A3, 16, 22},
    {IAMF_TOA, BS2051_I, 8, 3, -1, (float *)toa_bs070, 16, 7},
    {IAMF_TOA, BS2051_J, 12, 3, -1, (float *)toa_bs470, 16, 11},
    {IAMF_TOA, IAMF_312, 6, 3, -1, (float *)toa_iamf312, 16, 5},
    {IAMF_TOA, IAMF_712, 10, 3, -1, (float *)toa_iamf712, 16, 9},
    {IAMF_TOA, IAMF_BINAURAL, 2, -1, -1, (float *)toa_bs020, 16, 2},
    {IAMF_TOA, IAMF_MONO, 1, -1, -1, (float *)toa_mono, 16, 1},
};

/*
Layout in: HOA channel layout
Layout out: Direct speaker output channel layout
float *outMatrix: Conversion Matrix (MatrixSize = number of out channels x
number of in channels)
*/
int IAMF_element_renderer_get_H2M_matrix(IAMF_HOA_LAYOUT *in,
                                         IAMF_PREDEFINED_SP_LAYOUT *out,
                                         struct h2m_rdr_t *outMatrix) {
  int i;
  for (i = 0; i < sizeof(h2m_rdr_tab) / sizeof(struct h2m_rdr_t); i++) {
    if (h2m_rdr_tab[i].in == in->order && h2m_rdr_tab[i].out == out->system) {
      *outMatrix = h2m_rdr_tab[i];
      return (0);
    }
  }
  return (-1);
}

#if DISABLE_LFE_HOA == 0
static float lfefilter_update(lfe_filter_t *lfe_f, float input);
#endif

// HOA to Multichannel Renderer
int IAMF_element_renderer_render_H2M(struct h2m_rdr_t *h2mMatrix, float *in[],
                                     float *out[], int nsamples,
                                     lfe_filter_t *lfe) {
  int i, j, m, n;
  int m_size = h2mMatrix->m;
  int n_size = h2mMatrix->n;

  // lfe generator turns on
  int lfe1 = h2mMatrix->lfe1;
  int lfe2 = h2mMatrix->lfe2;
  int map[24] = {
      0,
  };

  /// convert HOA to channel by using the predefined matrix
  for (i = 0; i < nsamples; i++) {
    for (n = 0; n < n_size; n++) {    // output
      for (m = 0; m < m_size; m++) {  // input
        if (m == 0) {
          out[n][i] = 0;  // initialize output sample
        }
        out[n][i] += h2mMatrix->mat[n * m_size + m] * in[m][i];
      }
    }
  }

  n = 0;
  if (lfe1 >= 0 || lfe2 >= 0) {
    // find a channel place to move
    for (i = 0; i < n_size; i++) {
      if (lfe1 == i) {
        n++;
      }
      if (lfe2 == i) {
        n++;
      }
      map[i] = n;
      n++;
    }

    // move a channel to a new channel place
    for (i = n_size - 1; i >= 0; i--) {
      if (map[i] != i) {
        for (j = 0; j < nsamples; j++) {
          out[map[i]][j] = out[i][j];
        }
      }
    }

#if DISABLE_LFE_HOA == 1
    //////////////
    // generate lfe signal to lfe channel place
    if (lfe1 >= 0) {
      for (j = 0; j < nsamples; j++) {
        out[lfe1][j] = 0;
      }
    }
    //////////////
    if (lfe2 >= 0) {
      for (j = 0; j < nsamples; j++) {
        out[lfe2][j] = 0;
      }
    }
#else
    //////////////
    // generate lfe signal to lfe channel place
    if (lfe1 >= 0) {
      for (j = 0; j < nsamples; j++) {
        if (lfe) {  // compute lfe
          float output;
          output = lfefilter_update(lfe, in[0][j]);  // use W
          if (n_size <= 2)
            out[lfe1][j] = output * 0.5;
          else
            out[lfe1][j] = output / sqrt(n_size);
        } else {  // lfe off
          out[lfe1][j] = 0;
        }
      }
    }
    //////////////
    if (lfe2 >= 0) {
      for (j = 0; j < nsamples; j++) {
        if (lfe) {          // lfe on
          if (lfe1 >= 0) {  // already compute lfe
            out[lfe2][j] = out[lfe1][j];
          } else {  // compute lfe
            float output;
            output = lfefilter_update(lfe, in[0][j]);  // use W
            if (n_size <= 2)
              out[lfe2][j] = output * 0.5;
            else
              out[lfe2][j] = output / sqrt(n_size);
          }
        } else {  // lfe off
          out[lfe2][j] = 0;
        }
      }
    }
#endif
  }

  return (0);
}

#if DISABLE_LFE_HOA == 0
void lfefilter_init(lfe_filter_t *lfe_f, float cutoff_freq, float sample_rate) {
  lfe_f->init = 1;
  float delta_time = 1 / sample_rate + 1.0e-10;
  if (cutoff_freq <= 0) {
    // Warning: A LowPassFilter instance has been configured with 0 Hz as
    // cut-off frequency.
    lfe_f->c = lfe_f->a1 = lfe_f->a2 = lfe_f->a3 = lfe_f->b1 = lfe_f->b2 = 0;
    memset(lfe_f->input_history, 0, sizeof(lfe_f->input_history));
    memset(lfe_f->output_history, 0, sizeof(lfe_f->output_history));
    return;
  }
  lfe_f->c = 1.0f / (float)tanf(M_PI * cutoff_freq * delta_time);
  lfe_f->a1 = 1.0f / (1.0f + lfe_f->c + lfe_f->c * lfe_f->c);
  lfe_f->a2 = 2.0f * lfe_f->a1;
  lfe_f->a3 = lfe_f->a1;
  lfe_f->b1 = 2.0f * (1.0f - lfe_f->c * lfe_f->c) * lfe_f->a1;
  lfe_f->b2 = (1.0f - lfe_f->c + lfe_f->c * lfe_f->c) * lfe_f->a1;
  memset(lfe_f->input_history, 0, sizeof(lfe_f->input_history));
  memset(lfe_f->output_history, 0, sizeof(lfe_f->output_history));
}

#define DEFAULT_SAMPLERATE 48000.0f
static float lfefilter_update(lfe_filter_t *lfe_f, float input) {
  float output;

  if (lfe_f->init != 1) {
    lfefilter_init(lfe_f, 120, DEFAULT_SAMPLERATE);
  }
  output = lfe_f->a1 * input + lfe_f->a2 * lfe_f->input_history[0] +
           lfe_f->a3 * lfe_f->input_history[1] -
           lfe_f->b1 * lfe_f->output_history[0] -
           lfe_f->b2 * lfe_f->output_history[1];

  lfe_f->input_history[1] = lfe_f->input_history[0];
  lfe_f->input_history[0] = input;

  lfe_f->output_history[1] = lfe_f->output_history[0];
  lfe_f->output_history[0] = output;

  return (output);
}
#endif
