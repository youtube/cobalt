<!--
Copyright 2024 The Chromium Authors
Use of this source code is governed by a BSD-style license that can be
found in the LICENSE file.
-->

<!--
This file is used to generate a comprehensive list of ModelExecution histograms
along with a detailed description for each histogram.

For best practices on writing histogram descriptions, see
https://chromium.googlesource.com/chromium/src.git/+/HEAD/tools/metrics/histograms/README.md

Please follow the instructions in the OWNERS file in this directory to find a
reviewer. If no OWNERS file exists, please consider signing up at
go/reviewing-metrics (Googlers only), as all subdirectories are expected to
have an OWNERS file. As a last resort you can send the CL to
chromium-metrics-reviews@google.com.
-->

<histogram-configuration>

<histograms>

<variants name="SessionType">
  <variant name="Generic" summary="Generic model execution session"/>
</variants>

<histogram name="ModelExecution.Session.{SessionType}.ExecutionRequestSize"
    units="bytes" expires_after="2024-09-29">
  <owner>leimy@chromium.org</owner>
  <owner>fergal@chromium.org</owner>
  <summary>
    Measures the size of the model execution request in bytes. This is recorded
    each time when the model is executed.
  </summary>
  <token key="SessionType" variants="SessionType"/>
</histogram>

<histogram
    name="ModelExecution.Session.{SessionType}.ExecutionResponseCallbackCount"
    units="times" expires_after="2024-07-29">
  <owner>leimy@chromium.org</owner>
  <owner>fergal@chromium.org</owner>
  <summary>
    Measures the number of times that the callback is triggered in one model
    execution. This is recorded each time when the model execution completes.
  </summary>
  <token key="SessionType" variants="SessionType"/>
</histogram>

<histogram name="ModelExecution.Session.{SessionType}.ExecutionResponseSize"
    units="bytes" expires_after="2024-07-29">
  <owner>leimy@chromium.org</owner>
  <owner>fergal@chromium.org</owner>
  <summary>
    Measures the size of the model execution response in bytes. This is recorded
    each time when the model execution completes.
  </summary>
  <token key="SessionType" variants="SessionType"/>
</histogram>

<histogram name="ModelExecution.Session.{SessionType}.ExecutionResponseStatus"
    enum="ModelExecutionResponseStatus" expires_after="2024-09-29">
  <owner>leimy@chromium.org</owner>
  <owner>fergal@chromium.org</owner>
  <summary>
    Records the final response status for each model execution call. This is
    recorded each time when the stream completes or encounters errors.
  </summary>
  <token key="SessionType" variants="SessionType"/>
</histogram>

<histogram name="ModelExecution.{SessionType}.APIUsage"
    enum="ModelExecutionAPI" expires_after="2024-09-29">
  <owner>leimy@chromium.org</owner>
  <owner>fergal@chromium.org</owner>
  <summary>
    This is recorded each time when the model execution JavaScript API is
    invoked. This can be used to measure the number of calls of each API within
    a particular time period.
  </summary>
  <token key="SessionType" variants="SessionType"/>
</histogram>

<histogram name="ModelExecution.{SessionType}.Availability"
    enum="ModelExecutionAvailability" expires_after="2024-09-29">
  <owner>leimy@chromium.org</owner>
  <owner>fergal@chromium.org</owner>
  <summary>
    Records the availability of model execution as returned in
    `model.canCreateGenericSession()`.
  </summary>
  <token key="SessionType" variants="SessionType"/>
</histogram>

</histograms>

</histogram-configuration>
