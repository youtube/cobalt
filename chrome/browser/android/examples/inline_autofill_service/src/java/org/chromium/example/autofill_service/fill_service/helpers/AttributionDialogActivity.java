// Copyright 2025 The Chromium Authors
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.

package org.chromium.example.autofill_service.fill_service.helpers;

import android.app.Activity;
import android.app.AlertDialog;
import android.app.Dialog;
import android.content.Intent;
import android.os.Bundle;
import android.view.WindowManager;

import org.chromium.example.autofill_service.SettingsActivity;

/**
 * Long-pressing an inline suggestion opens this activity. It shows a dialog describing the source
 * of the suggestion.
 */
public class AttributionDialogActivity extends Activity {
    static final String KEY_MSG = "AttributionDialogActivity:msg";
    static final String DEFAULT_MSG = "Hello";

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        getWindow().addFlags(WindowManager.LayoutParams.FLAG_ALT_FOCUSABLE_IM);
        final Intent intent = getIntent();
        Dialog dialog = createDialog(intent != null ? intent.getStringExtra(KEY_MSG) : DEFAULT_MSG);
        dialog.setOnDismissListener(d -> finish());
        dialog.show();
    }

    private Dialog createDialog(String msg) {
        AlertDialog.Builder builder = new AlertDialog.Builder(this);
        builder.setMessage("The suggestions are generated by the InlineFillService. " + msg)
                .setNegativeButton(
                        "Settings",
                        (dialog, id) -> {
                            Intent intent = new Intent(this, SettingsActivity.class);
                            startActivity(intent);
                        })
                .setPositiveButton(
                        "Got it",
                        (dialog, id) -> {
                            // User cancelled the dialog
                        });
        return builder.create();
    }
}
