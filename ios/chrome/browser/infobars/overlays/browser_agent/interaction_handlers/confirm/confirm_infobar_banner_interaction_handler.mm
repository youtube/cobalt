// Copyright 2020 The Chromium Authors
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.

#import "ios/chrome/browser/infobars/overlays/browser_agent/interaction_handlers/confirm/confirm_infobar_banner_interaction_handler.h"

#import "base/notreached.h"
#import "components/infobars/core/confirm_infobar_delegate.h"
#import "ios/chrome/browser/infobars/infobar_ios.h"
#import "ios/chrome/browser/overlays/public/infobar_banner/confirm_infobar_banner_overlay_request_config.h"

#if !defined(__has_feature) || !__has_feature(objc_arc)
#error "This file requires ARC support."
#endif

using confirm_infobar_overlays::ConfirmBannerRequestConfig;

#pragma mark - InfobarBannerInteractionHandler

ConfirmInfobarBannerInteractionHandler::ConfirmInfobarBannerInteractionHandler()
    : InfobarBannerInteractionHandler(
          ConfirmBannerRequestConfig::RequestSupport()) {}

ConfirmInfobarBannerInteractionHandler::
    ~ConfirmInfobarBannerInteractionHandler() = default;

void ConfirmInfobarBannerInteractionHandler::MainButtonTapped(
    InfoBarIOS* infobar) {
  // Confirm Infobars don't need to update badge status.
  GetInfobarDelegate(infobar)->Accept();
}

void ConfirmInfobarBannerInteractionHandler::BannerVisibilityChanged(
    InfoBarIOS* infobar,
    bool visible) {
  if (!visible)
    GetInfobarDelegate(infobar)->InfoBarDismissed();
}

#pragma mark - Private

ConfirmInfoBarDelegate*
ConfirmInfobarBannerInteractionHandler::GetInfobarDelegate(
    InfoBarIOS* infobar) {
  ConfirmInfoBarDelegate* delegate =
      infobar->delegate()->AsConfirmInfoBarDelegate();
  DCHECK(delegate);
  return delegate;
}
