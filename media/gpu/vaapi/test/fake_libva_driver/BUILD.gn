# Copyright 2022 The Chromium Authors
# Use of this source code is governed by a BSD-style license that can be
# found in the LICENSE file.

import("//media/gpu/args.gni")
import("//testing/test.gni")

shared_library("fake_drv_video") {
  sources = [ "fake_drv_video.cc" ]

  deps = [
    ":fake_libva_driver_internals",
    "//base",
  ]
}

source_set("fake_libva_driver_internals") {
  visibility = [ ":fake_drv_video" ]
  sources = [
    "fake_config.cc",
    "fake_config.h",
    "fake_context.cc",
    "fake_context.h",
    "fake_driver.cc",
    "fake_driver.h",
    "fake_surface.cc",
    "fake_surface.h",
    "object_tracker.h",
  ]

  deps = [ "//base" ]
}

test("fake_libva_driver_unittest") {
  # Depending on //media/gpu/vaapi:libva_stubs only works on Linux or ChromeOS
  # with VA-API.
  assert(is_linux || is_chromeos)
  assert(use_vaapi)

  sources = [ "fake_drv_video_unittest.cc" ]
  deps = [
    ":fake_drv_video",
    "//base",
    "//base/test:test_support",
    "//media/gpu/vaapi:libva_stubs",
    "//testing/gtest",
  ]
}
