<!DOCTYPE html>
<meta charset="utf-8"/>
<meta name="referrer" content="origin">
<head>
<!-- The token below was generated via the following command:
tools/origin_trials/generate_token.py https://not-web-platform.test:8444 DisableThirdPartyStoragePartitioning3 --expire-timestamp=2000000000
-->
<meta http-equiv="origin-trial" content="A7V1Cv2kO1WAFfB5ztNXt9dfE6U42qjfeiXpUhlnkhJKm+p0yveyTbh+rZUpS0S39QUoIRQMWYwU4rs0JT7iuwEAAAB6eyJvcmlnaW4iOiAiaHR0cHM6Ly9ub3Qtd2ViLXBsYXRmb3JtLnRlc3Q6ODQ0NCIsICJmZWF0dXJlIjogIkRpc2FibGVUaGlyZFBhcnR5U3RvcmFnZVBhcnRpdGlvbmluZzMiLCAiZXhwaXJ5IjogMjAwMDAwMDAwMH0=">
</head>
<script>
async function onLoad() {
  // Step 6:
  // wpt_internal/web-locks/storage-deprecation-trial-enabled.https.html
  self.addEventListener('message', evt => {
    if (self.opener)
      self.opener.postMessage(evt.data, '*');
    else
      self.top.postMessage(evt.data, '*');
  }, { once: true });

  // Step 3:
  // wpt_internal/web-locks/storage-deprecation-trial-enabled.https.html
  const params = new URLSearchParams(self.location.search);
  const frame = document.createElement('iframe');
  frame.src = params.get('target');
  document.body.appendChild(frame);

  // Step 4:
  // wpt_internal/web-locks/storage-deprecation-trial-enabled.https.html
  frame.addEventListener('load', function(){
    frame.contentWindow.postMessage({op: 'request',
        name: 'testLock', ifAvailable: true}, '*');
  });
}
self.addEventListener('load', onLoad);
</script>
