<meta charset="koi8-r">
<body>
<script>
if (window.testRunner) {
    testRunner.dumpAsText();
    testRunner.waitUntilDone();
}

var count = 0;
window.addEventListener('message', e => {
    document.getElementById("result" + e.data.frame).innerHTML = e.data.frame + ". " + (e.data.value == "" ? "SUCCESS" : "FAILURE: " + e.data.value) + ".";
    count++;
    if (window.testRunner && count == 3)
        testRunner.notifyDone();
});

</script>
<p>Test that non-ASCII data: URLs are handled correctly.</p>
<pre id=result1></pre>
<pre id=result2></pre>
<pre id=result3></pre><br>
<iframe src="data:image/svg+xml;charset=utf-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 test=''><script>window.parent.postMessage({frame: 1, value: document.documentElement.getAttribute('test')}, '*');</script></svg>"></iframe>
<iframe src="data:image/svg+xml;charset=utf-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 foo='%23' test=''><script>window.parent.postMessage({frame: 2, value: document.documentElement.getAttribute('test')}, '*');</script></svg>"></iframe>
<iframe src="data:image/svg+xml;charset=utf-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 foo='%23' test='%D0%9F%D1%80%D0%BE%D0%B2%D0%B5%D1%80%D0%BA%D0%B0'><script>window.parent.postMessage({frame: 3, value: document.documentElement.getAttribute('test')}, '*');</script></svg>"></iframe>
</body>
