<!DOCTYPE HTML>
<title>Tests that invoking location.reload() in the middle of a getUserMedia()
  call does not crash.</title>
<script src="../../resources/testharness.js"></script>
<script src="../../resources/testharnessreport.js"></script>
<script>
  async_test(test => {
    if (performance.navigation.type == performance.navigation.TYPE_NAVIGATE) {
      navigator.mediaDevices.getUserMedia({video: true})
        .then(test.step_func_done(() => {}))
        .catch(test.unreached_func("getUserMedia failed"));
      location.reload();
    } else {
      test.done();
    }
  });
</script>
